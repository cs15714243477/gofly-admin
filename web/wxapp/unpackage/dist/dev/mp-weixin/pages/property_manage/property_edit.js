"use strict";const e=require("../../common/vendor.js"),t=require("../../api/property.js"),o=require("../../store/index.js"),i=require("../../utils/config/index.js");function a(t=""){const o=(e=>{const t=[];for(let o=0;o<e.length;o++){let i=e.charCodeAt(o);i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|63&i)):(t.push(224|i>>12),t.push(128|i>>6&63),t.push(128|63&i))}return new Uint8Array(t)})(t).buffer;return void 0!==e.wx$1&&e.wx$1.arrayBufferToBase64?e.wx$1.arrayBufferToBase64(o):void 0!==e.index$1&&e.index$1.arrayBufferToBase64?e.index$1.arrayBufferToBase64(o):""}const n={components:{TopHeader:()=>"../../components/TopHeader.js"},data(){const e=(new Date).getFullYear();return{id:0,saving:!1,uploading:!1,form:{title:"",price:"",price_unit:"万",area:"",rooms:0,halls:0,bathrooms:0,build_year:"",floor_level:"",total_floors:"",orientation:"",property_type:"",decoration_type:"",community_name:"",address:"",latitude:"",longitude:"",tags:[],images:[],cover_image:"",video_url:"",allow_image_download:1,allow_video_download:1,sale_status:"on_sale",owner_name:"",owner_phone:"",receiver_name:"",receiver_phone:"",receiver_price:"",commission_rate:"",commission_reward:"",weigh:"",hot_status:0,has_smart_lock:0,status:0},tags:[],images:[],newTag:"",addressRegion:["","",""],addressDetail:"",saleStatusOptions:[{label:"在售",value:"on_sale"},{label:"已售",value:"sold"},{label:"下架",value:"off_market"}],buildYearOptions:[{label:"请选择",value:""}].concat(Array.from({length:e-1950+1}).map(((t,o)=>{const i=String(e-o);return{label:i,value:i}}))),floorLevelOptions:[{label:"低层 (1-6)",value:"低层"},{label:"中层 (7-15)",value:"中层"},{label:"高层 (16+)",value:"高层"},{label:"地下",value:"地下"}],orientationOptions:["东","南","西","北","东南","东北","西南","西北","南北","东西"].map((e=>({label:e,value:e}))),propertyTypeOptions:["住宅","公寓","别墅","商铺","写字楼"].map((e=>({label:e,value:e}))),decorationTypeOptions:["毛坯","简装","精装","豪装"].map((e=>({label:e,value:e}))),priceUnitOptions:[{label:"万",value:"万"},{label:"元",value:"元"}],savingRenovation:!1,renovation:{renovation_status:"none",progress_percentage:0,current_stage:"",start_date:"",estimated_finish_date:"",actual_finish_date:"",notes:"",status:0},renovationStatusOptions:[{label:"未装修",value:"none"},{label:"装修中",value:"in_progress"},{label:"已完成",value:"done"}],renovationStageOptions:[{label:"请选择",value:""}].concat(["设计","拆改","水电","泥瓦","木工","油漆","安装","软装","验收"].map((e=>({label:e,value:e})))),renovationMaterials:[],renovationImages:[],newMaterial:""}},computed:{saleStatusIndex(){const e=String(this.form.sale_status||"on_sale"),t=this.saleStatusOptions.findIndex((t=>t.value===e));return t>=0?t:0},priceUnitIndex(){const e=String(this.form.price_unit||"万"),t=this.priceUnitOptions.findIndex((t=>t.value===e));return t>=0?t:0},buildYearIndex(){const e=String(this.form.build_year||""),t=this.buildYearOptions.findIndex((t=>t.value===e));return t>=0?t:0},floorLevelIndex(){const e=String(this.form.floor_level||""),t=this.floorLevelOptions.findIndex((t=>t.value===e));return t>=0?t:0},orientationIndex(){const e=String(this.form.orientation||""),t=this.orientationOptions.findIndex((t=>t.value===e));return t>=0?t:0},propertyTypeIndex(){const e=String(this.form.property_type||""),t=this.propertyTypeOptions.findIndex((t=>t.value===e));return t>=0?t:0},decorationTypeIndex(){const e=String(this.form.decoration_type||""),t=this.decorationTypeOptions.findIndex((t=>t.value===e));return t>=0?t:0},addressRegionText(){return(Array.isArray(this.addressRegion)?this.addressRegion:[]).filter((e=>String(e||"").trim())).join(" / ")||"请选择省市区"},renovationStatusIndex(){const e=String(this.renovation.renovation_status||"none"),t=this.renovationStatusOptions.findIndex((t=>t.value===e));return t>=0?t:0},renovationStageIndex(){const e=String(this.renovation.current_stage||""),t=this.renovationStageOptions.findIndex((t=>t.value===e));return t>=0?t:0}},onLoad(e){const t=Number(e&&(e.id||e.ID)||0)||0;this.id=t,this.bootstrap()},methods:{toFullMediaUrl(e){const t=String(e||"").trim();if(!t)return"";if(/^https?:\/\//i.test(t)||t.startsWith("wxfile://")||t.startsWith("file://"))return t;const o=String(i.baseUrl||"").replace(/\/+$/,""),a=t.startsWith("/")?t:`/${t}`;return o?`${o}${a}`:a},goBack(){e.index$1.navigateBack()},async ensurePermission(){const t=o.$store("user");if(!e.index$1.getStorageSync("token")&&!t.isLogin)return e.index$1.reLaunch({url:"/pages/login/login"}),!1;try{const e=t.userInfo||{};e.id&&void 0!==e.can_manage_properties||await t.getInfo()}catch(i){}return!(1!==Number((t.userInfo||{}).can_manage_properties))||(e.index$1.showModal({title:"提示",content:"暂无房源维护权限，请联系后台管理员开启。",showCancel:!1,success:()=>{e.index$1.navigateBack()}}),!1)},onSaleStatusChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.saleStatusOptions[t]||this.saleStatusOptions[0];this.form.sale_status=o.value},onPriceUnitChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.priceUnitOptions[t]||this.priceUnitOptions[0];this.form.price_unit=o&&o.value||"万"},async bootstrap(){await this.ensurePermission()&&(await this.loadFormOptions(),this.id&&(await this.loadContent(),await this.loadRenovation()))},async loadFormOptions(){const i=o.$store("user"),a=`wx_property_form_options_v2_${Number((i.userInfo||{}).business_id)||1}`,n=e.index$1.getStorageSync(a);if(n&&"object"==typeof n)return void this.applyFormOptions(n);const r=await t.propertyApi.getFormOptions({});if(!r||0!==r.code)return;const s=r.data||{};this.applyFormOptions(s);try{e.index$1.setStorageSync(a,s)}catch(l){}},applyFormOptions(e){const t=e=>(Array.isArray(e)?e:[]).map((e=>({label:String(e&&e.label||"").trim(),value:String(e&&e.value||"").trim()}))).filter((e=>e.label&&e.value)),o=t(e.sale_status);o.length&&(this.saleStatusOptions=o);const i=t(e.price_unit);i.length&&(this.priceUnitOptions=i);const a=t(e.floor_level);a.length&&(this.floorLevelOptions=a);const n=t(e.orientation);n.length&&(this.orientationOptions=n);const r=t(e.property_type);r.length&&(this.propertyTypeOptions=r);const s=t(e.decoration_type);s.length&&(this.decorationTypeOptions=s);const l=t(e.renovation_stage);l.length&&(this.renovationStageOptions=[{label:"请选择",value:""}].concat(l));const d=(e,t,o)=>{const i=String(this.form[e]||"").trim();(t||[]).some((e=>String(e.value)===i))||(this.form[e]=t&&t[0]&&t[0].value||o)};d("sale_status",this.saleStatusOptions,"on_sale"),d("price_unit",this.priceUnitOptions,"万"),d("floor_level",this.floorLevelOptions,""),d("orientation",this.orientationOptions,""),d("property_type",this.propertyTypeOptions,""),d("decoration_type",this.decorationTypeOptions,"");const m=String(this.renovation.current_stage||"").trim();m&&!(this.renovationStageOptions||[]).some((e=>String(e.value)===m))&&(this.renovationStageOptions=(this.renovationStageOptions||[]).concat([{label:m,value:m}]))},onBuildYearChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.buildYearOptions[t]||this.buildYearOptions[0];this.form.build_year=o.value},onFloorLevelChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.floorLevelOptions[t]||this.floorLevelOptions[0];this.form.floor_level=o.value},onOrientationChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.orientationOptions[t]||this.orientationOptions[0];this.form.orientation=o.value},onPropertyTypeChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.propertyTypeOptions[t]||this.propertyTypeOptions[0];this.form.property_type=o.value},onDecorationTypeChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.decorationTypeOptions[t]||this.decorationTypeOptions[0];this.form.decoration_type=o.value},onAddressRegionChange(e){const t=e&&e.detail&&e.detail.value||[];Array.isArray(t)&&(this.addressRegion=t)},buildFullAddress(){return[...Array.isArray(this.addressRegion)?this.addressRegion.map((e=>String(e||"").trim())).filter(Boolean):[],String(this.addressDetail||"").trim()].filter(Boolean).join(" ")},initAddressUIFromAddress(e){const t=String(e||"").trim();if(this.addressRegion=["","",""],this.addressDetail="",!t)return;const o=t.split(/\\s+/).filter(Boolean);if(o.length>=3)return this.addressRegion=[o[0]||"",o[1]||"",o[2]||""],void(this.addressDetail=o.slice(3).join(" "));this.addressDetail=t},onRenovationStageChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.renovationStageOptions[t]||this.renovationStageOptions[0];this.renovation.current_stage=o&&o.value||""},async loadContent(){const e=await t.propertyApi.getManageContent({id:this.id});if(!e||0!==e.code)return;const o=e.data||{};this.form={...this.form,...o},this.tags=Array.isArray(o.tags)?o.tags:[],this.images=Array.isArray(o.images)?o.images:[],this.form.build_year&&(this.form.build_year=String(this.form.build_year)),this.form.total_floors&&(this.form.total_floors=String(this.form.total_floors)),(this.form.weigh||0===this.form.weigh)&&(this.form.weigh=String(this.form.weigh)),null!==this.form.receiver_price&&void 0!==this.form.receiver_price||(this.form.receiver_price=""),null!==this.form.commission_rate&&void 0!==this.form.commission_rate||(this.form.commission_rate=""),null!==this.form.commission_reward&&void 0!==this.form.commission_reward||(this.form.commission_reward=""),this.initAddressUIFromAddress(this.form.address),!this.form.cover_image&&this.images.length>0&&(this.form.cover_image=this.images[0])},async loadRenovation(){if(!this.id)return;const e=await t.propertyApi.getManageRenovation({property_id:this.id});if(!e||0!==e.code)return;const o=e.data||{};this.renovation={...this.renovation,...o},this.renovationMaterials=Array.isArray(o.materials)?o.materials:[],this.renovationImages=Array.isArray(o.images)?o.images:[],null!==this.renovation.progress_percentage&&void 0!==this.renovation.progress_percentage||(this.renovation.progress_percentage=0),"none"!==this.renovation.renovation_status&&"in_progress"!==this.renovation.renovation_status&&"done"!==this.renovation.renovation_status&&(this.renovation.renovation_status="none");const i=String(this.renovation.current_stage||"").trim();i&&!(this.renovationStageOptions||[]).some((e=>String(e.value)===i))&&(this.renovationStageOptions=(this.renovationStageOptions||[]).concat([{label:i,value:i}]))},addTag(){const t=String(this.newTag||"").trim();t?this.tags.includes(t)?this.newTag="":this.tags.length>=6?e.index$1.showToast({title:"最多6个标签",icon:"none"}):(this.tags=this.tags.concat([t]),this.newTag=""):e.index$1.showToast({title:"请输入标签",icon:"none"})},removeTag(e){this.tags=this.tags.filter(((t,o)=>o!==e))},openImageActions(t){const o=this.images[t];if(!o)return;const i=o===this.form.cover_image,a=i?["删除"]:["设为封面","删除"];e.index$1.showActionSheet({itemList:a,success:e=>{const a=Number(e.tapIndex);if(!i&&0===a)return void(this.form.cover_image=o);a===(i?0:1)&&(this.images=this.images.filter(((e,o)=>o!==t)),this.form.cover_image===o&&(this.form.cover_image=this.images[0]||""))}})},openVideoActions(){const t=!!this.form.video_url,o=t?["更换视频","移除视频"]:["上传视频"];e.index$1.showActionSheet({itemList:o,success:async e=>{const o=Number(e.tapIndex);t?(0===o&&await this.pickVideo(),1===o&&(this.form.video_url="")):await this.pickVideo()}})},onRenovationStatusChange(e){const t=Number(e&&e.detail&&e.detail.value)||0,o=this.renovationStatusOptions[t]||this.renovationStatusOptions[0];this.renovation.renovation_status=o.value,"none"===o.value&&(this.renovation.progress_percentage=0,this.renovation.current_stage="",this.renovation.start_date="",this.renovation.estimated_finish_date="",this.renovation.actual_finish_date="",this.renovation.notes="",this.renovationMaterials=[],this.renovationImages=[]),"done"===o.value&&(this.renovation.progress_percentage=100)},addMaterial(){const t=String(this.newMaterial||"").trim();t?this.renovationMaterials.includes(t)?this.newMaterial="":this.renovationMaterials.length>=10?e.index$1.showToast({title:"最多10个材料",icon:"none"}):(this.renovationMaterials=this.renovationMaterials.concat([t]),this.newMaterial=""):e.index$1.showToast({title:"请输入材料",icon:"none"})},removeMaterial(e){this.renovationMaterials=this.renovationMaterials.filter(((t,o)=>o!==e))},openRenovationImageActions(t){this.renovationImages[t]&&e.index$1.showActionSheet({itemList:["删除"],success:()=>{this.renovationImages=this.renovationImages.filter(((e,o)=>o!==t))}})},pickRenovationImages(){this.uploading||(this.id?e.index$1.chooseImage({count:9,sizeType:["compressed"],sourceType:["album","camera"],success:async e=>{const t=e&&e.tempFilePaths||[];t.length&&await this.uploadFiles(t,"image","renovation")}}):e.index$1.showToast({title:"请先保存房源",icon:"none"}))},pickImages(){this.uploading||e.index$1.chooseImage({count:9,sizeType:["compressed"],sourceType:["album","camera"],success:async e=>{const t=e&&e.tempFilePaths||[];t.length&&await this.uploadFiles(t,"image","property")}})},pickVideo(){return this.uploading?Promise.resolve():new Promise((t=>{e.index$1.chooseVideo({sourceType:["album","camera"],maxDuration:60,compressed:!0,success:async e=>{var o;const i=e&&(e.tempFilePath||(null==(o=e.tempFilePaths)?void 0:o[0]));if(!i)return t();await this.uploadFiles([i],"video","property"),t()},fail:()=>t()})}))},uploadFiles(t=[],o="image",i="property"){return Array.isArray(t)&&0!==t.length?new Promise((async a=>{this.uploading=!0,e.index$1.showLoading({title:"上传中",mask:!0});try{for(let e=0;e<t.length;e++){const a=t[e],n=await this.uploadSingle(a,o).catch((()=>null)),r=n&&0===n.code&&n.data?n.data.url:"";r&&("video"===o?this.form.video_url=r:"renovation"===i?this.renovationImages=this.renovationImages.concat([r]):(this.images=this.images.concat([r]),this.form.cover_image||(this.form.cover_image=r)))}}finally{e.index$1.hideLoading(),this.uploading=!1,a()}})):Promise.resolve()},uploadSingle:(t,o)=>new Promise(((n,r)=>{const s=e.index$1.getStorageSync("token"),l=Math.floor(Date.now()/1e3),d={Accept:"text/json",Businessid:"1",apiverify:a(e.md5("gofly@888"+l)+"#"+l)};s&&(d.Authorization=`${s}`),e.index$1.uploadFile({url:`${i.baseUrl}/common/upload/upFile`,filePath:t,name:"file",formData:{filetype:o},header:d,success:t=>{try{const o=t&&t.data?t.data:"{}",i="string"==typeof o?JSON.parse(o):o;if(!i||0!==i.code)return e.index$1.showToast({title:i&&i.message||"上传失败",icon:"none"}),void r(i);n(i)}catch(o){e.index$1.showToast({title:"解析上传结果失败",icon:"none"}),r(o)}},fail:t=>{e.index$1.showToast({title:"上传失败",icon:"none"}),r(t)}})})),pickLocation(){e.index$1.chooseLocation({success:e=>{if(!e)return;const t=Number(e.latitude),o=Number(e.longitude);isFinite(t)&&isFinite(o)&&(this.form.latitude=t,this.form.longitude=o),e.name&&!this.form.community_name&&(this.form.community_name=String(e.name)),e.address&&!String(this.addressDetail||"").trim()&&(this.addressDetail=String(e.address))},fail:()=>{e.index$1.showToast({title:"无法打开地图",icon:"none"})}})},async save(){if(this.saving||this.uploading)return;const o=String(this.form.title||"").trim();if(o){this.saving=!0;try{const i={...this.id?{id:this.id}:{},title:o,sale_status:this.form.sale_status,price:this.form.price,price_unit:this.form.price_unit,area:this.form.area,rooms:Number(this.form.rooms||0),halls:Number(this.form.halls||0),bathrooms:Number(this.form.bathrooms||0),community_name:String(this.form.community_name||"").trim(),address:this.buildFullAddress(),latitude:this.form.latitude||"",longitude:this.form.longitude||"",tags:this.tags,images:this.images,cover_image:this.form.cover_image||"",video_url:this.form.video_url||"",allow_image_download:1===Number(this.form.allow_image_download)?1:0,allow_video_download:1===Number(this.form.allow_video_download)?1:0,build_year:this.form.build_year?Number(this.form.build_year):0,floor_level:String(this.form.floor_level||"").trim(),total_floors:Number(this.form.total_floors||0),orientation:String(this.form.orientation||"").trim(),property_type:String(this.form.property_type||"").trim(),decoration_type:String(this.form.decoration_type||"").trim(),owner_name:String(this.form.owner_name||"").trim(),owner_phone:String(this.form.owner_phone||"").trim(),receiver_name:String(this.form.receiver_name||"").trim(),receiver_phone:String(this.form.receiver_phone||"").trim(),receiver_price:this.form.receiver_price,commission_rate:this.form.commission_rate,commission_reward:this.form.commission_reward,weigh:Number(this.form.weigh||0),hot_status:1===Number(this.form.hot_status)?1:0,status:0===Number(this.form.status)?0:1},a=await t.propertyApi.saveManage(i);if(!a||0!==a.code)return;const n=Number(a&&a.data&&a.data.id)||0;!this.id&&n&&(this.id=n,await this.loadRenovation()),e.index$1.showToast({title:"保存成功",icon:"none"})}finally{this.saving=!1}}else e.index$1.showToast({title:"请填写房源标题",icon:"none"})},async saveRenovation(){if(!this.id)return void e.index$1.showToast({title:"请先保存房源",icon:"none"});if(this.savingRenovation||this.uploading)return;const o=String(this.renovation.renovation_status||"none"),i=Number(this.renovation.progress_percentage||0);if(!isFinite(i)||i<0||i>100)e.index$1.showToast({title:"进度需在0-100之间",icon:"none"});else{this.savingRenovation=!0;try{const a={property_id:this.id,renovation_status:o,progress_percentage:Math.floor(i),current_stage:String(this.renovation.current_stage||"").trim(),start_date:this.renovation.start_date||"",estimated_finish_date:this.renovation.estimated_finish_date||"",actual_finish_date:this.renovation.actual_finish_date||"",materials:this.renovationMaterials,images:this.renovationImages,notes:String(this.renovation.notes||"").trim(),status:1===Number(this.renovation.status)?1:0},n=await t.propertyApi.saveManageRenovation(a);if(!n||0!==n.code)return;e.index$1.showToast({title:"保存成功",icon:"none"}),await this.loadRenovation()}finally{this.savingRenovation=!1}}},preview(){this.id&&e.index$1.navigateTo({url:`/pages/property_detail/property_detail?id=${this.id}`})}}};if(!Array){e.resolveComponent("TopHeader")()}const r=e._export_sfc(n,[["render",function(t,o,i,a,n,r){var s,l,d,m,h,u,p,c,v;return e.e({a:e.o(((...e)=>r.goBack&&r.goBack(...e))),b:e.p({title:n.id?"编辑房源":"新增房源"}),c:n.form.title,d:e.o((e=>n.form.title=e.detail.value)),e:e.t((null==(s=n.saleStatusOptions[r.saleStatusIndex])?void 0:s.label)||"请选择"),f:n.saleStatusOptions.map((e=>e.label)),g:r.saleStatusIndex,h:e.o(((...e)=>r.onSaleStatusChange&&r.onSaleStatusChange(...e))),i:n.form.price,j:e.o((e=>n.form.price=e.detail.value)),k:e.t((null==(l=n.priceUnitOptions[r.priceUnitIndex])?void 0:l.label)||n.form.price_unit||"万"),l:n.priceUnitOptions.map((e=>e.label)),m:r.priceUnitIndex,n:e.o(((...e)=>r.onPriceUnitChange&&r.onPriceUnitChange(...e))),o:n.form.area,p:e.o((e=>n.form.area=e.detail.value)),q:n.form.rooms,r:e.o((e=>n.form.rooms=e.detail.value)),s:n.form.halls,t:e.o((e=>n.form.halls=e.detail.value)),v:n.form.bathrooms,w:e.o((e=>n.form.bathrooms=e.detail.value)),x:e.t((null==(d=n.buildYearOptions[r.buildYearIndex])?void 0:d.label)||"请选择"),y:n.buildYearOptions.map((e=>e.label)),z:r.buildYearIndex,A:e.o(((...e)=>r.onBuildYearChange&&r.onBuildYearChange(...e))),B:e.t((null==(m=n.floorLevelOptions[r.floorLevelIndex])?void 0:m.label)||"请选择"),C:n.floorLevelOptions.map((e=>e.label)),D:r.floorLevelIndex,E:e.o(((...e)=>r.onFloorLevelChange&&r.onFloorLevelChange(...e))),F:n.form.total_floors,G:e.o((e=>n.form.total_floors=e.detail.value)),H:e.t((null==(h=n.orientationOptions[r.orientationIndex])?void 0:h.label)||"请选择"),I:n.orientationOptions.map((e=>e.label)),J:r.orientationIndex,K:e.o(((...e)=>r.onOrientationChange&&r.onOrientationChange(...e))),L:e.t((null==(u=n.propertyTypeOptions[r.propertyTypeIndex])?void 0:u.label)||"请选择"),M:n.propertyTypeOptions.map((e=>e.label)),N:r.propertyTypeIndex,O:e.o(((...e)=>r.onPropertyTypeChange&&r.onPropertyTypeChange(...e))),P:e.t((null==(p=n.decorationTypeOptions[r.decorationTypeIndex])?void 0:p.label)||"请选择"),Q:n.decorationTypeOptions.map((e=>e.label)),R:r.decorationTypeIndex,S:e.o(((...e)=>r.onDecorationTypeChange&&r.onDecorationTypeChange(...e))),T:n.form.owner_name,U:e.o((e=>n.form.owner_name=e.detail.value)),V:n.form.owner_phone,W:e.o((e=>n.form.owner_phone=e.detail.value)),X:n.form.receiver_name,Y:e.o((e=>n.form.receiver_name=e.detail.value)),Z:n.form.receiver_phone,aa:e.o((e=>n.form.receiver_phone=e.detail.value)),ab:n.form.receiver_price,ac:e.o((e=>n.form.receiver_price=e.detail.value)),ad:e.f(n.images,((t,o,i)=>e.e({a:r.toFullMediaUrl(t),b:t===n.form.cover_image},(n.form.cover_image,{}),{c:"img-"+o,d:e.o((e=>r.openImageActions(o)),"img-"+o)}))),ae:e.o(((...e)=>r.pickImages&&r.pickImages(...e))),af:1===Number(n.form.allow_image_download),ag:e.o((e=>n.form.allow_image_download=e.detail.value?1:0)),ah:!n.form.video_url},n.form.video_url?{ai:r.toFullMediaUrl(n.form.video_url)}:{},{aj:e.o(((...e)=>r.openVideoActions&&r.openVideoActions(...e))),ak:1===Number(n.form.allow_video_download),al:e.o((e=>n.form.allow_video_download=e.detail.value?1:0)),am:e.f(n.tags,((t,o,i)=>({a:e.t(t),b:e.o((e=>r.removeTag(o)),"t-"+o),c:"t-"+o}))),an:0===n.tags.length},(n.tags.length,{}),{ao:n.newTag,ap:e.o((e=>n.newTag=e.detail.value)),aq:e.o(((...e)=>r.addTag&&r.addTag(...e))),ar:n.form.community_name,as:e.o((e=>n.form.community_name=e.detail.value)),at:e.t(r.addressRegionText),av:n.addressRegion,aw:e.o(((...e)=>r.onAddressRegionChange&&r.onAddressRegionChange(...e))),ax:n.addressDetail,ay:e.o((e=>n.addressDetail=e.detail.value)),az:e.t(n.form.latitude&&n.form.longitude?Number(n.form.latitude).toFixed(6)+", "+Number(n.form.longitude).toFixed(6):"未选择坐标"),aA:e.o(((...e)=>r.pickLocation&&r.pickLocation(...e))),aB:n.form.commission_rate,aC:e.o((e=>n.form.commission_rate=e.detail.value)),aD:n.form.commission_reward,aE:e.o((e=>n.form.commission_reward=e.detail.value)),aF:n.form.weigh,aG:e.o((e=>n.form.weigh=e.detail.value)),aH:e.t(1===Number(n.form.has_smart_lock)?"已绑定":"未绑定"),aI:1===Number(n.form.hot_status),aJ:e.o((e=>n.form.hot_status=e.detail.value?1:0)),aK:0===Number(n.form.status),aL:e.o((e=>n.form.status=e.detail.value?0:1)),aM:e.t((null==(c=n.renovationStatusOptions[r.renovationStatusIndex])?void 0:c.label)||"请选择"),aN:n.renovationStatusOptions.map((e=>e.label)),aO:r.renovationStatusIndex,aP:e.o(((...e)=>r.onRenovationStatusChange&&r.onRenovationStatusChange(...e))),aQ:!n.id},(n.id,{}),{aR:n.id&&"none"!==n.renovation.renovation_status},n.id&&"none"!==n.renovation.renovation_status?{aS:n.renovation.progress_percentage,aT:e.o((e=>n.renovation.progress_percentage=e.detail.value)),aU:e.t((null==(v=n.renovationStageOptions[r.renovationStageIndex])?void 0:v.label)||"请选择"),aV:n.renovationStageOptions.map((e=>e.label)),aW:r.renovationStageIndex,aX:e.o(((...e)=>r.onRenovationStageChange&&r.onRenovationStageChange(...e))),aY:e.t(n.renovation.start_date||"请选择"),aZ:n.renovation.start_date,ba:e.o((e=>n.renovation.start_date=e.detail.value)),bb:e.t(n.renovation.estimated_finish_date||"请选择"),bc:n.renovation.estimated_finish_date,bd:e.o((e=>n.renovation.estimated_finish_date=e.detail.value)),be:e.t(n.renovation.actual_finish_date||"请选择"),bf:n.renovation.actual_finish_date,bg:e.o((e=>n.renovation.actual_finish_date=e.detail.value))}:{},{bh:n.id&&"none"!==n.renovation.renovation_status},n.id&&"none"!==n.renovation.renovation_status?e.e({bi:e.f(n.renovationMaterials,((t,o,i)=>({a:e.t(t),b:e.o((e=>r.removeMaterial(o)),"m-"+o),c:"m-"+o}))),bj:0===n.renovationMaterials.length},(n.renovationMaterials.length,{}),{bk:n.newMaterial,bl:e.o((e=>n.newMaterial=e.detail.value)),bm:e.o(((...e)=>r.addMaterial&&r.addMaterial(...e))),bn:e.f(n.renovationImages,((t,o,i)=>({a:r.toFullMediaUrl(t),b:"rimg-"+o,c:e.o((e=>r.openRenovationImageActions(o)),"rimg-"+o)}))),bo:e.o(((...e)=>r.pickRenovationImages&&r.pickRenovationImages(...e))),bp:n.renovation.notes,bq:e.o((e=>n.renovation.notes=e.detail.value)),br:n.savingRenovation||n.uploading,bs:e.o(((...e)=>r.loadRenovation&&r.loadRenovation(...e))),bt:e.t(n.savingRenovation?"保存中...":"保存装修"),bv:n.savingRenovation||n.uploading,bw:e.o(((...e)=>r.saveRenovation&&r.saveRenovation(...e)))}):{},{bx:!n.id,by:e.o(((...e)=>r.preview&&r.preview(...e))),bz:e.t(n.saving?"保存中...":"保存"),bA:e.o(((...e)=>r.save&&r.save(...e)))})}]]);wx.createPage(r);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/property_manage/property_edit.js.map
