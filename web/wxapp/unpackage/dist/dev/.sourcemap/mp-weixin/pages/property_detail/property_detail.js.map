{"version":3,"file":"property_detail.js","sources":["pages/property_detail/property_detail.vue","D:/WinApp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvcGVydHlfZGV0YWlsL3Byb3BlcnR5X2RldGFpbC52dWU"],"sourcesContent":["<template>\n  <view class=\"detail-container\">\n    <!-- 顶部悬浮操作 -->\n    <view\n      class=\"float-header\"\n      :style=\"{\n        paddingTop: headerTop + 'px',\n        paddingLeft: headerPadLeftPx ? headerPadLeftPx + 'px' : undefined,\n        paddingRight: headerPadRightPx ? headerPadRightPx + 'px' : undefined,\n      }\"\n    >\n      <!-- 安全遮罩：顶部时用暗色渐变保证可读性；下滑后过渡到磨砂白底 -->\n      <view\n        class=\"fh-mask fh-mask--dark\"\n        :style=\"{ opacity: 1 - headerOpacity }\"\n      ></view>\n      <view\n        class=\"fh-mask fh-mask--light\"\n        :style=\"{ opacity: headerOpacity }\"\n      ></view>\n      <view class=\"header-left\">\n        <view\n          class=\"circle-btn\"\n          :class=\"{ 'is-solid': headerOpacity > 0.65 }\"\n          @click=\"goBack\"\n        >\n          <text class=\"material-symbols-outlined\">arrow_back</text>\n        </view>\n      </view>\n    </view>\n\n    <scroll-view scroll-y=\"true\" class=\"detail-scroll\" @scroll=\"onPageScroll\">\n      <!-- 轮播图 -->\n      <view class=\"banner\">\n        <swiper\n          class=\"swiper\"\n          circular\n          :indicator-dots=\"false\"\n          @change=\"swiperChange\"\n        >\n          <swiper-item v-for=\"(item, index) in bannerItems\" :key=\"index\">\n            <video\n              v-if=\"item.type === 'video'\"\n              :src=\"item.src\"\n              :poster=\"videoPoster\"\n              class=\"banner-video\"\n              controls\n              show-center-play-btn\n              object-fit=\"cover\"\n              playsinline\n              enable-progress-gesture\n            ></video>\n            <image\n              v-else\n              :src=\"item.src\"\n              mode=\"aspectFill\"\n              class=\"banner-image\"\n            ></image>\n          </swiper-item>\n        </swiper>\n        <view\n          class=\"banner-actions\"\n          v-if=\"showDownloadBtn\"\n          @click.stop=\"downloadCurrent\"\n        >\n          <view class=\"dl-pill\">\n            <text class=\"material-symbols-outlined dl-icon\">download</text>\n            <text class=\"dl-text\">{{ downloadLabel }}</text>\n          </view>\n        </view>\n        <view class=\"banner-indicator\"\n          >{{ bannerItems.length ? currentSwiper + 1 : 0 }}/{{\n            bannerItems.length\n          }}</view\n        >\n      </view>\n\n      <!-- 内容卡片 -->\n      <view class=\"content-card\">\n        <view class=\"title-section\">\n          <view class=\"title-row\">\n            <text class=\"title\">{{ (property && property.title) || \"-\" }}</text>\n            <view class=\"action-col\">\n              <view\n                v-if=\"!isPublicView\"\n                class=\"share-btn\"\n                @click=\"handleShare\"\n                @longpress=\"debugEditState\"\n              >\n                <text class=\"material-symbols-outlined share-icon\">share</text>\n                <text>分享</text>\n              </view>\n              <view class=\"edit-btn\" v-if=\"canEditThisProperty\" @click=\"goEdit\">\n                <text class=\"material-symbols-outlined edit-icon\">edit</text>\n                <text>编辑</text>\n              </view>\n            </view>\n          </view>\n          <view class=\"tags-row\">\n            <text\n              v-for=\"(t, idx) in ((property && property.tags) || []).slice(\n                0,\n                6,\n              )\"\n              :key=\"idx\"\n              class=\"tag\"\n              :class=\"tagClass(t)\"\n            >\n              {{ t }}\n            </text>\n          </view>\n          <view class=\"status-row\" v-if=\"canEditThisProperty\">\n            <view\n              class=\"status-chip\"\n              :class=\"(property && property.sale_status) || ''\"\n            >\n              <text class=\"material-symbols-outlined status-ic\">sell</text>\n              <text>{{\n                (property && property.sale_status_label) || \"状态\"\n              }}</text>\n            </view>\n            <view\n              v-if=\"Number(property && property.hot_status) === 1\"\n              class=\"status-chip hot\"\n            >\n              <text class=\"material-symbols-outlined status-ic\"\n                >local_fire_department</text\n              >\n              <text>推荐</text>\n            </view>\n          </view>\n        </view>\n\n        <!-- 核心数据展示 -->\n        <view class=\"stats-grid\">\n          <view class=\"stats-item\">\n            <view class=\"stats-val orange\">\n              {{ (property && property.price) || \"-\"\n              }}<text class=\"unit\">{{\n                (property && property.price_unit) || \"\"\n              }}</text>\n            </view>\n            <view class=\"stats-label\">售价</view>\n          </view>\n          <view class=\"stats-item border-l\">\n            <view class=\"stats-val\">{{ getLayoutText(property) }}</view>\n            <view class=\"stats-label\">户型</view>\n          </view>\n          <view class=\"stats-item border-l\">\n            <view class=\"stats-val\">\n              {{ (property && property.area) || \"-\"\n              }}<text class=\"unit\">㎡</text>\n            </view>\n            <view class=\"stats-label\">面积</view>\n          </view>\n        </view>\n\n        <!-- 佣金横幅 -->\n        <view v-if=\"!isPublicView\" class=\"commission-banner\">\n          <view class=\"banner-bg-decor\"></view>\n          <view class=\"banner-main\">\n            <view class=\"icon-box\">\n              <text class=\"material-symbols-outlined\">currency_yen</text>\n            </view>\n            <view class=\"banner-info\">\n              <text class=\"banner-title\">{{\n                getCommissionText(property)\n              }}</text>\n              <text class=\"banner-tip\">签约后7个工作日内结算</text>\n            </view>\n          </view>\n        </view>\n\n        <!-- 浏览数据 -->\n        <view class=\"data-row\">\n          <view class=\"data-group\">\n            <view class=\"data-item\">\n              <text class=\"val\">{{\n                (property && property.view_count) || 0\n              }}</text>\n              <text class=\"lab\">浏览</text>\n            </view>\n            <view class=\"data-item\">\n              <text class=\"val\">{{\n                (property && property.follow_count) || 0\n              }}</text>\n              <text class=\"lab\">关注人数</text>\n            </view>\n            <view class=\"data-item\">\n              <text class=\"val\">{{\n                (property && property.showing_count) || 0\n              }}</text>\n              <text class=\"lab\">带看次数</text>\n            </view>\n          </view>\n        </view>\n\n        <!-- 属性表 -->\n        <view class=\"section\">\n          <view class=\"section-title\">房源信息</view>\n          <view class=\"attr-grid\">\n            <view\n              class=\"attr-item\"\n              v-for=\"(attr, idx) in attributes\"\n              :key=\"idx\"\n            >\n              <text class=\"attr-label\">{{ attr.label }}</text>\n              <text class=\"attr-val\">{{ attr.value }}</text>\n            </view>\n          </view>\n        </view>\n\n        <!-- 房主与收房（与后台表单字段一致） -->\n        <view class=\"section\" v-if=\"canEditThisProperty\">\n          <view class=\"section-title\">房主与收房</view>\n          <view class=\"contact-card\">\n            <view class=\"contact-grid\">\n              <view class=\"contact-item\">\n                <text class=\"contact-label\">业主姓名</text>\n                <text class=\"contact-value\">{{\n                  (property && property.owner_name) || \"-\"\n                }}</text>\n              </view>\n              <view class=\"contact-item\">\n                <text class=\"contact-label\">业主电话</text>\n                <text class=\"contact-value\">{{\n                  (property && property.owner_phone) || \"-\"\n                }}</text>\n              </view>\n              <view class=\"contact-item\">\n                <text class=\"contact-label\">收房人姓名</text>\n                <text class=\"contact-value\">{{\n                  (property && property.receiver_name) || \"-\"\n                }}</text>\n              </view>\n              <view class=\"contact-item\">\n                <text class=\"contact-label\">收房人电话</text>\n                <text class=\"contact-value\">{{\n                  (property && property.receiver_phone) || \"-\"\n                }}</text>\n              </view>\n              <view class=\"contact-item wide\">\n                <text class=\"contact-label\">收房价格（支付业主）</text>\n                <text class=\"contact-value price\">{{\n                  property && property.receiver_price\n                    ? \"¥\" + property.receiver_price\n                    : \"-\"\n                }}</text>\n              </view>\n            </view>\n          </view>\n        </view>\n\n        <!-- 装修状态 -->\n        <view class=\"section\">\n          <view class=\"section-header\">\n            <text class=\"section-title\">装修状态</text>\n            <view class=\"reno-tabs\">\n              <view\n                class=\"reno-tab\"\n                v-for=\"t in renovationTabs\"\n                :key=\"t.key\"\n                :class=\"{ active: renovation.status === t.key }\"\n                @click=\"setRenovationStatus(t.key)\"\n              >\n                {{ t.label }}\n              </view>\n            </view>\n          </view>\n\n          <view class=\"reno-card\">\n            <view class=\"reno-top\">\n              <view class=\"reno-badge\" :class=\"renovation.status\">\n                {{\n                  renovation.status === \"none\"\n                    ? \"未装修\"\n                    : renovation.status === \"in_progress\"\n                      ? \"装修进行中\"\n                      : \"装修完成\"\n                }}\n              </view>\n              <text class=\"reno-sub\">{{ renovation.subtitle }}</text>\n            </view>\n\n            <!-- 未装修 -->\n            <view v-if=\"renovation.status === 'none'\" class=\"reno-empty\">\n              <text class=\"material-symbols-outlined reno-empty-icon\"\n                >home_repair_service</text\n              >\n              <view class=\"reno-empty-texts\">\n                <text class=\"reno-empty-title\">当前房源未进行装修</text>\n                <text class=\"reno-empty-desc\"\n                  >适合按个人喜好自由设计，交付为毛坯/简装（示例）。</text\n                >\n              </view>\n            </view>\n\n            <!-- 装修进行中 -->\n            <view\n              v-else-if=\"renovation.status === 'in_progress'\"\n              class=\"reno-progress-wrap\"\n            >\n              <swiper\n                class=\"reno-swiper\"\n                circular\n                :indicator-dots=\"true\"\n                :autoplay=\"true\"\n                :interval=\"3500\"\n              >\n                <swiper-item v-for=\"(img, idx) in renovation.images\" :key=\"idx\">\n                  <image\n                    :src=\"img\"\n                    mode=\"aspectFill\"\n                    class=\"reno-image\"\n                  ></image>\n                </swiper-item>\n              </swiper>\n\n              <view class=\"reno-progress\">\n                <view class=\"reno-progress-bar\">\n                  <view\n                    class=\"reno-progress-fill\"\n                    :style=\"{ width: renovation.progress + '%' }\"\n                  ></view>\n                </view>\n                <text class=\"reno-progress-text\"\n                  >{{ renovation.progress }}% · {{ renovation.stage }}</text\n                >\n              </view>\n\n              <view class=\"reno-info\">\n                <view class=\"reno-info-row\">\n                  <text class=\"k\">预计完工</text>\n                  <text class=\"v\">{{ renovation.eta }}</text>\n                </view>\n                <view class=\"reno-info-row\">\n                  <text class=\"k\">材料</text>\n                  <view class=\"chips\">\n                    <text\n                      class=\"chip\"\n                      v-for=\"(m, idx) in renovation.materials\"\n                      :key=\"'m-' + idx\"\n                      >{{ m }}</text\n                    >\n                  </view>\n                </view>\n                <view class=\"reno-info-row col\">\n                  <text class=\"k\">施工说明</text>\n                  <text class=\"v desc\">{{ renovation.note }}</text>\n                </view>\n              </view>\n            </view>\n\n            <!-- 装修完成 -->\n            <view v-else class=\"reno-done\">\n              <view class=\"reno-info\">\n                <view class=\"reno-info-row\">\n                  <text class=\"k\">完成时间</text>\n                  <text class=\"v\">{{ renovation.finishAt }}</text>\n                </view>\n                <view class=\"reno-info-row\">\n                  <text class=\"k\">材料</text>\n                  <view class=\"chips\">\n                    <text\n                      class=\"chip\"\n                      v-for=\"(m, idx) in renovation.materials\"\n                      :key=\"'dm-' + idx\"\n                      >{{ m }}</text\n                    >\n                  </view>\n                </view>\n                <view class=\"reno-info-row col\">\n                  <text class=\"k\">装修说明</text>\n                  <text class=\"v desc\">{{ renovation.note }}</text>\n                </view>\n              </view>\n            </view>\n          </view>\n        </view>\n\n        <!-- 交易信息 -->\n        <view class=\"section\">\n          <view class=\"section-title\">交易信息</view>\n          <view class=\"info-list\">\n            <view class=\"info-item\">\n              <text class=\"material-symbols-outlined info-icon\">payments</text>\n              <view class=\"info-content\">\n                <text class=\"info-title\">交易税费</text>\n                <text class=\"info-desc\">净得价，税费由买方承担</text>\n              </view>\n            </view>\n            <view class=\"info-divider\"></view>\n            <view class=\"info-item\">\n              <text class=\"material-symbols-outlined info-icon\">home_work</text>\n              <view class=\"info-content\">\n                <text class=\"info-title\">房屋现状</text>\n                <text class=\"info-desc\">目前空置，业主诚意出售</text>\n              </view>\n            </view>\n            <view class=\"info-divider\"></view>\n            <view class=\"info-item\">\n              <text class=\"material-symbols-outlined info-icon primary\"\n                >lock_open</text\n              >\n              <view class=\"info-content\">\n                <view class=\"info-title-row\">\n                  <text class=\"info-title\">看房类型</text>\n                  <text class=\"info-tag\">智能开锁</text>\n                </view>\n                <text class=\"info-desc\">支持APP一键开锁，随时看房</text>\n              </view>\n            </view>\n          </view>\n        </view>\n\n        <!-- 位置周边 -->\n        <view class=\"section\">\n          <view class=\"section-header\">\n            <text class=\"section-title\">位置周边</text>\n            <view class=\"header-more\" @click=\"openMap\">\n              <text>查看地图</text>\n              <text class=\"material-symbols-outlined more-icon\"\n                >chevron_right</text\n              >\n            </view>\n          </view>\n          <view class=\"map-box\" @click=\"openMap\">\n            <map\n              v-if=\"hasLocation\"\n              class=\"map-native\"\n              :latitude=\"mapLat\"\n              :longitude=\"mapLng\"\n              :scale=\"16\"\n              :markers=\"mapMarkers\"\n              :enable-zoom=\"false\"\n              :enable-scroll=\"false\"\n              :enable-rotate=\"false\"\n              :enable-overlooking=\"false\"\n              :enable-satellite=\"false\"\n              :show-location=\"false\"\n              @tap=\"openMap\"\n            ></map>\n            <view v-else class=\"map-image map-image-empty\">\n              <text class=\"material-symbols-outlined\">map</text>\n            </view>\n            <view class=\"map-mask\">\n              <view class=\"map-pin\">\n                <text class=\"material-symbols-outlined pin-icon\"\n                  >location_on</text\n                >\n                <text>{{ mapPinText() }}</text>\n              </view>\n              <view class=\"map-coords\" v-if=\"hasLocation\">\n                <text class=\"coord-text\"\n                  >{{ mapLng.toFixed(6) }}, {{ mapLat.toFixed(6) }}</text\n                >\n              </view>\n            </view>\n          </view>\n        </view>\n\n        <!-- 相似房源 -->\n        <view class=\"section no-pb\">\n          <view class=\"section-title\">推荐相似房源</view>\n          <scroll-view scroll-x=\"true\" class=\"recommend-scroll\">\n            <view class=\"recommend-row\">\n              <view\n                class=\"recommend-card\"\n                v-for=\"(rec, rIdx) in recommends\"\n                :key=\"rIdx\"\n                @click=\"goToRec(rec)\"\n              >\n                <view class=\"rec-img-box\">\n                  <image\n                    v-if=\"normalizeImage(rec.image)\"\n                    :src=\"normalizeImage(rec.image)\"\n                    mode=\"aspectFill\"\n                    class=\"rec-image\"\n                  ></image>\n                  <view v-else class=\"rec-image rec-image-empty\">\n                    <text class=\"material-symbols-outlined\">image</text>\n                  </view>\n                  <view class=\"rec-tag\">{{ rec.size }}㎡</view>\n                </view>\n                <view class=\"rec-info\">\n                  <view class=\"rec-title\">{{ rec.name }}</view>\n                  <view class=\"rec-meta\">\n                    <text class=\"rec-desc\">{{ rec.rooms }}</text>\n                    <text class=\"rec-price\">{{ rec.price }}</text>\n                  </view>\n                </view>\n              </view>\n            </view>\n          </scroll-view>\n        </view>\n      </view>\n      <view v-if=\"!isPublicView\" class=\"bottom-spacer\"></view>\n    </scroll-view>\n\n    <!-- 底部操作栏 -->\n    <view class=\"bottom-bar\" v-if=\"!isPublicView\">\n      <view class=\"bar-content\">\n        <view class=\"action-btns\">\n          <view class=\"action-item\" @click=\"callOwner\">\n            <text class=\"material-symbols-outlined bar-icon\">call</text>\n            <text class=\"bar-text\">拨打电话</text>\n          </view>\n          <view class=\"action-item\" @click=\"toggleFollow\">\n            <text\n              v-if=\"isFollowed\"\n              class=\"material-symbols-outlined bar-icon filled\"\n              >favorite</text\n            >\n            <text v-else class=\"material-symbols-outlined bar-icon\"\n              >favorite_border</text\n            >\n            <text class=\"bar-text\">关注</text>\n          </view>\n        </view>\n        <view class=\"bar-divider\"></view>\n        <button class=\"unlock-btn\" @click=\"openLock\">\n          <text\n            v-if=\"hasSmartLock\"\n            class=\"material-symbols-outlined unlock-icon filled\"\n            >lock</text\n          >\n          <text v-else class=\"material-symbols-outlined unlock-icon\"\n            >lock_open</text\n          >\n          <text>{{ hasSmartLock ? \"智能锁\" : \"未绑定智能锁\" }}</text>\n        </button>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport propertyApi from \"@/api/property\";\nimport $store from \"@/store\";\n\nexport default {\n  data() {\n    return {\n      propertyId: 0,\n      loading: false,\n      property: {},\n      isPublicView: false,\n      publicFromAgentId: 0,\n      publicFromStyle: 0,\n      currentUserId: 0,\n      canManageProperties: false,\n      statusBarHeight: 0,\n      headerTop: 0,\n      headerPadLeftPx: 0,\n      headerPadRightPx: 0,\n      // 0：顶部（暗色渐变遮罩） -> 1：下滑后（磨砂白底）\n      headerOpacity: 0,\n      currentSwiper: 0,\n      isFollowed: false,\n      hasSmartLock: false,\n      ownerPhone: \"\",\n      images: [],\n      bannerItems: [],\n      videoUrl: \"\",\n      videoPoster: \"\",\n      allowImageDownload: true,\n      allowVideoDownload: true,\n      mapLat: 0,\n      mapLng: 0,\n      mapMarkers: [],\n\n      attributes: [\n        { label: \"单价\", value: \"9,086元/m²\" },\n        { label: \"楼层\", value: \"中层 / 共32层\" },\n        { label: \"朝向\", value: \"南北通透\" },\n        { label: \"装修\", value: \"精装修\" },\n        { label: \"年代\", value: \"2019年建\" },\n        { label: \"产权\", value: \"商品房\" },\n      ],\n\n      // 未装修：展示“未装修”状态说明\n      // 装修进行中：展示 轮播施工图 + 进度条 + 预计完工 + 材料标签 + 施工说明\n      // 装修完成：展示完成时间 + 材料 + 装修说明\n      // 实现方式：\n      // 页面右上角用小的状态切换条（未装修/进行中/已完成）做演示切换（静态数据）\n      // 数据在 data() 里新增 renovationTabs 和 renovation（包含 images/materials/note/progress/stage 等）\n      // 已补齐对应样式（与当前“高端”风格一致）\n\n      renovationTabs: [\n        { key: \"none\", label: \"未装修\" },\n        { key: \"in_progress\", label: \"进行中\" },\n        { key: \"done\", label: \"已完成\" },\n      ],\n      renovation: {\n        status: \"in_progress\", // none | in_progress | done\n        subtitle: \"高端精装，环保材料（示例）\",\n        progress: 68,\n        stage: \"水电验收完成，正在进行泥木施工\",\n        eta: \"预计 2026-02-20\",\n        finishAt: \"2026-01-10\",\n        materials: [\"圣象地板\", \"马可波罗瓷砖\", \"多乐士乳胶漆\"],\n        note: \"客厅墙面已完成找平与底漆，卫生间防水已做闭水试验；全屋线管/强弱电分离施工完成。\",\n        images: [],\n      },\n      recommends: [\n        {\n          name: \"阳光花园三期 2室\",\n          rooms: \"2室1厅\",\n          price: \"72万\",\n          size: \"89\",\n          image: \"\",\n        },\n        {\n          name: \"金地名津 精装大三房\",\n          rooms: \"3室2厅\",\n          price: \"98万\",\n          size: \"96\",\n          image: \"\",\n        },\n        {\n          name: \"万科四季花城\",\n          rooms: \"3室2厅\",\n          price: \"105万\",\n          size: \"110\",\n          image: \"\",\n        },\n      ],\n    };\n  },\n  onLoad(options) {\n    const info = uni.getSystemInfoSync();\n    this.statusBarHeight = info.statusBarHeight;\n    // #ifdef MP-WEIXIN\n    try {\n      if (typeof wx !== \"undefined\" && wx.getMenuButtonBoundingClientRect) {\n        const rect = wx.getMenuButtonBoundingClientRect();\n        // 让右上角按钮避开胶囊按钮区域\n        const w = Number(info.windowWidth || 375);\n        const rpx2px = w / 750;\n        const padLeftPx = Math.round(32 * rpx2px); // .float-header 左右 32rpx\n        const rightSafePx = Math.max(0, w - Number(rect.left || 0));\n        this.headerPadLeftPx = padLeftPx;\n        this.headerPadRightPx = padLeftPx + rightSafePx;\n        // 与胶囊按钮垂直居中对齐：用胶囊中心线对齐返回圆按钮中心线\n        const circleBtnSizePx = 80 * rpx2px; // .circle-btn: 80rpx\n        const capsuleCenterY =\n          Number(rect.top || 0) + Number(rect.height || 0) / 2;\n        const top = capsuleCenterY - circleBtnSizePx / 2;\n        this.headerTop = Math.max(\n          Number(this.statusBarHeight || 0),\n          Math.round(top),\n        );\n      } else {\n        this.headerTop = this.statusBarHeight + 12;\n      }\n    } catch (e) {\n      this.headerTop = this.statusBarHeight + 12;\n    }\n    // #endif\n    // #ifndef MP-WEIXIN\n    this.headerTop = this.statusBarHeight + 12;\n    // #endif\n\n    const publicRaw = String(\n      (options && (options.public || options.is_public)) || \"\",\n    )\n      .trim()\n      .toLowerCase();\n    this.isPublicView =\n      publicRaw === \"1\" || publicRaw === \"true\" || publicRaw === \"yes\";\n    this.publicFromAgentId =\n      Number(options && (options.from_agent_id || options.agent_id || 0)) || 0;\n    this.publicFromStyle = Number(options && options.from_style) || 0;\n\n    const id =\n      Number(options && (options.id || options.ID || options.property_id)) || 0;\n    this.propertyId = id;\n    if (!this.propertyId) {\n      uni.showToast({ title: \"房源ID缺失\", icon: \"none\" });\n      return;\n    }\n    if (!this.isPublicView) this.ensureCanManageProperties();\n    this.loadDetail();\n  },\n  computed: {\n    canEditThisProperty() {\n      if (this.isPublicView) return false;\n      if (!this.canManageProperties) return false;\n      const pid = Number(this.propertyId || 0) || 0;\n      if (!pid) return false;\n      const agentId = Number(this.property && this.property.agent_id) || 0;\n      const uid = Number(this.currentUserId || 0) || 0;\n      // 最小权限：仅允许编辑自己维护(agent_id=自己)的房源\n      if (!uid || !agentId) return false;\n      return agentId === uid;\n    },\n    showDownloadBtn() {\n      if (this.isPublicView) return false;\n      const item = this.getCurrentBannerItem();\n      if (!item) return false;\n      if (item.type === \"video\") return !!this.allowVideoDownload;\n      if (item.type === \"image\") return !!this.allowImageDownload;\n      return false;\n    },\n    downloadLabel() {\n      const item = this.getCurrentBannerItem();\n      if (!item) return \"下载\";\n      return item.type === \"video\" ? \"下载视频\" : \"下载图片\";\n    },\n    hasLocation() {\n      const lat = Number(this.mapLat);\n      const lng = Number(this.mapLng);\n      return !!lat && !!lng && isFinite(lat) && isFinite(lng);\n    },\n  },\n  methods: {\n    async ensureCanManageProperties() {\n      // 仅用于 UI 控制；最终权限以后端校验为准\n      if (this.isPublicView) {\n        this.canManageProperties = false;\n        this.currentUserId = 0;\n        return;\n      }\n      const userStore = $store(\"user\");\n      const token = uni.getStorageSync(\"token\");\n      if (!token && !userStore.isLogin) {\n        this.canManageProperties = false;\n        this.currentUserId = 0;\n        return;\n      }\n      try {\n        const ui = userStore.userInfo || {};\n        // 兼容：老版本缓存的 userInfo 可能没有 can_manage_properties，需要强制刷新一次\n        if (!ui.id || typeof ui.can_manage_properties === \"undefined\") {\n          await userStore.getInfo();\n        }\n      } catch (e) {}\n      const u = userStore.userInfo || {};\n      this.currentUserId = Number(u.id || 0) || 0;\n      this.canManageProperties = Number(u.can_manage_properties) === 1;\n      try {\n        console.log(\"[property_detail] perm\", {\n          id: this.currentUserId,\n          can_manage_properties: u.can_manage_properties,\n        });\n      } catch (e) {}\n    },\n    goEdit() {\n      if (!this.propertyId) return;\n      uni.navigateTo({\n        url: `/pages/property_manage/property_edit?id=${this.propertyId}`,\n      });\n    },\n    debugEditState() {\n      try {\n        const uid = Number(this.currentUserId || 0) || 0;\n        const can = !!this.canManageProperties;\n        const agentId = Number(this.property && this.property.agent_id) || 0;\n        const show = !!this.canEditThisProperty;\n        uni.showModal({\n          title: \"编辑按钮诊断\",\n          content: [\n            `can_manage_properties: ${can ? 1 : 0}`,\n            `currentUserId: ${uid}`,\n            `property.agent_id: ${agentId}`,\n            `canEditThisProperty: ${show ? 1 : 0}`,\n            show ? \"✅ 满足条件应显示\" : \"❌ 条件不满足所以不显示\",\n          ].join(\"\\n\"),\n          showCancel: false,\n        });\n      } catch (e) {\n        // ignore\n      }\n    },\n    tagClass(tag) {\n      const t = String(tag || \"\").trim();\n      if (!t) return \"\";\n      if (t.includes(\"急售\") || t.includes(\"降价\")) return \"orange\";\n      return \"\";\n    },\n    getLayoutText(p) {\n      const rooms = Number(p && p.rooms) || 0;\n      const halls = Number(p && p.halls) || 0;\n      const bathrooms = Number(p && p.bathrooms) || 0;\n      if (!rooms && !halls && !bathrooms) return \"-\";\n      let s = \"\";\n      if (rooms) s += `${rooms}室`;\n      if (halls) s += `${halls}厅`;\n      if (bathrooms) s += `${bathrooms}卫`;\n      return s || \"-\";\n    },\n    getUnitPriceText(p) {\n      const price = Number(p && p.price);\n      const area = Number(p && p.area);\n      if (!price || !area) return \"-\";\n      const unit = (p && p.price_unit) || \"\";\n      let totalYuan = price;\n      if (unit === \"万\") totalYuan = price * 10000;\n      const per = totalYuan / area;\n      if (!per || !isFinite(per)) return \"-\";\n      return `${Math.round(per).toLocaleString()}元/㎡`;\n    },\n    buildAttributes(p) {\n      const attrs = [];\n      attrs.push({ label: \"单价\", value: this.getUnitPriceText(p) });\n      const floor = String((p && p.floor_level) || \"\").trim();\n      const totalFloors = Number(p && p.total_floors) || 0;\n      if (floor || totalFloors) {\n        attrs.push({\n          label: \"楼层\",\n          value: `${floor || \"-\"}${totalFloors ? ` / 共${totalFloors}层` : \"\"}`,\n        });\n      }\n      attrs.push({\n        label: \"朝向\",\n        value: p && p.orientation ? p.orientation : \"-\",\n      });\n      attrs.push({\n        label: \"装修\",\n        value: p && p.decoration_type ? p.decoration_type : \"-\",\n      });\n      const year = Number(p && p.build_year) || 0;\n      attrs.push({ label: \"年代\", value: year ? `${year}年建` : \"-\" });\n      attrs.push({\n        label: \"物业类型\",\n        value: p && p.property_type ? p.property_type : \"-\",\n      });\n      return attrs;\n    },\n    getCommissionText(p) {\n      const rate = String((p && p.commission_rate) || \"\").trim();\n      const reward = String((p && p.commission_reward) || \"\").trim();\n      const hasRate =\n        !!rate && rate !== \"0\" && rate !== \"0.0\" && rate !== \"0.00\";\n      const hasReward =\n        !!reward && reward !== \"0\" && reward !== \"0.0\" && reward !== \"0.00\";\n      if (hasRate && hasReward) return `佣金${rate}% ，成交奖励￥${reward}`;\n      if (hasRate) return `佣金${rate}%`;\n      if (hasReward) return `成交奖励￥${reward}`;\n      return \"佣金待定\";\n    },\n    mapPinText() {\n      const name = String(\n        (this.property && this.property.community_name) || \"\",\n      ).trim();\n      const addr = String(\n        (this.property && this.property.address) || \"\",\n      ).trim();\n      if (name && addr) return `${name} · ${addr}`;\n      return name || addr || \"暂无位置信息\";\n    },\n    normalizeImage(url) {\n      const imageUrl = String(url || \"\").trim();\n      if (!imageUrl) return \"\";\n      if (imageUrl.indexOf(\"/static/images/\") === 0) return \"\";\n      return imageUrl;\n    },\n    async loadDetail() {\n      if (this.loading || !this.propertyId) return false;\n      this.loading = true;\n      let res;\n      try {\n        res = await propertyApi.getDetail({\n          id: this.propertyId,\n          public: this.isPublicView ? 1 : 0,\n        });\n      } catch (e) {\n        this.loading = false;\n        if (!this.isPublicView && !uni.getStorageSync(\"token\")) {\n          uni.reLaunch({ url: \"/pages/login/login\" });\n        }\n        return false;\n      }\n      this.loading = false;\n      if (!res || res.code !== 0) {\n        const msg = String((res && (res.message || res.msg)) || \"\").trim();\n        if (!this.isPublicView && /登录|token|认证/i.test(msg)) {\n          uni.reLaunch({ url: \"/pages/login/login\" });\n          return false;\n        }\n        setTimeout(() => {\n          this.goBack();\n        }, 600);\n        return false;\n      }\n\n      const data = res.data || {};\n      if (typeof data.public_view !== \"undefined\") {\n        this.isPublicView = !!data.public_view;\n      }\n      const p = data.property || {};\n      // 兼容：后端也会回传 current_user（已登录用户ID）\n      if (!this.currentUserId)\n        this.currentUserId = Number(data.current_user || 0) || 0;\n      if (!p || !p.id) {\n        setTimeout(() => {\n          uni.navigateBack();\n        }, 600);\n        return false;\n      }\n      this.property = p;\n      this.isFollowed = !!data.is_followed;\n      this.hasSmartLock = Number(p.has_smart_lock) === 1;\n      this.ownerPhone = String(p.owner_phone || \"\").trim();\n      if (this.isPublicView) this.ownerPhone = \"\";\n\n      // 下载权限（后端默认：1 允许）\n      this.allowImageDownload = Number(p.allow_image_download) !== 0;\n      this.allowVideoDownload = Number(p.allow_video_download) !== 0;\n\n      // 视频（单个）\n      this.videoUrl = String(p.video_url || \"\").trim();\n      this.videoPoster = this.normalizeImage(p.cover_image);\n\n      const imgs = Array.isArray(data.images)\n        ? data.images\n        : Array.isArray(p.images)\n          ? p.images\n          : [];\n      const normalizedImgs = imgs\n        .map((u) => this.normalizeImage(u))\n        .filter(Boolean);\n      this.images = normalizedImgs;\n      this.currentSwiper = 0;\n\n      // Banner：优先展示视频（若存在）\n      const items = [];\n      if (this.videoUrl) items.push({ type: \"video\", src: this.videoUrl });\n      (this.images || []).forEach((u) => items.push({ type: \"image\", src: u }));\n      this.bannerItems = items;\n\n      // 地图坐标（小程序 map 组件）\n      const lat = Number(p.latitude);\n      const lng = Number(p.longitude);\n      this.mapLat = isFinite(lat) ? lat : 0;\n      this.mapLng = isFinite(lng) ? lng : 0;\n      this.mapMarkers =\n        this.mapLat && this.mapLng\n          ? [\n              {\n                id: 1,\n                latitude: this.mapLat,\n                longitude: this.mapLng,\n                width: 26,\n                height: 26,\n              },\n            ]\n          : [];\n\n      this.attributes = this.buildAttributes(p);\n\n      const r = data.renovation || {};\n      const statusRaw = String(r.renovation_status || \"\").trim();\n      let status = \"none\";\n      if (\n        statusRaw === \"in_progress\" ||\n        statusRaw === \"done\" ||\n        statusRaw === \"none\"\n      ) {\n        status = statusRaw;\n      } else if (statusRaw === \"1\") {\n        status = \"in_progress\";\n      } else if (statusRaw === \"2\") {\n        status = \"done\";\n      }\n      this.renovation = {\n        status,\n        subtitle: String(r.subtitle || \"房源装修情况\").trim() || \"房源装修情况\",\n        progress: Number(r.progress_percentage || 0) || 0,\n        stage: String(r.current_stage || \"\").trim() || \"—\",\n        eta: String(r.estimated_finish_date || \"\").trim() || \"—\",\n        finishAt: String(r.actual_finish_date || \"\").trim() || \"—\",\n        materials: Array.isArray(r.materials) ? r.materials : [],\n        note: String(r.notes || \"\").trim() || \"—\",\n        images: Array.isArray(r.images)\n          ? r.images.map((u) => this.normalizeImage(u)).filter(Boolean)\n          : [],\n      };\n\n      const rec = Array.isArray(data.recommends) ? data.recommends : [];\n      this.recommends = rec.map((it) => ({\n        id: it.id,\n        name: it.title || it.name || \"房源\",\n        rooms: this.getLayoutText(it),\n        price: `${it.price || \"-\"}${it.price_unit || \"\"}`,\n        size: it.area || \"-\",\n        image: this.normalizeImage(it.image || it.cover_image || \"\"),\n      }));\n      return true;\n    },\n    onPageScroll(e) {\n      // scroll-view 的 scrollTop（px）\n      const st = Number((e && e.detail && e.detail.scrollTop) || 0);\n      // 越往下越“实”（白底更明显）；回到顶部恢复暗色渐变\n      const fadeDistance = 160;\n      const next = Math.min(1, st / fadeDistance);\n      this.headerOpacity = Math.max(0, Math.min(1, Number(next.toFixed(3))));\n    },\n    goBack() {\n      if (!this.isPublicView) {\n        uni.navigateBack();\n        return;\n      }\n      const pages = getCurrentPages ? getCurrentPages() : [];\n      if (pages && pages.length > 1) {\n        uni.navigateBack();\n        return;\n      }\n      const aid = Number(this.publicFromAgentId || 0);\n      const style = Number(this.publicFromStyle || 0);\n      if (aid > 0) {\n        uni.reLaunch({\n          url: `/pages/agent_public_card/agent_public_card?agent_id=${encodeURIComponent(\n            aid,\n          )}&style=${encodeURIComponent(style)}`,\n        });\n        return;\n      }\n      uni.reLaunch({ url: \"/pages/login/login\" });\n    },\n    goToRec(rec) {\n      const id = Number(rec && (rec.id || rec.ID)) || 0;\n      if (!id) return;\n      if (id === this.propertyId) return;\n      const publicQuery = this.isPublicView\n        ? `&public=1&from_agent_id=${encodeURIComponent(\n            this.publicFromAgentId,\n          )}&from_style=${encodeURIComponent(this.publicFromStyle)}`\n        : \"\";\n      uni.redirectTo({\n        url: `/pages/property_detail/property_detail?id=${encodeURIComponent(\n          id,\n        )}${publicQuery}`,\n      });\n    },\n    swiperChange(e) {\n      this.currentSwiper = e.detail.current;\n    },\n    getCurrentBannerItem() {\n      const list = Array.isArray(this.bannerItems) ? this.bannerItems : [];\n      const idx = Number(this.currentSwiper) || 0;\n      return list[idx] || null;\n    },\n\n    // 申请相册权限（用于保存图片/视频）\n    ensureAlbumPermission() {\n      return new Promise((resolve, reject) => {\n        uni.getSetting({\n          success: (st) => {\n            const ok =\n              st && st.authSetting && st.authSetting[\"scope.writePhotosAlbum\"];\n            if (ok) return resolve(true);\n            uni.authorize({\n              scope: \"scope.writePhotosAlbum\",\n              success: () => resolve(true),\n              fail: () => {\n                uni.showModal({\n                  title: \"需要相册权限\",\n                  content: \"保存到相册需要授权，请在设置中开启相册权限。\",\n                  confirmText: \"去设置\",\n                  success: (r) => {\n                    if (r.confirm) {\n                      uni.openSetting({\n                        success: () => resolve(true),\n                        fail: () => reject(false),\n                      });\n                    } else {\n                      reject(false);\n                    }\n                  },\n                });\n              },\n            });\n          },\n          fail: () => reject(false),\n        });\n      });\n    },\n\n    async downloadCurrent() {\n      if (this.isPublicView) return;\n      const item = this.getCurrentBannerItem();\n      if (!item) return;\n      if (item.type === \"video\" && !this.allowVideoDownload) return;\n      if (item.type === \"image\" && !this.allowImageDownload) return;\n\n      try {\n        await this.ensureAlbumPermission();\n      } catch (e) {\n        return;\n      }\n\n      const url = String(item.src || \"\").trim();\n      if (!url) return;\n      uni.showLoading({ title: \"下载中...\" });\n      uni.downloadFile({\n        url,\n        success: (d) => {\n          const fp = d && d.tempFilePath;\n          if (!fp) {\n            uni.hideLoading();\n            uni.showToast({ title: \"下载失败\", icon: \"none\" });\n            return;\n          }\n          if (item.type === \"video\") {\n            uni.saveVideoToPhotosAlbum({\n              filePath: fp,\n              success: () =>\n                uni.showToast({ title: \"已保存视频\", icon: \"success\" }),\n              fail: () => uni.showToast({ title: \"保存失败\", icon: \"none\" }),\n              complete: () => uni.hideLoading(),\n            });\n          } else {\n            uni.saveImageToPhotosAlbum({\n              filePath: fp,\n              success: () =>\n                uni.showToast({ title: \"已保存图片\", icon: \"success\" }),\n              fail: () => uni.showToast({ title: \"保存失败\", icon: \"none\" }),\n              complete: () => uni.hideLoading(),\n            });\n          }\n        },\n        fail: () => {\n          uni.hideLoading();\n          uni.showToast({ title: \"下载失败\", icon: \"none\" });\n        },\n      });\n    },\n    handleShare() {\n      if (this.isPublicView) return;\n      const title =\n        this.property && this.property.title ? this.property.title : \"房源\";\n      const id = this.propertyId;\n      uni.showActionSheet({\n        itemList: [\"生成获客海报\", \"复制房源链接\", \"模拟分享（占位）\"],\n        success: (res) => {\n          if (res.tapIndex === 0) {\n            uni.navigateTo({\n              url: `/pages/marketing_posters/marketing_posters?title=${encodeURIComponent(\n                title,\n              )}`,\n            });\n            return;\n          }\n          if (res.tapIndex === 1) {\n            const link = id\n              ? `/pages/property_detail/property_detail?id=${encodeURIComponent(\n                  id,\n                )}`\n              : `/pages/property_detail/property_detail`;\n            uni.setClipboardData({\n              data: `${title}\\n${link}`,\n              success: () =>\n                uni.showToast({ title: \"已复制链接\", icon: \"none\" }),\n            });\n            return;\n          }\n          if (res.tapIndex === 2) {\n            uni.showToast({ title: \"分享功能待接入\", icon: \"none\" });\n          }\n        },\n      });\n    },\n    openMap() {\n      if (this.isPublicView) {\n        uni.showToast({ title: \"公开页不支持跳转地图\", icon: \"none\" });\n        return;\n      }\n      const lat = Number(this.property && this.property.latitude);\n      const lng = Number(this.property && this.property.longitude);\n      const name = String(\n        (this.property &&\n          (this.property.community_name || this.property.title)) ||\n          \"房源\",\n      ).trim();\n      const address = String(\n        (this.property && this.property.address) || \"\",\n      ).trim();\n      if (!lat || !lng || !isFinite(lat) || !isFinite(lng)) {\n        uni.showToast({ title: \"暂无定位信息\", icon: \"none\" });\n        return;\n      }\n      uni.openLocation({\n        latitude: lat,\n        longitude: lng,\n        name,\n        address: address || name,\n        fail: () => {\n          uni.showToast({ title: \"无法打开地图\", icon: \"none\" });\n        },\n      });\n    },\n    async toggleFollow() {\n      if (this.isPublicView) return;\n      if (!this.propertyId) return;\n      let res;\n      try {\n        res = await propertyApi.toggleFollow({ id: this.propertyId });\n      } catch (e) {\n        if (!uni.getStorageSync(\"token\")) {\n          uni.reLaunch({ url: \"/pages/login/login\" });\n        }\n        return;\n      }\n      if (!res || res.code !== 0) return;\n      const data = res.data || {};\n      this.isFollowed = !!data.is_followed;\n      if (this.property) {\n        this.property.follow_count = data.follow_count;\n      }\n      uni.showToast({\n        title: this.isFollowed ? \"已关注\" : \"已取消关注\",\n        icon: \"none\",\n      });\n    },\n    callOwner() {\n      if (this.isPublicView) return;\n      if (!this.ownerPhone) {\n        uni.showToast({ title: \"暂无业主电话\", icon: \"none\" });\n        return;\n      }\n      uni.makePhoneCall({\n        phoneNumber: this.ownerPhone,\n      });\n    },\n    openLock() {\n      if (this.isPublicView) return;\n      const ss = String(\n        (this.property && this.property.sale_status) || \"\",\n      ).trim();\n      if (ss === \"sold\" || ss === \"off_market\") {\n        const label =\n          this.property && this.property.sale_status_label\n            ? this.property.sale_status_label\n            : \"不可操作\";\n        uni.showToast({ title: `房源${label}，暂不可开锁`, icon: \"none\" });\n        return;\n      }\n      if (!this.hasSmartLock) {\n        uni.showToast({ title: \"该房源未绑定智能锁，无法开锁\", icon: \"none\" });\n        return;\n      }\n      // 进入开锁流程页（页面内可选择蓝牙开锁 / 获取密码开锁）\n      uni.navigateTo({\n        url: `/pages/unlock_steps/unlock_steps?property_id=${encodeURIComponent(\n          this.propertyId,\n        )}`,\n      });\n    },\n    setRenovationStatus(key) {\n      // 展示用：不允许手动切换，避免与真实数据不一致\n      void key;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.detail-container {\n  height: 100vh;\n  background-color: #f6f7f8;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n}\n\n.float-header {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 100;\n  display: flex;\n  justify-content: space-between;\n  padding: 0 32rpx;\n  pointer-events: none;\n  padding-bottom: 8rpx;\n  box-sizing: border-box;\n\n  /* 背景遮罩：不挡点击 */\n  .fh-mask {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    pointer-events: none;\n    transition: opacity 0.18s ease;\n  }\n\n  /* 顶部：暗色渐变，保证返回键在封面图上更清晰 */\n  .fh-mask--dark {\n    background: linear-gradient(\n      to bottom,\n      rgba(15, 23, 42, 0.45) 0%,\n      rgba(15, 23, 42, 0.18) 55%,\n      rgba(15, 23, 42, 0) 100%\n    );\n  }\n\n  /* 下滑后：磨砂白底（更接近普通页面导航栏） */\n  .fh-mask--light {\n    background: rgba(255, 255, 255, 0.92);\n    backdrop-filter: blur(12px);\n    -webkit-backdrop-filter: blur(12px);\n    border-bottom: 1rpx solid rgba(226, 232, 240, 0.9);\n    box-shadow: 0 6rpx 18rpx rgba(15, 23, 42, 0.04);\n  }\n\n  .header-left {\n    display: flex;\n    gap: 24rpx;\n    pointer-events: auto;\n    position: relative;\n    z-index: 2;\n  }\n\n  .circle-btn {\n    width: 80rpx;\n    height: 80rpx;\n    background-color: rgba(0, 0, 0, 0.2);\n    backdrop-filter: blur(10px);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: #ffffff;\n\n    .material-symbols-outlined {\n      font-size: 40rpx;\n    }\n\n    &:active {\n      background-color: rgba(0, 0, 0, 0.4);\n    }\n\n    /* 下滑后：切到浅色按钮，避免白底上显得“脏/灰” */\n    &.is-solid {\n      background-color: rgba(15, 23, 42, 0.06);\n      color: #0f172a;\n    }\n    &.is-solid:active {\n      background-color: rgba(15, 23, 42, 0.12);\n    }\n  }\n}\n\n.detail-scroll {\n  flex: 1;\n  overflow: hidden;\n}\n\n.banner {\n  width: 100%;\n  height: 640rpx;\n  position: relative;\n\n  .swiper {\n    width: 100%;\n    height: 100%;\n  }\n\n  .banner-image {\n    width: 100%;\n    height: 100%;\n  }\n\n  .banner-video {\n    width: 100%;\n    height: 100%;\n  }\n\n  .banner-actions {\n    position: absolute;\n    bottom: 64rpx;\n    left: 32rpx;\n    z-index: 3;\n  }\n\n  .dl-pill {\n    display: flex;\n    align-items: center;\n    gap: 10rpx;\n    padding: 12rpx 18rpx;\n    border-radius: 999rpx;\n    background: rgba(255, 255, 255, 0.88);\n    backdrop-filter: blur(10rpx);\n    border: 1px solid rgba(15, 23, 42, 0.08);\n    box-shadow: 0 10rpx 24rpx rgba(15, 23, 42, 0.18);\n  }\n\n  .dl-icon {\n    font-size: 34rpx;\n    color: #0f766e;\n  }\n\n  .dl-text {\n    font-size: 24rpx;\n    font-weight: 700;\n    color: #0f172a;\n  }\n\n  .banner-indicator {\n    position: absolute;\n    bottom: 64rpx;\n    right: 32rpx;\n    background-color: rgba(0, 0, 0, 0.6);\n    backdrop-filter: blur(4rpx);\n    color: #ffffff;\n    font-size: 24rpx;\n    font-weight: 600;\n    padding: 4rpx 24rpx;\n    border-radius: 40rpx;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n  }\n}\n\n.content-card {\n  background-color: #ffffff;\n  border-radius: 48rpx 48rpx 0 0;\n  margin-top: -48rpx;\n  position: relative;\n  z-index: 10;\n  padding: 48rpx 40rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 48rpx;\n  box-shadow: 0 -4rpx 20rpx rgba(0, 0, 0, 0.05);\n}\n\n.title-section {\n  display: flex;\n  flex-direction: column;\n  gap: 24rpx;\n\n  .title-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    gap: 16rpx;\n\n    .title {\n      font-size: 40rpx;\n      font-weight: bold;\n      color: #0f172a;\n      line-height: 1.3;\n      flex: 1;\n    }\n\n    .action-col {\n      display: flex;\n      flex-direction: column;\n      align-items: flex-end;\n      gap: 12rpx;\n      flex-shrink: 0;\n    }\n\n    .share-btn {\n      display: flex;\n      align-items: center;\n      gap: 8rpx;\n      padding: 12rpx 16rpx;\n      background: rgba(37, 99, 235, 0.08);\n      border: 1rpx solid rgba(37, 99, 235, 0.14);\n      border-radius: 18rpx;\n      font-size: 24rpx;\n      color: #2563eb;\n      font-weight: 700;\n      flex-shrink: 0;\n\n      .share-icon {\n        font-size: 28rpx;\n      }\n\n      &:active {\n        transform: scale(0.98);\n        background: rgba(37, 99, 235, 0.12);\n      }\n    }\n\n    .edit-btn {\n      display: flex;\n      align-items: center;\n      gap: 8rpx;\n      padding: 12rpx 16rpx;\n      background: rgba(15, 23, 42, 0.06);\n      border: 1rpx solid rgba(15, 23, 42, 0.1);\n      border-radius: 18rpx;\n      font-size: 24rpx;\n      color: #0f172a;\n      font-weight: 700;\n      flex-shrink: 0;\n\n      .edit-icon {\n        font-size: 28rpx;\n      }\n\n      &:active {\n        transform: scale(0.98);\n        background: rgba(15, 23, 42, 0.1);\n      }\n    }\n  }\n\n  .tags-row {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 16rpx;\n\n    .tag {\n      padding: 8rpx 16rpx;\n      background-color: #f1f5f9;\n      color: #475569;\n      font-size: 22rpx;\n      font-weight: 500;\n      border-radius: 8rpx;\n\n      &.orange {\n        background-color: #fff7ed;\n        color: #f97316;\n      }\n    }\n  }\n\n  .status-row {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 12rpx;\n    align-items: center;\n  }\n\n  .status-chip {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n    padding: 8rpx 14rpx;\n    border-radius: 999rpx;\n    font-size: 22rpx;\n    font-weight: 700;\n    background: rgba(15, 23, 42, 0.06);\n    border: 1rpx solid rgba(15, 23, 42, 0.1);\n    color: #0f172a;\n\n    .status-ic {\n      font-size: 26rpx;\n    }\n\n    &.on_sale {\n      background: rgba(34, 197, 94, 0.12);\n      border-color: rgba(34, 197, 94, 0.18);\n      color: #16a34a;\n    }\n    &.sold {\n      background: rgba(234, 88, 12, 0.12);\n      border-color: rgba(234, 88, 12, 0.18);\n      color: #ea580c;\n    }\n    &.off_market {\n      background: rgba(148, 163, 184, 0.18);\n      border-color: rgba(148, 163, 184, 0.22);\n      color: #64748b;\n    }\n\n    &.hot {\n      background: rgba(37, 99, 235, 0.1);\n      border-color: rgba(37, 99, 235, 0.16);\n      color: #2563eb;\n    }\n  }\n}\n\n.contact-card {\n  border-radius: 24rpx;\n  background: linear-gradient(\n    135deg,\n    rgba(15, 23, 42, 0.02),\n    rgba(37, 99, 235, 0.03)\n  );\n  border: 1rpx solid rgba(226, 232, 240, 0.9);\n  padding: 18rpx 18rpx 8rpx;\n}\n\n.contact-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 14rpx;\n}\n\n.contact-item {\n  background-color: #ffffff;\n  border-radius: 18rpx;\n  border: 1rpx solid rgba(226, 232, 240, 0.9);\n  padding: 14rpx 14rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 6rpx;\n  min-width: 0;\n}\n\n.contact-item.wide {\n  grid-column: span 2;\n}\n\n.contact-label {\n  font-size: 22rpx;\n  color: #64748b;\n  font-weight: 600;\n}\n\n.contact-value {\n  font-size: 26rpx;\n  color: #0f172a;\n  font-weight: 800;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.contact-value.price {\n  color: #ea580c;\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  padding: 26rpx 0;\n  border-top: 1rpx solid rgba(226, 232, 240, 0.9);\n  border-bottom: 1rpx solid rgba(226, 232, 240, 0.9);\n\n  .stats-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 6rpx;\n    padding: 0 18rpx;\n\n    &.border-l {\n      border-left: 1rpx solid rgba(226, 232, 240, 0.9);\n    }\n\n    .stats-val {\n      font-size: 40rpx;\n      font-weight: 800;\n      color: #0f172a;\n      display: inline-flex;\n      align-items: baseline;\n      justify-content: center;\n      line-height: 1;\n      white-space: nowrap;\n      max-width: 100%;\n\n      &.orange {\n        color: #f97316;\n      }\n      /* 非价格类字段更容易换行，略缩小字号保证一行展示 */\n      &:not(.orange) {\n        font-size: 34rpx;\n      }\n\n      .unit {\n        font-size: 22rpx;\n        font-weight: 700;\n        margin-left: 4rpx;\n        opacity: 0.9;\n      }\n    }\n\n    .stats-label {\n      font-size: 22rpx;\n      color: #64748b;\n      font-weight: 700;\n      letter-spacing: 0.4rpx;\n    }\n  }\n}\n\n.commission-banner {\n  background: linear-gradient(to right, #f97316, #ea580c);\n  border-radius: 24rpx;\n  padding: 32rpx;\n  position: relative;\n  overflow: hidden;\n  box-shadow: 0 10rpx 20rpx rgba(249, 115, 22, 0.2);\n\n  .banner-bg-decor {\n    position: absolute;\n    right: -48rpx;\n    top: -48rpx;\n    width: 192rpx;\n    height: 192rpx;\n    background-color: rgba(255, 255, 255, 0.1);\n    border-radius: 50%;\n    filter: blur(40rpx);\n  }\n\n  .banner-main {\n    display: flex;\n    align-items: center;\n    gap: 24rpx;\n    position: relative;\n    z-index: 10;\n\n    .icon-box {\n      width: 80rpx;\n      height: 80rpx;\n      background-color: rgba(255, 255, 255, 0.2);\n      backdrop-filter: blur(10rpx);\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: #ffffff;\n\n      .material-symbols-outlined {\n        font-size: 48rpx;\n      }\n    }\n\n    .banner-info {\n      display: flex;\n      flex-direction: column;\n      gap: 4rpx;\n\n      .banner-title {\n        font-size: 32rpx;\n        font-weight: bold;\n        color: #ffffff;\n      }\n\n      .banner-tip {\n        font-size: 22rpx;\n        color: rgba(255, 255, 255, 0.8);\n      }\n    }\n  }\n}\n\n.data-row {\n  background: rgba(255, 255, 255, 0.92);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  border: 1rpx solid rgba(226, 232, 240, 0.9);\n  border-radius: 24rpx;\n  box-shadow: 0 10rpx 24rpx rgba(15, 23, 42, 0.06);\n  padding: 20rpx 16rpx;\n  display: flex;\n  align-items: stretch;\n\n  .data-group {\n    flex: 1;\n    display: flex;\n    align-items: stretch;\n  }\n\n  .data-item {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 6rpx;\n    padding: 6rpx 0;\n    position: relative;\n\n    &:not(:last-child)::after {\n      content: \"\";\n      position: absolute;\n      right: 0;\n      top: 10rpx;\n      bottom: 10rpx;\n      width: 1rpx;\n      background-color: rgba(226, 232, 240, 0.9);\n    }\n\n    .val {\n      font-size: 40rpx;\n      font-weight: 800;\n      color: #0f172a;\n      letter-spacing: 0.5rpx;\n    }\n\n    .lab {\n      font-size: 22rpx;\n      color: #64748b;\n      font-weight: 600;\n    }\n  }\n}\n\n.section {\n  display: flex;\n  flex-direction: column;\n  gap: 24rpx;\n\n  &.no-pb {\n    padding-bottom: 0;\n  }\n\n  .section-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n\n  .section-title {\n    font-size: 36rpx;\n    font-weight: bold;\n    color: #0f172a;\n  }\n\n  .header-more {\n    display: flex;\n    align-items: center;\n    gap: 4rpx;\n    font-size: 24rpx;\n    color: #2d9cf0;\n    font-weight: 500;\n\n    .more-icon {\n      font-size: 28rpx;\n    }\n  }\n}\n\n.attr-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 24rpx;\n  background-color: #f8fafc;\n  padding: 32rpx;\n  border-radius: 24rpx;\n\n  .attr-item {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-size: 28rpx;\n\n    .attr-label {\n      color: #64748b;\n    }\n    .attr-val {\n      color: #0f172a;\n      font-weight: 500;\n    }\n  }\n}\n\n/* 装修状态 */\n.reno-tabs {\n  display: flex;\n  gap: 12rpx;\n  background-color: #f1f5f9;\n  padding: 6rpx;\n  border-radius: 18rpx;\n}\n\n.reno-tab {\n  padding: 10rpx 16rpx;\n  border-radius: 14rpx;\n  font-size: 22rpx;\n  color: #64748b;\n  font-weight: 700;\n  background-color: transparent;\n\n  &.active {\n    background-color: #ffffff;\n    color: #0f172a;\n    box-shadow: 0 6rpx 14rpx rgba(15, 23, 42, 0.06);\n  }\n}\n\n.reno-card {\n  background-color: #f8fafc;\n  border-radius: 24rpx;\n  padding: 24rpx;\n  border: 1px solid #f1f5f9;\n}\n\n.reno-top {\n  display: flex;\n  align-items: center;\n  gap: 12rpx;\n  margin-bottom: 16rpx;\n}\n\n.reno-badge {\n  padding: 6rpx 14rpx;\n  border-radius: 999rpx;\n  font-size: 22rpx;\n  font-weight: 800;\n  letter-spacing: 0.4rpx;\n\n  &.none {\n    background: rgba(148, 163, 184, 0.18);\n    color: #475569;\n  }\n  &.in_progress {\n    background: rgba(245, 158, 11, 0.18);\n    color: #b45309;\n  }\n  &.done {\n    background: rgba(34, 197, 94, 0.16);\n    color: #15803d;\n  }\n}\n\n.reno-sub {\n  font-size: 24rpx;\n  color: #64748b;\n  font-weight: 600;\n}\n\n.reno-empty {\n  display: flex;\n  align-items: flex-start;\n  gap: 16rpx;\n  padding: 8rpx 4rpx 4rpx;\n}\n\n.reno-empty-icon {\n  font-size: 44rpx;\n  color: #94a3b8;\n}\n\n.reno-empty-texts {\n  display: flex;\n  flex-direction: column;\n  gap: 6rpx;\n}\n\n.reno-empty-title {\n  font-size: 28rpx;\n  font-weight: 800;\n  color: #0f172a;\n}\n\n.reno-empty-desc {\n  font-size: 24rpx;\n  color: #64748b;\n  line-height: 1.5;\n}\n\n.reno-swiper {\n  width: 100%;\n  height: 260rpx;\n  border-radius: 20rpx;\n  overflow: hidden;\n}\n\n.reno-image {\n  width: 100%;\n  height: 100%;\n}\n\n.reno-progress {\n  margin-top: 14rpx;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 16rpx;\n}\n\n.reno-progress-bar {\n  flex: 1;\n  height: 16rpx;\n  border-radius: 999rpx;\n  background-color: rgba(226, 232, 240, 0.9);\n  overflow: hidden;\n}\n\n.reno-progress-fill {\n  height: 100%;\n  border-radius: 999rpx;\n  background: linear-gradient(90deg, #60a5fa, #2563eb);\n}\n\n.reno-progress-text {\n  font-size: 22rpx;\n  color: #334155;\n  font-weight: 700;\n  white-space: nowrap;\n}\n\n.reno-info {\n  margin-top: 16rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 12rpx;\n}\n\n.reno-info-row {\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 16rpx;\n\n  &.col {\n    flex-direction: column;\n  }\n\n  .k {\n    font-size: 24rpx;\n    color: #64748b;\n    font-weight: 700;\n    flex-shrink: 0;\n  }\n\n  .v {\n    font-size: 24rpx;\n    color: #0f172a;\n    font-weight: 600;\n    text-align: right;\n    flex: 1;\n\n    &.desc {\n      text-align: left;\n      color: #334155;\n      font-weight: 500;\n      line-height: 1.55;\n    }\n  }\n}\n\n.chips {\n  flex: 1;\n  display: flex;\n  justify-content: flex-end;\n  flex-wrap: wrap;\n  gap: 10rpx;\n}\n\n.chip {\n  padding: 6rpx 12rpx;\n  border-radius: 999rpx;\n  background-color: rgba(37, 99, 235, 0.08);\n  border: 1rpx solid rgba(37, 99, 235, 0.12);\n  color: #2563eb;\n  font-size: 22rpx;\n  font-weight: 700;\n}\n\n.info-list {\n  display: flex;\n  flex-direction: column;\n  padding: 32rpx;\n  border-radius: 24rpx;\n  border: 1px solid #f1f5f9;\n\n  .info-item {\n    display: flex;\n    gap: 24rpx;\n    align-items: flex-start;\n\n    .info-icon {\n      font-size: 36rpx;\n      color: #94a3b8;\n      margin-top: 4rpx;\n\n      &.primary {\n        color: #2d9cf0;\n      }\n    }\n\n    .info-content {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      gap: 8rpx;\n    }\n\n    .info-title-row {\n      display: flex;\n      align-items: center;\n      gap: 16rpx;\n    }\n\n    .info-title {\n      font-size: 28rpx;\n      font-weight: 500;\n      color: #0f172a;\n    }\n\n    .info-tag {\n      padding: 4rpx 12rpx;\n      background-color: #eff6ff;\n      color: #2d9cf0;\n      font-size: 20rpx;\n      font-weight: bold;\n      border-radius: 4rpx;\n    }\n\n    .info-desc {\n      font-size: 24rpx;\n      color: #64748b;\n    }\n  }\n\n  .info-divider {\n    height: 1px;\n    background-color: #f1f5f9;\n    margin: 32rpx 0;\n  }\n}\n\n.map-box {\n  width: 100%;\n  height: 288rpx;\n  border-radius: 24rpx;\n  overflow: hidden;\n  position: relative;\n\n  .map-native {\n    width: 100%;\n    height: 100%;\n  }\n\n  .map-image {\n    width: 100%;\n    height: 100%;\n    opacity: 0.8;\n  }\n  .map-image-empty {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: linear-gradient(135deg, #eef2f7, #e2e8f0);\n    .material-symbols-outlined {\n      font-size: 64rpx;\n      color: #94a3b8;\n    }\n  }\n\n  .map-mask {\n    position: absolute;\n    inset: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: rgba(0, 0, 0, 0.05);\n\n    .map-pin {\n      display: flex;\n      align-items: center;\n      gap: 12rpx;\n      background-color: rgba(255, 255, 255, 0.95);\n      backdrop-filter: blur(10px);\n      padding: 12rpx 24rpx;\n      border-radius: 16rpx;\n      box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\n      font-size: 24rpx;\n      font-weight: bold;\n      color: #0f172a;\n\n      .pin-icon {\n        color: #2d9cf0;\n        font-size: 28rpx;\n      }\n    }\n\n    .map-coords {\n      position: absolute;\n      bottom: 16rpx;\n      right: 16rpx;\n      padding: 8rpx 14rpx;\n      border-radius: 999rpx;\n      background-color: rgba(255, 255, 255, 0.92);\n      backdrop-filter: blur(10px);\n      border: 1px solid rgba(15, 23, 42, 0.08);\n      box-shadow: 0 10rpx 24rpx rgba(15, 23, 42, 0.14);\n      .coord-text {\n        font-size: 20rpx;\n        color: #0f172a;\n        font-weight: 600;\n      }\n    }\n  }\n}\n\n.recommend-scroll {\n  width: 100%;\n  white-space: nowrap;\n  // 左侧保持与内容区对齐（40rpx），右侧拉满到屏幕边缘\n  margin-left: -40rpx;\n  margin-right: -40rpx;\n  padding-left: 40rpx;\n  padding-right: 0;\n  box-sizing: border-box;\n\n  .recommend-row {\n    display: inline-flex;\n    gap: 24rpx;\n    padding-bottom: 8rpx;\n  }\n\n  .recommend-card {\n    width: 320rpx;\n    display: flex;\n    flex-direction: column;\n    gap: 16rpx;\n\n    .rec-img-box {\n      width: 100%;\n      height: 192rpx;\n      border-radius: 16rpx;\n      overflow: hidden;\n      position: relative;\n      background-color: #f1f5f9;\n\n      .rec-image {\n        width: 100%;\n        height: 100%;\n      }\n      .rec-image-empty {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        background: linear-gradient(135deg, #eef2f7, #e2e8f0);\n        .material-symbols-outlined {\n          font-size: 52rpx;\n          color: #94a3b8;\n        }\n      }\n      .rec-tag {\n        position: absolute;\n        bottom: 8rpx;\n        left: 8rpx;\n        background-color: rgba(0, 0, 0, 0.5);\n        backdrop-filter: blur(4rpx);\n        color: #ffffff;\n        font-size: 20rpx;\n        padding: 4rpx 12rpx;\n        border-radius: 8rpx;\n      }\n    }\n\n    .rec-info {\n      display: flex;\n      flex-direction: column;\n      gap: 4rpx;\n\n      .rec-title {\n        font-size: 28rpx;\n        font-weight: 500;\n        color: #0f172a;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      .rec-meta {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n\n        .rec-desc {\n          font-size: 24rpx;\n          color: #94a3b8;\n        }\n        .rec-price {\n          font-size: 24rpx;\n          font-weight: bold;\n          color: #f97316;\n        }\n      }\n    }\n  }\n}\n\n.bottom-bar {\n  background-color: #ffffff;\n  border-top: 1rpx solid #f1f5f9;\n  padding: 16rpx 32rpx calc(env(safe-area-inset-bottom) + 16rpx);\n  box-shadow: 0 -10rpx 30rpx rgba(0, 0, 0, 0.05);\n\n  .bar-content {\n    display: flex;\n    align-items: center;\n    gap: 20rpx;\n    max-width: 960rpx;\n    margin: 0 auto;\n  }\n\n  .action-btns {\n    display: flex;\n    gap: 40rpx;\n    padding: 0 8rpx;\n  }\n\n  .action-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 4rpx;\n    color: #64748b;\n    min-width: 80rpx;\n\n    .bar-icon {\n      font-size: 44rpx;\n    }\n    .bar-text {\n      font-size: 20rpx;\n      font-weight: 500;\n      white-space: nowrap;\n    }\n\n    .filled {\n      font-variation-settings: \"FILL\" 1;\n    }\n\n    &:active {\n      color: #0f172a;\n    }\n  }\n\n  .bar-divider {\n    width: 1px;\n    height: 64rpx;\n    background-color: #f1f5f9;\n    margin: 0 8rpx;\n  }\n\n  .unlock-btn {\n    flex: 1;\n    height: 88rpx;\n    background-color: #2d9cf0;\n    color: #ffffff;\n    font-size: 30rpx;\n    font-weight: bold;\n    border-radius: 16rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 12rpx;\n    box-shadow: 0 8rpx 20rpx rgba(45, 156, 240, 0.3);\n    border: none;\n\n    &::after {\n      border: none;\n    }\n\n    .unlock-icon {\n      font-size: 36rpx;\n      font-variation-settings: \"FILL\" 1;\n    }\n\n    &:active {\n      background-color: #1d82cc;\n      transform: scale(0.98);\n    }\n  }\n}\n\n.bottom-spacer {\n  height: 64rpx;\n}\n</style>\n","import MiniProgramPage from 'E:/Work/Progect/GoFly-admin/main-admin/web/wxapp/pages/property_detail/property_detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["_sfc_main","data","isPublicView","publicFromAgentId","publicFromStyle","currentUserId","statusBarHeight","headerPadLeftPx","headerPadRightPx","headerOpacity","currentSwiper","isFollowed","hasSmartLock","images","bannerItems","videoPoster","mapLat","mapLng","label","value","renovationTabs","key","status","eta","finishAt","materials","name","size","image","onLoad","options","info","uni","getSystemInfoSync","this","wx","wx$1","getMenuButtonBoundingClientRect","w","Number","windowWidth","rpx2px","padLeftPx","rightSafePx","top","rect","height","circleBtnSizePx","Math","round","headerTop","e","publicRaw","String","trim","toLowerCase","from_agent_id","agent_id","id","ID","property_id","propertyId","loadDetail","index$1","showToast","title","icon","computed","canEditThisProperty","canManageProperties","uid","agentId","showDownloadBtn","item","getCurrentBannerItem","downloadLabel","type","methods","ensureCanManageProperties","getStorageSync","userStore","isLogin","ui","userInfo","u","__f__","can_manage_properties","goEdit","navigateTo","url","debugEditState","can","show","showModal","content","showCancel","t","getLayoutText","p","rooms","halls","bathrooms","s","getUnitPriceText","totalYuan","price","price_unit","per","isFinite","buildAttributes","totalFloors","total_floors","orientation","year","build_year","property_type","getCommissionText","hasReward","reward","addr","property","address","normalizeImage","imageUrl","loading","res","propertyApi","getDetail","reLaunch","setTimeout","public_view","navigateBack","is_followed","ownerPhone","videoUrl","video_url","Array","isArray","map","filter","Boolean","forEach","items","push","src","lat","lng","mapMarkers","latitude","longitude","width","attributes","statusRaw","renovation","progress","r","progress_percentage","stage","current_stage","note","notes","recommends","rec","it","area","onPageScroll","next","min","st","max","toFixed","goBack","aid","style","encodeURIComponent","publicQuery","redirectTo","swiperChange","detail","current","Promise","resolve","reject","getSetting","success","authorize","scope","fail","confirmText","openSetting","ensureAlbumPermission","showLoading","downloadFile","fp","hideLoading","complete","showActionSheet","itemList","tapIndex","setClipboardData","openMap","openLocation","toggleFollow","follow_count","makePhoneCall","ss","sale_status_label","createPage","MiniProgramPage"],"mappings":"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"}