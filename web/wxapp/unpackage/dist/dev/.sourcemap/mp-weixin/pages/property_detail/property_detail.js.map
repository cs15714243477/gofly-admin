{"version":3,"file":"property_detail.js","sources":["pages/property_detail/property_detail.vue","D:/WinApp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvcGVydHlfZGV0YWlsL3Byb3BlcnR5X2RldGFpbC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"detail-container\">\n    <!-- 顶部悬浮操作 -->\n    <view\n      class=\"float-header\"\n      :style=\"{\n        paddingTop: headerTop + 'px',\n        paddingLeft: headerPadLeftPx ? headerPadLeftPx + 'px' : undefined,\n        paddingRight: headerPadRightPx ? headerPadRightPx + 'px' : undefined,\n      }\"\n    >\n      <!-- 安全遮罩：顶部时用暗色渐变保证可读性；下滑后过渡到磨砂白底 -->\r\n      <view\r\n        class=\"fh-mask fh-mask--dark\"\r\n        :style=\"{ opacity: 1 - headerOpacity }\"\r\n      ></view>\r\n      <view\r\n        class=\"fh-mask fh-mask--light\"\r\n        :style=\"{ opacity: headerOpacity }\"\r\n      ></view>\r\n      <view class=\"header-left\">\n        <view\n          class=\"circle-btn\"\n          :class=\"{ 'is-solid': headerOpacity > 0.65 }\"\n          @click=\"goBack\"\n        >\n          <text class=\"material-symbols-outlined\">arrow_back</text>\n        </view>\n      </view>\n    </view>\n\r\n    <scroll-view scroll-y=\"true\" class=\"detail-scroll\" @scroll=\"onPageScroll\">\r\n      <!-- 轮播图 -->\r\n      <view class=\"banner\">\r\n        <swiper\r\n          class=\"swiper\"\r\n          circular\r\n          :indicator-dots=\"false\"\r\n          @change=\"swiperChange\"\r\n        >\r\n          <swiper-item v-for=\"(item, index) in bannerItems\" :key=\"index\">\r\n            <video\r\n              v-if=\"item.type === 'video'\"\r\n              :src=\"item.src\"\r\n              :poster=\"videoPoster\"\r\n              class=\"banner-video\"\r\n              controls\r\n              show-center-play-btn\r\n              object-fit=\"cover\"\r\n              playsinline\r\n              enable-progress-gesture\r\n            ></video>\r\n            <image\r\n              v-else\r\n              :src=\"item.src\"\r\n              mode=\"aspectFill\"\r\n              class=\"banner-image\"\r\n            ></image>\r\n          </swiper-item>\r\n        </swiper>\r\n        <view class=\"banner-actions\" v-if=\"showDownloadBtn\" @click.stop=\"downloadCurrent\">\r\n          <view class=\"dl-pill\">\r\n            <text class=\"material-symbols-outlined dl-icon\">download</text>\r\n            <text class=\"dl-text\">{{ downloadLabel }}</text>\r\n          </view>\r\n        </view>\r\n        <view class=\"banner-indicator\"\r\n          >{{ bannerItems.length ? currentSwiper + 1 : 0 }}/{{ bannerItems.length }}</view\r\n        >\r\n      </view>\r\n\r\n      <!-- 内容卡片 -->\r\n      <view class=\"content-card\">\n        <view class=\"title-section\">\n          <view class=\"title-row\">\n            <text class=\"title\">{{ (property && property.title) || \"-\" }}</text>\n            <view class=\"action-col\">\n            <view class=\"share-btn\" @click=\"handleShare\" @longpress=\"debugEditState\">\n              <text class=\"material-symbols-outlined share-icon\">share</text>\n              <text>分享</text>\n            </view>\n              <view class=\"edit-btn\" v-if=\"canEditThisProperty\" @click=\"goEdit\">\n                <text class=\"material-symbols-outlined edit-icon\">edit</text>\n                <text>编辑</text>\n              </view>\n            </view>\n          </view>\n          <view class=\"tags-row\">\n            <text\n              v-for=\"(t, idx) in ((property && property.tags) || []).slice(\n                0,\n                6\n              )\"\n              :key=\"idx\"\n              class=\"tag\"\n              :class=\"tagClass(t)\"\n            >\n              {{ t }}\n            </text>\n          </view>\n          <view class=\"status-row\" v-if=\"canEditThisProperty\">\n            <view class=\"status-chip\" :class=\"(property && property.sale_status) || ''\">\n              <text class=\"material-symbols-outlined status-ic\">sell</text>\n              <text>{{ (property && property.sale_status_label) || \"状态\" }}</text>\n            </view>\n            <view v-if=\"Number(property && property.hot_status) === 1\" class=\"status-chip hot\">\n              <text class=\"material-symbols-outlined status-ic\">local_fire_department</text>\n              <text>推荐</text>\n            </view>\n          </view>\n        </view>\n\r\n        <!-- 核心数据展示 -->\r\n        <view class=\"stats-grid\">\r\n          <view class=\"stats-item\">\r\n            <view class=\"stats-val orange\">\r\n              {{ (property && property.price) || \"-\"\r\n              }}<text class=\"unit\">{{\r\n                (property && property.price_unit) || \"\"\r\n              }}</text>\r\n            </view>\r\n            <view class=\"stats-label\">售价</view>\r\n          </view>\r\n          <view class=\"stats-item border-l\">\r\n            <view class=\"stats-val\">{{ getLayoutText(property) }}</view>\r\n            <view class=\"stats-label\">户型</view>\r\n          </view>\r\n          <view class=\"stats-item border-l\">\r\n            <view class=\"stats-val\">\r\n              {{ (property && property.area) || \"-\"\r\n              }}<text class=\"unit\">㎡</text>\r\n            </view>\r\n            <view class=\"stats-label\">面积</view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 佣金横幅 -->\r\n        <view class=\"commission-banner\">\r\n          <view class=\"banner-bg-decor\"></view>\r\n          <view class=\"banner-main\">\r\n            <view class=\"icon-box\">\r\n              <text class=\"material-symbols-outlined\">currency_yen</text>\r\n            </view>\r\n            <view class=\"banner-info\">\r\n              <text class=\"banner-title\">{{\r\n                getCommissionText(property)\r\n              }}</text>\r\n              <text class=\"banner-tip\">签约后7个工作日内结算</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 浏览数据 -->\r\n        <view class=\"data-row\">\r\n          <view class=\"data-group\">\r\n            <view class=\"data-item\">\r\n              <text class=\"val\">{{\r\n                (property && property.view_count) || 0\r\n              }}</text>\r\n              <text class=\"lab\">浏览</text>\r\n            </view>\r\n            <view class=\"data-item\">\r\n              <text class=\"val\">{{\r\n                (property && property.follow_count) || 0\r\n              }}</text>\r\n              <text class=\"lab\">关注人数</text>\r\n            </view>\r\n            <view class=\"data-item\">\r\n              <text class=\"val\">{{\r\n                (property && property.showing_count) || 0\r\n              }}</text>\r\n              <text class=\"lab\">带看次数</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 属性表 -->\r\n        <view class=\"section\">\n          <view class=\"section-title\">房源信息</view>\n          <view class=\"attr-grid\">\n            <view\n              class=\"attr-item\"\r\n              v-for=\"(attr, idx) in attributes\"\r\n              :key=\"idx\"\r\n            >\r\n              <text class=\"attr-label\">{{ attr.label }}</text>\r\n              <text class=\"attr-val\">{{ attr.value }}</text>\r\n            </view>\r\n          </view>\n        </view>\n\n        <!-- 房主与收房（与后台表单字段一致） -->\n        <view class=\"section\" v-if=\"canEditThisProperty\">\n          <view class=\"section-title\">房主与收房</view>\n          <view class=\"contact-card\">\n            <view class=\"contact-grid\">\n              <view class=\"contact-item\">\n                <text class=\"contact-label\">业主姓名</text>\n                <text class=\"contact-value\">{{\n                  (property && property.owner_name) || \"-\"\n                }}</text>\n              </view>\n              <view class=\"contact-item\">\n                <text class=\"contact-label\">业主电话</text>\n                <text class=\"contact-value\">{{\n                  (property && property.owner_phone) || \"-\"\n                }}</text>\n              </view>\n              <view class=\"contact-item\">\n                <text class=\"contact-label\">收房人姓名</text>\n                <text class=\"contact-value\">{{\n                  (property && property.receiver_name) || \"-\"\n                }}</text>\n              </view>\n              <view class=\"contact-item\">\n                <text class=\"contact-label\">收房人电话</text>\n                <text class=\"contact-value\">{{\n                  (property && property.receiver_phone) || \"-\"\n                }}</text>\n              </view>\n              <view class=\"contact-item wide\">\n                <text class=\"contact-label\">收房价格（支付业主）</text>\n                <text class=\"contact-value price\">{{\n                  (property && property.receiver_price) ? (\"¥\" + property.receiver_price) : \"-\"\n                }}</text>\n              </view>\n            </view>\n          </view>\n        </view>\n\r\n        <!-- 装修状态 -->\r\n        <view class=\"section\">\r\n          <view class=\"section-header\">\r\n            <text class=\"section-title\">装修状态</text>\r\n            <view class=\"reno-tabs\">\r\n              <view\r\n                class=\"reno-tab\"\r\n                v-for=\"t in renovationTabs\"\r\n                :key=\"t.key\"\r\n                :class=\"{ active: renovation.status === t.key }\"\r\n                @click=\"setRenovationStatus(t.key)\"\r\n              >\r\n                {{ t.label }}\r\n              </view>\r\n            </view>\r\n          </view>\r\n\r\n          <view class=\"reno-card\">\r\n            <view class=\"reno-top\">\r\n              <view class=\"reno-badge\" :class=\"renovation.status\">\r\n                {{\r\n                  renovation.status === \"none\"\r\n                    ? \"未装修\"\r\n                    : renovation.status === \"in_progress\"\r\n                    ? \"装修进行中\"\r\n                    : \"装修完成\"\r\n                }}\r\n              </view>\r\n              <text class=\"reno-sub\">{{ renovation.subtitle }}</text>\r\n            </view>\r\n\r\n            <!-- 未装修 -->\r\n            <view v-if=\"renovation.status === 'none'\" class=\"reno-empty\">\r\n              <text class=\"material-symbols-outlined reno-empty-icon\"\r\n                >home_repair_service</text\r\n              >\r\n              <view class=\"reno-empty-texts\">\r\n                <text class=\"reno-empty-title\">当前房源未进行装修</text>\r\n                <text class=\"reno-empty-desc\"\r\n                  >适合按个人喜好自由设计，交付为毛坯/简装（示例）。</text\r\n                >\r\n              </view>\r\n            </view>\r\n\r\n            <!-- 装修进行中 -->\r\n            <view\r\n              v-else-if=\"renovation.status === 'in_progress'\"\r\n              class=\"reno-progress-wrap\"\r\n            >\r\n              <swiper\r\n                class=\"reno-swiper\"\r\n                circular\r\n                :indicator-dots=\"true\"\r\n                :autoplay=\"true\"\r\n                :interval=\"3500\"\r\n              >\r\n                <swiper-item v-for=\"(img, idx) in renovation.images\" :key=\"idx\">\r\n                  <image\r\n                    :src=\"img\"\r\n                    mode=\"aspectFill\"\r\n                    class=\"reno-image\"\r\n                  ></image>\r\n                </swiper-item>\r\n              </swiper>\r\n\r\n              <view class=\"reno-progress\">\r\n                <view class=\"reno-progress-bar\">\r\n                  <view\r\n                    class=\"reno-progress-fill\"\r\n                    :style=\"{ width: renovation.progress + '%' }\"\r\n                  ></view>\r\n                </view>\r\n                <text class=\"reno-progress-text\"\r\n                  >{{ renovation.progress }}% · {{ renovation.stage }}</text\r\n                >\r\n              </view>\r\n\r\n              <view class=\"reno-info\">\r\n                <view class=\"reno-info-row\">\r\n                  <text class=\"k\">预计完工</text>\r\n                  <text class=\"v\">{{ renovation.eta }}</text>\r\n                </view>\r\n                <view class=\"reno-info-row\">\r\n                  <text class=\"k\">材料</text>\r\n                  <view class=\"chips\">\r\n                    <text\r\n                      class=\"chip\"\r\n                      v-for=\"(m, idx) in renovation.materials\"\r\n                      :key=\"'m-' + idx\"\r\n                      >{{ m }}</text\r\n                    >\r\n                  </view>\r\n                </view>\r\n                <view class=\"reno-info-row col\">\r\n                  <text class=\"k\">施工说明</text>\r\n                  <text class=\"v desc\">{{ renovation.note }}</text>\r\n                </view>\r\n              </view>\r\n            </view>\r\n\r\n            <!-- 装修完成 -->\r\n            <view v-else class=\"reno-done\">\r\n              <view class=\"reno-info\">\r\n                <view class=\"reno-info-row\">\r\n                  <text class=\"k\">完成时间</text>\r\n                  <text class=\"v\">{{ renovation.finishAt }}</text>\r\n                </view>\r\n                <view class=\"reno-info-row\">\r\n                  <text class=\"k\">材料</text>\r\n                  <view class=\"chips\">\r\n                    <text\r\n                      class=\"chip\"\r\n                      v-for=\"(m, idx) in renovation.materials\"\r\n                      :key=\"'dm-' + idx\"\r\n                      >{{ m }}</text\r\n                    >\r\n                  </view>\r\n                </view>\r\n                <view class=\"reno-info-row col\">\r\n                  <text class=\"k\">装修说明</text>\r\n                  <text class=\"v desc\">{{ renovation.note }}</text>\r\n                </view>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 交易信息 -->\r\n        <view class=\"section\">\r\n          <view class=\"section-title\">交易信息</view>\r\n          <view class=\"info-list\">\r\n            <view class=\"info-item\">\r\n              <text class=\"material-symbols-outlined info-icon\">payments</text>\r\n              <view class=\"info-content\">\r\n                <text class=\"info-title\">交易税费</text>\r\n                <text class=\"info-desc\">净得价，税费由买方承担</text>\r\n              </view>\r\n            </view>\r\n            <view class=\"info-divider\"></view>\r\n            <view class=\"info-item\">\r\n              <text class=\"material-symbols-outlined info-icon\">home_work</text>\r\n              <view class=\"info-content\">\r\n                <text class=\"info-title\">房屋现状</text>\r\n                <text class=\"info-desc\">目前空置，业主诚意出售</text>\r\n              </view>\r\n            </view>\r\n            <view class=\"info-divider\"></view>\r\n            <view class=\"info-item\">\r\n              <text class=\"material-symbols-outlined info-icon primary\"\r\n                >lock_open</text\r\n              >\r\n              <view class=\"info-content\">\r\n                <view class=\"info-title-row\">\r\n                  <text class=\"info-title\">看房类型</text>\r\n                  <text class=\"info-tag\">智能开锁</text>\r\n                </view>\r\n                <text class=\"info-desc\">支持APP一键开锁，随时看房</text>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 位置周边 -->\r\n        <view class=\"section\">\r\n          <view class=\"section-header\">\r\n            <text class=\"section-title\">位置周边</text>\r\n            <view class=\"header-more\" @click=\"openMap\">\r\n              <text>查看地图</text>\r\n              <text class=\"material-symbols-outlined more-icon\"\r\n                >chevron_right</text\r\n              >\r\n            </view>\r\n          </view>\r\n      <view class=\"map-box\" @click=\"openMap\">\r\n            <map\r\n              v-if=\"hasLocation\"\r\n              class=\"map-native\"\r\n              :latitude=\"mapLat\"\r\n              :longitude=\"mapLng\"\r\n              :scale=\"16\"\r\n              :markers=\"mapMarkers\"\r\n              :enable-zoom=\"false\"\r\n              :enable-scroll=\"false\"\r\n              :enable-rotate=\"false\"\r\n              :enable-overlooking=\"false\"\r\n              :enable-satellite=\"false\"\r\n              :show-location=\"false\"\r\n              @tap=\"openMap\"\r\n            ></map>\r\n            <image\r\n              v-else\r\n              src=\"/static/images/img_fdb9c430df.png\"\r\n              mode=\"aspectFill\"\r\n              class=\"map-image\"\r\n            ></image>\r\n            <view class=\"map-mask\">\r\n              <view class=\"map-pin\">\r\n                <text class=\"material-symbols-outlined pin-icon\"\r\n                  >location_on</text\r\n                >\r\n                <text>{{ mapPinText() }}</text>\r\n              </view>\r\n              <view class=\"map-coords\" v-if=\"hasLocation\">\r\n                <text class=\"coord-text\">{{ mapLng.toFixed(6) }}, {{ mapLat.toFixed(6) }}</text>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 相似房源 -->\r\n        <view class=\"section no-pb\">\r\n          <view class=\"section-title\">推荐相似房源</view>\r\n          <scroll-view scroll-x=\"true\" class=\"recommend-scroll\">\r\n            <view class=\"recommend-row\">\r\n              <view\r\n                class=\"recommend-card\"\r\n                v-for=\"(rec, rIdx) in recommends\"\r\n                :key=\"rIdx\"\r\n                @click=\"goToRec(rec)\"\r\n              >\r\n                <view class=\"rec-img-box\">\r\n                  <image\r\n                    :src=\"rec.image\"\r\n                    mode=\"aspectFill\"\r\n                    class=\"rec-image\"\r\n                  ></image>\r\n                  <view class=\"rec-tag\">{{ rec.size }}㎡</view>\r\n                </view>\r\n                <view class=\"rec-info\">\r\n                  <view class=\"rec-title\">{{ rec.name }}</view>\r\n                  <view class=\"rec-meta\">\r\n                    <text class=\"rec-desc\">{{ rec.rooms }}</text>\r\n                    <text class=\"rec-price\">{{ rec.price }}</text>\r\n                  </view>\r\n                </view>\r\n              </view>\r\n            </view>\r\n          </scroll-view>\r\n        </view>\r\n      </view>\r\n      <view class=\"bottom-spacer\"></view>\r\n    </scroll-view>\r\n\r\n    <!-- 底部操作栏 -->\r\n    <view class=\"bottom-bar\">\r\n      <view class=\"bar-content\">\r\n        <view class=\"action-btns\">\r\n          <view class=\"action-item\" @click=\"callOwner\">\r\n            <text class=\"material-symbols-outlined bar-icon\">call</text>\r\n            <text class=\"bar-text\">拨打电话</text>\r\n          </view>\r\n          <view class=\"action-item\" @click=\"toggleFollow\">\r\n            <text\r\n              v-if=\"isFollowed\"\r\n              class=\"material-symbols-outlined bar-icon filled\"\r\n              >favorite</text\r\n            >\r\n            <text v-else class=\"material-symbols-outlined bar-icon\"\r\n              >favorite_border</text\r\n            >\r\n            <text class=\"bar-text\">关注</text>\r\n          </view>\r\n        </view>\r\n        <view class=\"bar-divider\"></view>\r\n        <button class=\"unlock-btn\" @click=\"openLock\">\r\n          <text\r\n            v-if=\"hasSmartLock\"\r\n            class=\"material-symbols-outlined unlock-icon filled\"\r\n            >lock</text\r\n          >\r\n          <text v-else class=\"material-symbols-outlined unlock-icon\"\n            >lock_open</text\n          >\n          <text>{{ hasSmartLock ? \"智能锁\" : \"未绑定智能锁\" }}</text>\n        </button>\n      </view>\n    </view>\n  </view>\n</template>\r\n\r\n<script>\r\nimport propertyApi from \"@/api/property\";\r\nimport $store from \"@/store\";\r\n\r\nexport default {\n  data() {\n    return {\n      propertyId: 0,\n      loading: false,\n      property: {},\n      currentUserId: 0,\n      canManageProperties: false,\n      statusBarHeight: 0,\n      headerTop: 0,\n      headerPadLeftPx: 0,\n      headerPadRightPx: 0,\n      // 0：顶部（暗色渐变遮罩） -> 1：下滑后（磨砂白底）\n      headerOpacity: 0,\n      currentSwiper: 0,\n      isFollowed: false,\n      hasSmartLock: false,\r\n      ownerPhone: \"\",\r\n      images: [\r\n        \"/static/images/img_cdc09ae543.png\",\r\n        \"/static/images/img_cdc09ae543.png\",\r\n      ],\r\n      bannerItems: [\r\n        { type: \"image\", src: \"/static/images/img_cdc09ae543.png\" },\r\n        { type: \"image\", src: \"/static/images/img_cdc09ae543.png\" },\r\n      ],\r\n      videoUrl: \"\",\r\n      videoPoster: \"/static/images/img_cdc09ae543.png\",\r\n      allowImageDownload: true,\r\n      allowVideoDownload: true,\r\n      mapLat: 0,\r\n      mapLng: 0,\r\n      mapMarkers: [],\r\n\r\n      attributes: [\r\n        { label: \"单价\", value: \"9,086元/m²\" },\r\n        { label: \"楼层\", value: \"中层 / 共32层\" },\r\n        { label: \"朝向\", value: \"南北通透\" },\r\n        { label: \"装修\", value: \"精装修\" },\r\n        { label: \"年代\", value: \"2019年建\" },\r\n        { label: \"产权\", value: \"商品房\" },\r\n      ],\r\n\r\n      // 未装修：展示“未装修”状态说明\r\n      // 装修进行中：展示 轮播施工图 + 进度条 + 预计完工 + 材料标签 + 施工说明\r\n      // 装修完成：展示完成时间 + 材料 + 装修说明\r\n      // 实现方式：\r\n      // 页面右上角用小的状态切换条（未装修/进行中/已完成）做演示切换（静态数据）\r\n      // 数据在 data() 里新增 renovationTabs 和 renovation（包含 images/materials/note/progress/stage 等）\r\n      // 已补齐对应样式（与当前“高端”风格一致）\r\n\r\n      renovationTabs: [\r\n        { key: \"none\", label: \"未装修\" },\r\n        { key: \"in_progress\", label: \"进行中\" },\r\n        { key: \"done\", label: \"已完成\" },\r\n      ],\r\n      renovation: {\r\n        status: \"in_progress\", // none | in_progress | done\r\n        subtitle: \"高端精装，环保材料（示例）\",\r\n        progress: 68,\r\n        stage: \"水电验收完成，正在进行泥木施工\",\r\n        eta: \"预计 2026-02-20\",\r\n        finishAt: \"2026-01-10\",\r\n        materials: [\"圣象地板\", \"马可波罗瓷砖\", \"多乐士乳胶漆\"],\r\n        note: \"客厅墙面已完成找平与底漆，卫生间防水已做闭水试验；全屋线管/强弱电分离施工完成。\",\r\n        images: [\r\n          \"/static/images/img_08b712f810.png\",\r\n          \"/static/images/img_8642388cea.png\",\r\n        ],\r\n      },\r\n      recommends: [\r\n        {\r\n          name: \"阳光花园三期 2室\",\r\n          rooms: \"2室1厅\",\r\n          price: \"72万\",\r\n          size: \"89\",\r\n          image: \"/static/images/img_71f4809787.png\",\r\n        },\r\n        {\r\n          name: \"金地名津 精装大三房\",\r\n          rooms: \"3室2厅\",\r\n          price: \"98万\",\r\n          size: \"96\",\r\n          image: \"/static/images/img_1112597ba0.png\",\r\n        },\r\n        {\r\n          name: \"万科四季花城\",\r\n          rooms: \"3室2厅\",\r\n          price: \"105万\",\r\n          size: \"110\",\r\n          image: \"/static/images/img_662c3c598a.png\",\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  onLoad(options) {\n    const info = uni.getSystemInfoSync();\n    this.statusBarHeight = info.statusBarHeight;\n    // #ifdef MP-WEIXIN\n    try {\n      if (typeof wx !== \"undefined\" && wx.getMenuButtonBoundingClientRect) {\n        const rect = wx.getMenuButtonBoundingClientRect();\n        // 让右上角按钮避开胶囊按钮区域\n        const w = Number(info.windowWidth || 375);\n        const rpx2px = w / 750;\n        const padLeftPx = Math.round(32 * rpx2px); // .float-header 左右 32rpx\n        const rightSafePx = Math.max(0, w - Number(rect.left || 0));\n        this.headerPadLeftPx = padLeftPx;\n        this.headerPadRightPx = padLeftPx + rightSafePx;\n        // 与胶囊按钮垂直居中对齐：用胶囊中心线对齐返回圆按钮中心线\n        const circleBtnSizePx = 80 * rpx2px; // .circle-btn: 80rpx\n        const capsuleCenterY =\n          Number(rect.top || 0) + Number(rect.height || 0) / 2;\n        const top = capsuleCenterY - circleBtnSizePx / 2;\n        this.headerTop = Math.max(\r\n          Number(this.statusBarHeight || 0),\r\n          Math.round(top)\r\n        );\r\n      } else {\r\n        this.headerTop = this.statusBarHeight + 12;\r\n      }\r\n    } catch (e) {\r\n      this.headerTop = this.statusBarHeight + 12;\n    }\n    // #endif\n    // #ifndef MP-WEIXIN\n    this.headerTop = this.statusBarHeight + 12;\n    // #endif\n\r\n    const id =\r\n      Number(options && (options.id || options.ID || options.property_id)) || 0;\r\n    this.propertyId = id;\r\n    if (!this.propertyId) {\r\n      uni.showToast({ title: \"房源ID缺失\", icon: \"none\" });\r\n      return;\r\n    }\r\n    this.ensureCanManageProperties();\r\n    this.loadDetail();\r\n  },\n  computed: {\n    canEditThisProperty() {\n      if (!this.canManageProperties) return false;\n      const pid = Number(this.propertyId || 0) || 0;\n      if (!pid) return false;\n      const agentId = Number(this.property && this.property.agent_id) || 0;\n      const uid = Number(this.currentUserId || 0) || 0;\n      // 最小权限：仅允许编辑自己维护(agent_id=自己)的房源\n      if (!uid || !agentId) return false;\n      return agentId === uid;\n    },\n    showDownloadBtn() {\n      const item = this.getCurrentBannerItem();\n      if (!item) return false;\n      if (item.type === \"video\") return !!this.allowVideoDownload;\n      if (item.type === \"image\") return !!this.allowImageDownload;\r\n      return false;\r\n    },\r\n    downloadLabel() {\r\n      const item = this.getCurrentBannerItem();\r\n      if (!item) return \"下载\";\r\n      return item.type === \"video\" ? \"下载视频\" : \"下载图片\";\r\n    },\r\n    hasLocation() {\r\n      const lat = Number(this.mapLat);\r\n      const lng = Number(this.mapLng);\r\n      return !!lat && !!lng && isFinite(lat) && isFinite(lng);\r\n    },\r\n  },\r\n  methods: {\n    async ensureCanManageProperties() {\n      // 仅用于 UI 控制；最终权限以后端校验为准\n      const userStore = $store(\"user\");\n      const token = uni.getStorageSync(\"token\");\n      if (!token && !userStore.isLogin) {\n        this.canManageProperties = false;\n        this.currentUserId = 0;\n        return;\n      }\n      try {\n        const ui = userStore.userInfo || {};\n        // 兼容：老版本缓存的 userInfo 可能没有 can_manage_properties，需要强制刷新一次\n        if (!ui.id || typeof ui.can_manage_properties === \"undefined\") {\n          await userStore.getInfo();\n        }\n      } catch (e) {}\n      const u = userStore.userInfo || {};\n      this.currentUserId = Number(u.id || 0) || 0;\n      this.canManageProperties = Number(u.can_manage_properties) === 1;\n      try {\n        console.log(\"[property_detail] perm\", {\n          id: this.currentUserId,\n          can_manage_properties: u.can_manage_properties,\n        });\n      } catch (e) {}\n    },\n    goEdit() {\n      if (!this.propertyId) return;\n      uni.navigateTo({\n        url: `/pages/property_manage/property_edit?id=${this.propertyId}`,\n      });\n    },\n    debugEditState() {\n      try {\n        const uid = Number(this.currentUserId || 0) || 0;\n        const can = !!this.canManageProperties;\n        const agentId = Number(this.property && this.property.agent_id) || 0;\n        const show = !!this.canEditThisProperty;\n        uni.showModal({\n          title: \"编辑按钮诊断\",\n          content: [\n            `can_manage_properties: ${can ? 1 : 0}`,\n            `currentUserId: ${uid}`,\n            `property.agent_id: ${agentId}`,\n            `canEditThisProperty: ${show ? 1 : 0}`,\n            show ? \"✅ 满足条件应显示\" : \"❌ 条件不满足所以不显示\",\n          ].join(\"\\n\"),\n          showCancel: false,\n        });\n      } catch (e) {\n        // ignore\n      }\n    },\n    tagClass(tag) {\n      const t = String(tag || \"\").trim();\n      if (!t) return \"\";\n      if (t.includes(\"急售\") || t.includes(\"降价\")) return \"orange\";\r\n      return \"\";\r\n    },\r\n    getLayoutText(p) {\r\n      const rooms = Number(p && p.rooms) || 0;\r\n      const halls = Number(p && p.halls) || 0;\r\n      const bathrooms = Number(p && p.bathrooms) || 0;\r\n      if (!rooms && !halls && !bathrooms) return \"-\";\r\n      let s = \"\";\r\n      if (rooms) s += `${rooms}室`;\r\n      if (halls) s += `${halls}厅`;\r\n      if (bathrooms) s += `${bathrooms}卫`;\r\n      return s || \"-\";\r\n    },\r\n    getUnitPriceText(p) {\r\n      const price = Number(p && p.price);\r\n      const area = Number(p && p.area);\r\n      if (!price || !area) return \"-\";\r\n      const unit = (p && p.price_unit) || \"\";\r\n      let totalYuan = price;\r\n      if (unit === \"万\") totalYuan = price * 10000;\r\n      const per = totalYuan / area;\r\n      if (!per || !isFinite(per)) return \"-\";\r\n      return `${Math.round(per).toLocaleString()}元/㎡`;\r\n    },\r\n    buildAttributes(p) {\r\n      const attrs = [];\r\n      attrs.push({ label: \"单价\", value: this.getUnitPriceText(p) });\r\n      const floor = String((p && p.floor_level) || \"\").trim();\r\n      const totalFloors = Number(p && p.total_floors) || 0;\r\n      if (floor || totalFloors) {\r\n        attrs.push({\r\n          label: \"楼层\",\r\n          value: `${floor || \"-\"}${totalFloors ? ` / 共${totalFloors}层` : \"\"}`,\r\n        });\r\n      }\r\n      attrs.push({\r\n        label: \"朝向\",\r\n        value: p && p.orientation ? p.orientation : \"-\",\r\n      });\r\n      attrs.push({\r\n        label: \"装修\",\r\n        value: p && p.decoration_type ? p.decoration_type : \"-\",\r\n      });\r\n      const year = Number(p && p.build_year) || 0;\r\n      attrs.push({ label: \"年代\", value: year ? `${year}年建` : \"-\" });\r\n      attrs.push({\r\n        label: \"物业类型\",\r\n        value: p && p.property_type ? p.property_type : \"-\",\r\n      });\r\n      return attrs;\r\n    },\r\n    getCommissionText(p) {\r\n      const rate = String((p && p.commission_rate) || \"\").trim();\r\n      const reward = String((p && p.commission_reward) || \"\").trim();\r\n      const hasRate =\r\n        !!rate && rate !== \"0\" && rate !== \"0.0\" && rate !== \"0.00\";\r\n      const hasReward =\r\n        !!reward && reward !== \"0\" && reward !== \"0.0\" && reward !== \"0.00\";\r\n      if (hasRate && hasReward) return `佣金${rate}% ，成交奖励￥${reward}`;\r\n      if (hasRate) return `佣金${rate}%`;\r\n      if (hasReward) return `成交奖励￥${reward}`;\r\n      return \"佣金待定\";\r\n    },\r\n    mapPinText() {\r\n      const name = String(\r\n        (this.property && this.property.community_name) || \"\"\r\n      ).trim();\r\n      const addr = String(\r\n        (this.property && this.property.address) || \"\"\r\n      ).trim();\r\n      if (name && addr) return `${name} · ${addr}`;\r\n      return name || addr || \"暂无位置信息\";\r\n    },\r\n    async loadDetail() {\r\n      if (this.loading || !this.propertyId) return false;\r\n      this.loading = true;\r\n      let res;\r\n      try {\r\n        res = await propertyApi.getDetail({ id: this.propertyId });\r\n      } catch (e) {\r\n        this.loading = false;\r\n        if (!uni.getStorageSync(\"token\")) {\r\n          uni.reLaunch({ url: \"/pages/login/login\" });\r\n        }\r\n        return false;\r\n      }\r\n      this.loading = false;\r\n      if (!res || res.code !== 0) {\r\n        setTimeout(() => {\r\n          uni.navigateBack();\r\n        }, 600);\r\n        return false;\r\n      }\r\n\r\n      const data = res.data || {};\r\n      const p = data.property || {};\r\n      // 兼容：后端也会回传 current_user（已登录用户ID）\r\n      if (!this.currentUserId) this.currentUserId = Number(data.current_user || 0) || 0;\r\n      if (!p || !p.id) {\r\n        setTimeout(() => {\r\n          uni.navigateBack();\r\n        }, 600);\r\n        return false;\r\n      }\r\n      this.property = p;\r\n      this.isFollowed = !!data.is_followed;\r\n      this.hasSmartLock = Number(p.has_smart_lock) === 1;\r\n      this.ownerPhone = String(p.owner_phone || \"\").trim();\r\n\r\n      // 下载权限（后端默认：1 允许）\r\n      this.allowImageDownload = Number(p.allow_image_download) !== 0;\r\n      this.allowVideoDownload = Number(p.allow_video_download) !== 0;\r\n\r\n      // 视频（单个）\r\n      this.videoUrl = String(p.video_url || \"\").trim();\r\n      this.videoPoster = String(p.cover_image || \"\").trim();\r\n\r\n      const imgs = Array.isArray(data.images)\r\n        ? data.images\r\n        : Array.isArray(p.images)\r\n        ? p.images\r\n        : [];\r\n      if (imgs.length > 0) this.images = imgs;\r\n      this.currentSwiper = 0;\r\n\r\n      // Banner：优先展示视频（若存在）\r\n      const items = [];\r\n      if (this.videoUrl) items.push({ type: \"video\", src: this.videoUrl });\r\n      (this.images || []).forEach((u) => items.push({ type: \"image\", src: u }));\r\n      this.bannerItems = items;\r\n\r\n      // 地图坐标（小程序 map 组件）\r\n      const lat = Number(p.latitude);\r\n      const lng = Number(p.longitude);\r\n      this.mapLat = isFinite(lat) ? lat : 0;\r\n      this.mapLng = isFinite(lng) ? lng : 0;\r\n      this.mapMarkers =\r\n        this.mapLat && this.mapLng\r\n          ? [\r\n              {\r\n                id: 1,\r\n                latitude: this.mapLat,\r\n                longitude: this.mapLng,\r\n                width: 26,\r\n                height: 26,\r\n              },\r\n            ]\r\n          : [];\r\n\r\n      this.attributes = this.buildAttributes(p);\r\n\r\n      const r = data.renovation || {};\r\n      const statusRaw = String(r.renovation_status || \"\").trim();\r\n      let status = \"none\";\r\n      if (\r\n        statusRaw === \"in_progress\" ||\r\n        statusRaw === \"done\" ||\r\n        statusRaw === \"none\"\r\n      ) {\r\n        status = statusRaw;\r\n      } else if (statusRaw === \"1\") {\r\n        status = \"in_progress\";\r\n      } else if (statusRaw === \"2\") {\r\n        status = \"done\";\r\n      }\r\n      this.renovation = {\r\n        status,\r\n        subtitle: String(r.subtitle || \"房源装修情况\").trim() || \"房源装修情况\",\r\n        progress: Number(r.progress_percentage || 0) || 0,\r\n        stage: String(r.current_stage || \"\").trim() || \"—\",\r\n        eta: String(r.estimated_finish_date || \"\").trim() || \"—\",\r\n        finishAt: String(r.actual_finish_date || \"\").trim() || \"—\",\r\n        materials: Array.isArray(r.materials) ? r.materials : [],\r\n        note: String(r.notes || \"\").trim() || \"—\",\r\n        images: Array.isArray(r.images) ? r.images : [],\r\n      };\r\n\r\n      const rec = Array.isArray(data.recommends) ? data.recommends : [];\r\n      this.recommends = rec.map((it) => ({\r\n        id: it.id,\r\n        name: it.title || it.name || \"房源\",\r\n        rooms: this.getLayoutText(it),\r\n        price: `${it.price || \"-\"}${it.price_unit || \"\"}`,\r\n        size: it.area || \"-\",\r\n        image: it.image || \"\",\r\n      }));\r\n      return true;\r\n    },\r\n    onPageScroll(e) {\r\n      // scroll-view 的 scrollTop（px）\r\n      const st = Number((e && e.detail && e.detail.scrollTop) || 0);\r\n      // 越往下越“实”（白底更明显）；回到顶部恢复暗色渐变\r\n      const fadeDistance = 160;\r\n      const next = Math.min(1, st / fadeDistance);\r\n      this.headerOpacity = Math.max(0, Math.min(1, Number(next.toFixed(3))));\r\n    },\r\n    goBack() {\r\n      uni.navigateBack();\r\n    },\r\n    goToRec(rec) {\r\n      const id = Number(rec && (rec.id || rec.ID)) || 0;\r\n      if (!id) return;\r\n      if (id === this.propertyId) return;\r\n      uni.redirectTo({\r\n        url: `/pages/property_detail/property_detail?id=${encodeURIComponent(\r\n          id\r\n        )}`,\r\n      });\r\n    },\r\n    swiperChange(e) {\r\n      this.currentSwiper = e.detail.current;\r\n    },\r\n    getCurrentBannerItem() {\r\n      const list = Array.isArray(this.bannerItems) ? this.bannerItems : [];\r\n      const idx = Number(this.currentSwiper) || 0;\r\n      return list[idx] || null;\r\n    },\r\n\r\n    // 申请相册权限（用于保存图片/视频）\r\n    ensureAlbumPermission() {\r\n      return new Promise((resolve, reject) => {\r\n        uni.getSetting({\r\n          success: (st) => {\r\n            const ok =\r\n              st && st.authSetting && st.authSetting[\"scope.writePhotosAlbum\"];\r\n            if (ok) return resolve(true);\r\n            uni.authorize({\r\n              scope: \"scope.writePhotosAlbum\",\r\n              success: () => resolve(true),\r\n              fail: () => {\r\n                uni.showModal({\r\n                  title: \"需要相册权限\",\r\n                  content: \"保存到相册需要授权，请在设置中开启相册权限。\",\r\n                  confirmText: \"去设置\",\r\n                  success: (r) => {\r\n                    if (r.confirm) {\r\n                      uni.openSetting({\r\n                        success: () => resolve(true),\r\n                        fail: () => reject(false),\r\n                      });\r\n                    } else {\r\n                      reject(false);\r\n                    }\r\n                  },\r\n                });\r\n              },\r\n            });\r\n          },\r\n          fail: () => reject(false),\r\n        });\r\n      });\r\n    },\r\n\r\n    async downloadCurrent() {\r\n      const item = this.getCurrentBannerItem();\r\n      if (!item) return;\r\n      if (item.type === \"video\" && !this.allowVideoDownload) return;\r\n      if (item.type === \"image\" && !this.allowImageDownload) return;\r\n\r\n      try {\r\n        await this.ensureAlbumPermission();\r\n      } catch (e) {\r\n        return;\r\n      }\r\n\r\n      const url = String(item.src || \"\").trim();\r\n      if (!url) return;\r\n      uni.showLoading({ title: \"下载中...\" });\r\n      uni.downloadFile({\r\n        url,\r\n        success: (d) => {\r\n          const fp = d && d.tempFilePath;\r\n          if (!fp) {\r\n            uni.hideLoading();\r\n            uni.showToast({ title: \"下载失败\", icon: \"none\" });\r\n            return;\r\n          }\r\n          if (item.type === \"video\") {\r\n            uni.saveVideoToPhotosAlbum({\r\n              filePath: fp,\r\n              success: () =>\r\n                uni.showToast({ title: \"已保存视频\", icon: \"success\" }),\r\n              fail: () => uni.showToast({ title: \"保存失败\", icon: \"none\" }),\r\n              complete: () => uni.hideLoading(),\r\n            });\r\n          } else {\r\n            uni.saveImageToPhotosAlbum({\r\n              filePath: fp,\r\n              success: () =>\r\n                uni.showToast({ title: \"已保存图片\", icon: \"success\" }),\r\n              fail: () => uni.showToast({ title: \"保存失败\", icon: \"none\" }),\r\n              complete: () => uni.hideLoading(),\r\n            });\r\n          }\r\n        },\r\n        fail: () => {\r\n          uni.hideLoading();\r\n          uni.showToast({ title: \"下载失败\", icon: \"none\" });\r\n        },\r\n      });\r\n    },\r\n    handleShare() {\r\n      const title =\r\n        this.property && this.property.title ? this.property.title : \"房源\";\r\n      const id = this.propertyId;\r\n      uni.showActionSheet({\r\n        itemList: [\"生成获客海报\", \"复制房源链接\", \"模拟分享（占位）\"],\r\n        success: (res) => {\r\n          if (res.tapIndex === 0) {\r\n            uni.navigateTo({\r\n              url: `/pages/marketing_posters/marketing_posters?title=${encodeURIComponent(\r\n                title\r\n              )}`,\r\n            });\r\n            return;\r\n          }\r\n          if (res.tapIndex === 1) {\r\n            const link = id\r\n              ? `/pages/property_detail/property_detail?id=${encodeURIComponent(\r\n                  id\r\n                )}`\r\n              : `/pages/property_detail/property_detail`;\r\n            uni.setClipboardData({\r\n              data: `${title}\\n${link}`,\r\n              success: () =>\r\n                uni.showToast({ title: \"已复制链接\", icon: \"none\" }),\r\n            });\r\n            return;\r\n          }\r\n          if (res.tapIndex === 2) {\r\n            uni.showToast({ title: \"分享功能待接入\", icon: \"none\" });\r\n          }\r\n        },\r\n      });\r\n    },\r\n    openMap() {\r\n      const lat = Number(this.property && this.property.latitude);\r\n      const lng = Number(this.property && this.property.longitude);\r\n      const name = String(\r\n        (this.property &&\r\n          (this.property.community_name || this.property.title)) ||\r\n          \"房源\"\r\n      ).trim();\r\n      const address = String(\r\n        (this.property && this.property.address) || \"\"\r\n      ).trim();\r\n      if (!lat || !lng || !isFinite(lat) || !isFinite(lng)) {\r\n        uni.showToast({ title: \"暂无定位信息\", icon: \"none\" });\r\n        return;\r\n      }\r\n      uni.openLocation({\r\n        latitude: lat,\r\n        longitude: lng,\r\n        name,\r\n        address: address || name,\r\n        fail: () => {\r\n          uni.showToast({ title: \"无法打开地图\", icon: \"none\" });\r\n        },\r\n      });\r\n    },\r\n    async toggleFollow() {\r\n      if (!this.propertyId) return;\r\n      let res;\r\n      try {\r\n        res = await propertyApi.toggleFollow({ id: this.propertyId });\r\n      } catch (e) {\r\n        if (!uni.getStorageSync(\"token\")) {\r\n          uni.reLaunch({ url: \"/pages/login/login\" });\r\n        }\r\n        return;\r\n      }\r\n      if (!res || res.code !== 0) return;\r\n      const data = res.data || {};\r\n      this.isFollowed = !!data.is_followed;\r\n      if (this.property) {\r\n        this.property.follow_count = data.follow_count;\r\n      }\r\n      uni.showToast({\r\n        title: this.isFollowed ? \"已关注\" : \"已取消关注\",\r\n        icon: \"none\",\r\n      });\r\n    },\r\n    callOwner() {\r\n      if (!this.ownerPhone) {\r\n        uni.showToast({ title: \"暂无业主电话\", icon: \"none\" });\r\n        return;\r\n      }\r\n      uni.makePhoneCall({\r\n        phoneNumber: this.ownerPhone,\r\n      });\r\n    },\r\n    openLock() {\n      const ss = String(\n        (this.property && this.property.sale_status) || \"\"\n      ).trim();\n      if (ss === \"sold\" || ss === \"off_market\") {\n        const label =\r\n          this.property && this.property.sale_status_label\r\n            ? this.property.sale_status_label\r\n            : \"不可操作\";\r\n        uni.showToast({ title: `房源${label}，暂不可开锁`, icon: \"none\" });\n        return;\n      }\n      if (!this.hasSmartLock) {\n        uni.showToast({ title: \"该房源未绑定智能锁，无法开锁\", icon: \"none\" });\n        return;\n      }\n      // 进入开锁流程页（页面内可选择蓝牙开锁 / 获取密码开锁）\n      uni.navigateTo({\n        url: `/pages/unlock_steps/unlock_steps?property_id=${encodeURIComponent(\n          this.propertyId\n        )}`,\n      });\n    },\n    setRenovationStatus(key) {\r\n      // 展示用：不允许手动切换，避免与真实数据不一致\r\n      void key;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.detail-container {\r\n  height: 100vh;\r\n  background-color: #f6f7f8;\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n}\r\n\r\n.float-header {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 100;\n  display: flex;\n  justify-content: space-between;\n  padding: 0 32rpx;\n  pointer-events: none;\n  padding-bottom: 8rpx;\n  box-sizing: border-box;\n\r\n  /* 背景遮罩：不挡点击 */\r\n  .fh-mask {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n    pointer-events: none;\r\n    transition: opacity 0.18s ease;\r\n  }\r\n\r\n  /* 顶部：暗色渐变，保证返回键在封面图上更清晰 */\r\n  .fh-mask--dark {\r\n    background: linear-gradient(\r\n      to bottom,\r\n      rgba(15, 23, 42, 0.45) 0%,\r\n      rgba(15, 23, 42, 0.18) 55%,\r\n      rgba(15, 23, 42, 0) 100%\r\n    );\r\n  }\r\n\r\n  /* 下滑后：磨砂白底（更接近普通页面导航栏） */\r\n  .fh-mask--light {\r\n    background: rgba(255, 255, 255, 0.92);\r\n    backdrop-filter: blur(12px);\r\n    -webkit-backdrop-filter: blur(12px);\r\n    border-bottom: 1rpx solid rgba(226, 232, 240, 0.9);\r\n    box-shadow: 0 6rpx 18rpx rgba(15, 23, 42, 0.04);\r\n  }\r\n\r\n  .header-left {\n    display: flex;\n    gap: 24rpx;\n    pointer-events: auto;\n    position: relative;\n    z-index: 2;\n  }\n\n  .circle-btn {\n    width: 80rpx;\n    height: 80rpx;\n    background-color: rgba(0, 0, 0, 0.2);\r\n    backdrop-filter: blur(10px);\r\n    border-radius: 50%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: #ffffff;\r\n\r\n    .material-symbols-outlined {\r\n      font-size: 40rpx;\r\n    }\r\n\r\n    &:active {\r\n      background-color: rgba(0, 0, 0, 0.4);\r\n    }\r\n\r\n    /* 下滑后：切到浅色按钮，避免白底上显得“脏/灰” */\r\n    &.is-solid {\r\n      background-color: rgba(15, 23, 42, 0.06);\r\n      color: #0f172a;\r\n    }\r\n    &.is-solid:active {\r\n      background-color: rgba(15, 23, 42, 0.12);\r\n    }\r\n  }\r\n}\r\n\r\n.detail-scroll {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.banner {\r\n  width: 100%;\r\n  height: 640rpx;\r\n  position: relative;\r\n\r\n  .swiper {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .banner-image {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .banner-video {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .banner-actions {\r\n    position: absolute;\r\n    bottom: 64rpx;\r\n    left: 32rpx;\r\n    z-index: 3;\r\n  }\r\n\r\n  .dl-pill {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10rpx;\r\n    padding: 12rpx 18rpx;\r\n    border-radius: 999rpx;\r\n    background: rgba(255, 255, 255, 0.88);\r\n    backdrop-filter: blur(10rpx);\r\n    border: 1px solid rgba(15, 23, 42, 0.08);\r\n    box-shadow: 0 10rpx 24rpx rgba(15, 23, 42, 0.18);\r\n  }\r\n\r\n  .dl-icon {\r\n    font-size: 34rpx;\r\n    color: #0f766e;\r\n  }\r\n\r\n  .dl-text {\r\n    font-size: 24rpx;\r\n    font-weight: 700;\r\n    color: #0f172a;\r\n  }\r\n\r\n  .banner-indicator {\r\n    position: absolute;\r\n    bottom: 64rpx;\r\n    right: 32rpx;\r\n    background-color: rgba(0, 0, 0, 0.6);\r\n    backdrop-filter: blur(4rpx);\r\n    color: #ffffff;\r\n    font-size: 24rpx;\r\n    font-weight: 600;\r\n    padding: 4rpx 24rpx;\r\n    border-radius: 40rpx;\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n  }\r\n}\r\n\r\n.content-card {\r\n  background-color: #ffffff;\r\n  border-radius: 48rpx 48rpx 0 0;\r\n  margin-top: -48rpx;\r\n  position: relative;\r\n  z-index: 10;\r\n  padding: 48rpx 40rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 48rpx;\r\n  box-shadow: 0 -4rpx 20rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.title-section {\n  display: flex;\n  flex-direction: column;\n  gap: 24rpx;\n\r\n  .title-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    gap: 16rpx;\n\r\n    .title {\n      font-size: 40rpx;\n      font-weight: bold;\n      color: #0f172a;\n      line-height: 1.3;\n      flex: 1;\n    }\n\n    .action-col {\n      display: flex;\n      flex-direction: column;\n      align-items: flex-end;\n      gap: 12rpx;\n      flex-shrink: 0;\n    }\n\n    .share-btn {\n      display: flex;\n      align-items: center;\n      gap: 8rpx;\n      padding: 12rpx 16rpx;\n      background: rgba(37, 99, 235, 0.08);\n      border: 1rpx solid rgba(37, 99, 235, 0.14);\n      border-radius: 18rpx;\n      font-size: 24rpx;\n      color: #2563eb;\n      font-weight: 700;\n      flex-shrink: 0;\n\n      .share-icon {\n        font-size: 28rpx;\n      }\n\n      &:active {\n        transform: scale(0.98);\n        background: rgba(37, 99, 235, 0.12);\n      }\n    }\n\n    .edit-btn {\n      display: flex;\n      align-items: center;\n      gap: 8rpx;\n      padding: 12rpx 16rpx;\n      background: rgba(15, 23, 42, 0.06);\n      border: 1rpx solid rgba(15, 23, 42, 0.1);\n      border-radius: 18rpx;\n      font-size: 24rpx;\n      color: #0f172a;\n      font-weight: 700;\n      flex-shrink: 0;\n\n      .edit-icon {\n        font-size: 28rpx;\n      }\n\n      &:active {\n        transform: scale(0.98);\n        background: rgba(15, 23, 42, 0.1);\n      }\n    }\n  }\n\r\n  .tags-row {\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 16rpx;\r\n\r\n    .tag {\r\n      padding: 8rpx 16rpx;\r\n      background-color: #f1f5f9;\r\n      color: #475569;\r\n      font-size: 22rpx;\r\n      font-weight: 500;\r\n      border-radius: 8rpx;\r\n\r\n      &.orange {\r\n        background-color: #fff7ed;\r\n        color: #f97316;\r\n      }\r\n    }\r\n  }\n\n  .status-row {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 12rpx;\n    align-items: center;\n  }\n\n  .status-chip {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n    padding: 8rpx 14rpx;\n    border-radius: 999rpx;\n    font-size: 22rpx;\n    font-weight: 700;\n    background: rgba(15, 23, 42, 0.06);\n    border: 1rpx solid rgba(15, 23, 42, 0.1);\n    color: #0f172a;\n\n    .status-ic {\n      font-size: 26rpx;\n    }\n\n    &.on_sale {\n      background: rgba(34, 197, 94, 0.12);\n      border-color: rgba(34, 197, 94, 0.18);\n      color: #16a34a;\n    }\n    &.sold {\n      background: rgba(234, 88, 12, 0.12);\n      border-color: rgba(234, 88, 12, 0.18);\n      color: #ea580c;\n    }\n    &.off_market {\n      background: rgba(148, 163, 184, 0.18);\n      border-color: rgba(148, 163, 184, 0.22);\n      color: #64748b;\n    }\n\n    &.hot {\n      background: rgba(37, 99, 235, 0.10);\n      border-color: rgba(37, 99, 235, 0.16);\n      color: #2563eb;\n    }\n  }\n}\n\n.contact-card {\n  border-radius: 24rpx;\n  background: linear-gradient(135deg, rgba(15, 23, 42, 0.02), rgba(37, 99, 235, 0.03));\n  border: 1rpx solid rgba(226, 232, 240, 0.9);\n  padding: 18rpx 18rpx 8rpx;\n}\n\n.contact-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 14rpx;\n}\n\n.contact-item {\n  background-color: #ffffff;\n  border-radius: 18rpx;\n  border: 1rpx solid rgba(226, 232, 240, 0.9);\n  padding: 14rpx 14rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 6rpx;\n  min-width: 0;\n}\n\n.contact-item.wide {\n  grid-column: span 2;\n}\n\n.contact-label {\n  font-size: 22rpx;\n  color: #64748b;\n  font-weight: 600;\n}\n\n.contact-value {\n  font-size: 26rpx;\n  color: #0f172a;\n  font-weight: 800;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.contact-value.price {\n  color: #ea580c;\n}\n\r\n.stats-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  padding: 26rpx 0;\r\n  border-top: 1rpx solid rgba(226, 232, 240, 0.9);\r\n  border-bottom: 1rpx solid rgba(226, 232, 240, 0.9);\r\n\r\n  .stats-item {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: 6rpx;\r\n    padding: 0 18rpx;\r\n\r\n    &.border-l {\r\n      border-left: 1rpx solid rgba(226, 232, 240, 0.9);\r\n    }\r\n\r\n    .stats-val {\r\n      font-size: 40rpx;\r\n      font-weight: 800;\r\n      color: #0f172a;\r\n      display: inline-flex;\r\n      align-items: baseline;\r\n      justify-content: center;\r\n      line-height: 1;\r\n      white-space: nowrap;\r\n      max-width: 100%;\r\n\r\n      &.orange {\r\n        color: #f97316;\r\n      }\r\n      /* 非价格类字段更容易换行，略缩小字号保证一行展示 */\r\n      &:not(.orange) {\r\n        font-size: 34rpx;\r\n      }\r\n\r\n      .unit {\r\n        font-size: 22rpx;\r\n        font-weight: 700;\r\n        margin-left: 4rpx;\r\n        opacity: 0.9;\r\n      }\r\n    }\r\n\r\n    .stats-label {\r\n      font-size: 22rpx;\r\n      color: #64748b;\r\n      font-weight: 700;\r\n      letter-spacing: 0.4rpx;\r\n    }\r\n  }\r\n}\r\n\r\n.commission-banner {\r\n  background: linear-gradient(to right, #f97316, #ea580c);\r\n  border-radius: 24rpx;\r\n  padding: 32rpx;\r\n  position: relative;\r\n  overflow: hidden;\r\n  box-shadow: 0 10rpx 20rpx rgba(249, 115, 22, 0.2);\r\n\r\n  .banner-bg-decor {\r\n    position: absolute;\r\n    right: -48rpx;\r\n    top: -48rpx;\r\n    width: 192rpx;\r\n    height: 192rpx;\r\n    background-color: rgba(255, 255, 255, 0.1);\r\n    border-radius: 50%;\r\n    filter: blur(40rpx);\r\n  }\r\n\r\n  .banner-main {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 24rpx;\r\n    position: relative;\r\n    z-index: 10;\r\n\r\n    .icon-box {\r\n      width: 80rpx;\r\n      height: 80rpx;\r\n      background-color: rgba(255, 255, 255, 0.2);\r\n      backdrop-filter: blur(10rpx);\r\n      border-radius: 50%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      color: #ffffff;\r\n\r\n      .material-symbols-outlined {\r\n        font-size: 48rpx;\r\n      }\r\n    }\r\n\r\n    .banner-info {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 4rpx;\r\n\r\n      .banner-title {\r\n        font-size: 32rpx;\r\n        font-weight: bold;\r\n        color: #ffffff;\r\n      }\r\n\r\n      .banner-tip {\r\n        font-size: 22rpx;\r\n        color: rgba(255, 255, 255, 0.8);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.data-row {\r\n  background: rgba(255, 255, 255, 0.92);\r\n  backdrop-filter: blur(10px);\r\n  -webkit-backdrop-filter: blur(10px);\r\n  border: 1rpx solid rgba(226, 232, 240, 0.9);\r\n  border-radius: 24rpx;\r\n  box-shadow: 0 10rpx 24rpx rgba(15, 23, 42, 0.06);\r\n  padding: 20rpx 16rpx;\r\n  display: flex;\r\n  align-items: stretch;\r\n\r\n  .data-group {\r\n    flex: 1;\r\n    display: flex;\r\n    align-items: stretch;\r\n  }\r\n\r\n  .data-item {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: 6rpx;\r\n    padding: 6rpx 0;\r\n    position: relative;\r\n\r\n    &:not(:last-child)::after {\r\n      content: \"\";\r\n      position: absolute;\r\n      right: 0;\r\n      top: 10rpx;\r\n      bottom: 10rpx;\r\n      width: 1rpx;\r\n      background-color: rgba(226, 232, 240, 0.9);\r\n    }\r\n\r\n    .val {\r\n      font-size: 40rpx;\r\n      font-weight: 800;\r\n      color: #0f172a;\r\n      letter-spacing: 0.5rpx;\r\n    }\r\n\r\n    .lab {\r\n      font-size: 22rpx;\r\n      color: #64748b;\r\n      font-weight: 600;\r\n    }\r\n  }\r\n}\r\n\r\n.section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24rpx;\r\n\r\n  &.no-pb {\r\n    padding-bottom: 0;\r\n  }\r\n\r\n  .section-header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n\r\n  .section-title {\r\n    font-size: 36rpx;\r\n    font-weight: bold;\r\n    color: #0f172a;\r\n  }\r\n\r\n  .header-more {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4rpx;\r\n    font-size: 24rpx;\r\n    color: #2d9cf0;\r\n    font-weight: 500;\r\n\r\n    .more-icon {\r\n      font-size: 28rpx;\r\n    }\r\n  }\r\n}\r\n\r\n.attr-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 24rpx;\r\n  background-color: #f8fafc;\r\n  padding: 32rpx;\r\n  border-radius: 24rpx;\r\n\r\n  .attr-item {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    font-size: 28rpx;\r\n\r\n    .attr-label {\r\n      color: #64748b;\r\n    }\r\n    .attr-val {\r\n      color: #0f172a;\r\n      font-weight: 500;\r\n    }\r\n  }\r\n}\r\n\r\n/* 装修状态 */\r\n.reno-tabs {\r\n  display: flex;\r\n  gap: 12rpx;\r\n  background-color: #f1f5f9;\r\n  padding: 6rpx;\r\n  border-radius: 18rpx;\r\n}\r\n\r\n.reno-tab {\r\n  padding: 10rpx 16rpx;\r\n  border-radius: 14rpx;\r\n  font-size: 22rpx;\r\n  color: #64748b;\r\n  font-weight: 700;\r\n  background-color: transparent;\r\n\r\n  &.active {\r\n    background-color: #ffffff;\r\n    color: #0f172a;\r\n    box-shadow: 0 6rpx 14rpx rgba(15, 23, 42, 0.06);\r\n  }\r\n}\r\n\r\n.reno-card {\r\n  background-color: #f8fafc;\r\n  border-radius: 24rpx;\r\n  padding: 24rpx;\r\n  border: 1px solid #f1f5f9;\r\n}\r\n\r\n.reno-top {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12rpx;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.reno-badge {\r\n  padding: 6rpx 14rpx;\r\n  border-radius: 999rpx;\r\n  font-size: 22rpx;\r\n  font-weight: 800;\r\n  letter-spacing: 0.4rpx;\r\n\r\n  &.none {\r\n    background: rgba(148, 163, 184, 0.18);\r\n    color: #475569;\r\n  }\r\n  &.in_progress {\r\n    background: rgba(245, 158, 11, 0.18);\r\n    color: #b45309;\r\n  }\r\n  &.done {\r\n    background: rgba(34, 197, 94, 0.16);\r\n    color: #15803d;\r\n  }\r\n}\r\n\r\n.reno-sub {\r\n  font-size: 24rpx;\r\n  color: #64748b;\r\n  font-weight: 600;\r\n}\r\n\r\n.reno-empty {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  gap: 16rpx;\r\n  padding: 8rpx 4rpx 4rpx;\r\n}\r\n\r\n.reno-empty-icon {\r\n  font-size: 44rpx;\r\n  color: #94a3b8;\r\n}\r\n\r\n.reno-empty-texts {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 6rpx;\r\n}\r\n\r\n.reno-empty-title {\r\n  font-size: 28rpx;\r\n  font-weight: 800;\r\n  color: #0f172a;\r\n}\r\n\r\n.reno-empty-desc {\r\n  font-size: 24rpx;\r\n  color: #64748b;\r\n  line-height: 1.5;\r\n}\r\n\r\n.reno-swiper {\r\n  width: 100%;\r\n  height: 260rpx;\r\n  border-radius: 20rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.reno-image {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.reno-progress {\r\n  margin-top: 14rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 16rpx;\r\n}\r\n\r\n.reno-progress-bar {\r\n  flex: 1;\r\n  height: 16rpx;\r\n  border-radius: 999rpx;\r\n  background-color: rgba(226, 232, 240, 0.9);\r\n  overflow: hidden;\r\n}\r\n\r\n.reno-progress-fill {\r\n  height: 100%;\r\n  border-radius: 999rpx;\r\n  background: linear-gradient(90deg, #60a5fa, #2563eb);\r\n}\r\n\r\n.reno-progress-text {\r\n  font-size: 22rpx;\r\n  color: #334155;\r\n  font-weight: 700;\r\n  white-space: nowrap;\r\n}\r\n\r\n.reno-info {\r\n  margin-top: 16rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n}\r\n\r\n.reno-info-row {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  justify-content: space-between;\r\n  gap: 16rpx;\r\n\r\n  &.col {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .k {\r\n    font-size: 24rpx;\r\n    color: #64748b;\r\n    font-weight: 700;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  .v {\r\n    font-size: 24rpx;\r\n    color: #0f172a;\r\n    font-weight: 600;\r\n    text-align: right;\r\n    flex: 1;\r\n\r\n    &.desc {\r\n      text-align: left;\r\n      color: #334155;\r\n      font-weight: 500;\r\n      line-height: 1.55;\r\n    }\r\n  }\r\n}\r\n\r\n.chips {\r\n  flex: 1;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  flex-wrap: wrap;\r\n  gap: 10rpx;\r\n}\r\n\r\n.chip {\r\n  padding: 6rpx 12rpx;\r\n  border-radius: 999rpx;\r\n  background-color: rgba(37, 99, 235, 0.08);\r\n  border: 1rpx solid rgba(37, 99, 235, 0.12);\r\n  color: #2563eb;\r\n  font-size: 22rpx;\r\n  font-weight: 700;\r\n}\r\n\r\n.info-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 32rpx;\r\n  border-radius: 24rpx;\r\n  border: 1px solid #f1f5f9;\r\n\r\n  .info-item {\r\n    display: flex;\r\n    gap: 24rpx;\r\n    align-items: flex-start;\r\n\r\n    .info-icon {\r\n      font-size: 36rpx;\r\n      color: #94a3b8;\r\n      margin-top: 4rpx;\r\n\r\n      &.primary {\r\n        color: #2d9cf0;\r\n      }\r\n    }\r\n\r\n    .info-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8rpx;\r\n    }\r\n\r\n    .info-title-row {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 16rpx;\r\n    }\r\n\r\n    .info-title {\r\n      font-size: 28rpx;\r\n      font-weight: 500;\r\n      color: #0f172a;\r\n    }\r\n\r\n    .info-tag {\r\n      padding: 4rpx 12rpx;\r\n      background-color: #eff6ff;\r\n      color: #2d9cf0;\r\n      font-size: 20rpx;\r\n      font-weight: bold;\r\n      border-radius: 4rpx;\r\n    }\r\n\r\n    .info-desc {\r\n      font-size: 24rpx;\r\n      color: #64748b;\r\n    }\r\n  }\r\n\r\n  .info-divider {\r\n    height: 1px;\r\n    background-color: #f1f5f9;\r\n    margin: 32rpx 0;\r\n  }\r\n}\r\n\r\n.map-box {\r\n  width: 100%;\r\n  height: 288rpx;\r\n  border-radius: 24rpx;\r\n  overflow: hidden;\r\n  position: relative;\r\n\r\n  .map-native {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .map-image {\r\n    width: 100%;\r\n    height: 100%;\r\n    opacity: 0.8;\r\n  }\r\n\r\n  .map-mask {\r\n    position: absolute;\r\n    inset: 0;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: rgba(0, 0, 0, 0.05);\r\n\r\n    .map-pin {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 12rpx;\r\n      background-color: rgba(255, 255, 255, 0.95);\r\n      backdrop-filter: blur(10px);\r\n      padding: 12rpx 24rpx;\r\n      border-radius: 16rpx;\r\n      box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n      font-size: 24rpx;\r\n      font-weight: bold;\r\n      color: #0f172a;\r\n\r\n      .pin-icon {\r\n        color: #2d9cf0;\r\n        font-size: 28rpx;\r\n      }\r\n    }\r\n\r\n    .map-coords {\r\n      position: absolute;\r\n      bottom: 16rpx;\r\n      right: 16rpx;\r\n      padding: 8rpx 14rpx;\r\n      border-radius: 999rpx;\r\n      background-color: rgba(255, 255, 255, 0.92);\r\n      backdrop-filter: blur(10px);\r\n      border: 1px solid rgba(15, 23, 42, 0.08);\r\n      box-shadow: 0 10rpx 24rpx rgba(15, 23, 42, 0.14);\r\n      .coord-text {\r\n        font-size: 20rpx;\r\n        color: #0f172a;\r\n        font-weight: 600;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.recommend-scroll {\r\n  width: 100%;\r\n  white-space: nowrap;\r\n  // 左侧保持与内容区对齐（40rpx），右侧拉满到屏幕边缘\r\n  margin-left: -40rpx;\r\n  margin-right: -40rpx;\r\n  padding-left: 40rpx;\r\n  padding-right: 0;\r\n  box-sizing: border-box;\r\n\r\n  .recommend-row {\r\n    display: inline-flex;\r\n    gap: 24rpx;\r\n    padding-bottom: 8rpx;\r\n  }\r\n\r\n  .recommend-card {\r\n    width: 320rpx;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 16rpx;\r\n\r\n    .rec-img-box {\r\n      width: 100%;\r\n      height: 192rpx;\r\n      border-radius: 16rpx;\r\n      overflow: hidden;\r\n      position: relative;\r\n      background-color: #f1f5f9;\r\n\r\n      .rec-image {\r\n        width: 100%;\r\n        height: 100%;\r\n      }\r\n      .rec-tag {\r\n        position: absolute;\r\n        bottom: 8rpx;\r\n        left: 8rpx;\r\n        background-color: rgba(0, 0, 0, 0.5);\r\n        backdrop-filter: blur(4rpx);\r\n        color: #ffffff;\r\n        font-size: 20rpx;\r\n        padding: 4rpx 12rpx;\r\n        border-radius: 8rpx;\r\n      }\r\n    }\r\n\r\n    .rec-info {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 4rpx;\r\n\r\n      .rec-title {\r\n        font-size: 28rpx;\r\n        font-weight: 500;\r\n        color: #0f172a;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n\r\n      .rec-meta {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n\r\n        .rec-desc {\r\n          font-size: 24rpx;\r\n          color: #94a3b8;\r\n        }\r\n        .rec-price {\r\n          font-size: 24rpx;\r\n          font-weight: bold;\r\n          color: #f97316;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.bottom-bar {\r\n  background-color: #ffffff;\r\n  border-top: 1rpx solid #f1f5f9;\r\n  padding: 16rpx 32rpx calc(env(safe-area-inset-bottom) + 16rpx);\r\n  box-shadow: 0 -10rpx 30rpx rgba(0, 0, 0, 0.05);\r\n\r\n  .bar-content {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 20rpx;\r\n    max-width: 960rpx;\r\n    margin: 0 auto;\r\n  }\r\n\r\n  .action-btns {\r\n    display: flex;\r\n    gap: 40rpx;\r\n    padding: 0 8rpx;\r\n  }\r\n\r\n  .action-item {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    gap: 4rpx;\r\n    color: #64748b;\r\n    min-width: 80rpx;\r\n\r\n    .bar-icon {\r\n      font-size: 44rpx;\r\n    }\r\n    .bar-text {\r\n      font-size: 20rpx;\r\n      font-weight: 500;\r\n      white-space: nowrap;\r\n    }\r\n\r\n    .filled {\r\n      font-variation-settings: \"FILL\" 1;\r\n    }\r\n\r\n    &:active {\r\n      color: #0f172a;\r\n    }\r\n  }\r\n\r\n  .bar-divider {\r\n    width: 1px;\r\n    height: 64rpx;\r\n    background-color: #f1f5f9;\r\n    margin: 0 8rpx;\r\n  }\r\n\r\n  .unlock-btn {\r\n    flex: 1;\r\n    height: 88rpx;\r\n    background-color: #2d9cf0;\r\n    color: #ffffff;\r\n    font-size: 30rpx;\r\n    font-weight: bold;\r\n    border-radius: 16rpx;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: 12rpx;\r\n    box-shadow: 0 8rpx 20rpx rgba(45, 156, 240, 0.3);\r\n    border: none;\r\n\r\n    &::after {\r\n      border: none;\r\n    }\r\n\r\n    .unlock-icon {\r\n      font-size: 36rpx;\r\n      font-variation-settings: \"FILL\" 1;\r\n    }\r\n\r\n    &:active {\r\n      background-color: #1d82cc;\r\n      transform: scale(0.98);\r\n    }\r\n  }\r\n}\r\n\r\n.bottom-spacer {\r\n  height: 64rpx;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'E:/Work/Progect/GoFly-admin/main-admin/web/wxapp/pages/property_detail/property_detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["_sfc_main","data","currentUserId","statusBarHeight","headerPadLeftPx","headerPadRightPx","headerOpacity","currentSwiper","isFollowed","hasSmartLock","images","mapLat","mapLng","label","value","renovationTabs","key","status","eta","finishAt","materials","name","size","image","onLoad","options","info","uni","getSystemInfoSync","this","wx","wx$1","getMenuButtonBoundingClientRect","w","Number","windowWidth","rpx2px","padLeftPx","rightSafePx","top","rect","height","circleBtnSizePx","Math","round","headerTop","e","id","ID","property_id","propertyId","ensureCanManageProperties","loadDetail","index$1","showToast","title","icon","computed","canEditThisProperty","canManageProperties","uid","agentId","showDownloadBtn","item","getCurrentBannerItem","downloadLabel","type","methods","getStorageSync","userStore","isLogin","ui","userInfo","u","__f__","can_manage_properties","goEdit","navigateTo","url","debugEditState","can","show","showModal","content","showCancel","t","getLayoutText","p","rooms","halls","bathrooms","s","getUnitPriceText","totalYuan","price","price_unit","per","isFinite","buildAttributes","totalFloors","total_floors","orientation","year","build_year","property_type","getCommissionText","hasReward","reward","String","trim","addr","property","address","loading","res","reLaunch","setTimeout","navigateBack","current_user","is_followed","videoUrl","video_url","imgs","Array","isArray","length","forEach","items","push","src","lat","lng","mapMarkers","latitude","longitude","width","attributes","statusRaw","renovation","progress","r","progress_percentage","stage","current_stage","note","notes","recommends","rec","map","it","area","onPageScroll","next","min","st","max","toFixed","goBack","redirectTo","encodeURIComponent","swiperChange","detail","current","Promise","resolve","reject","getSetting","success","authorize","scope","fail","confirmText","openSetting","ensureAlbumPermission","showLoading","downloadFile","fp","hideLoading","complete","showActionSheet","itemList","tapIndex","setClipboardData","openMap","openLocation","toggleFollow","follow_count","ownerPhone","makePhoneCall","ss","sale_status","sale_status_label","createPage","MiniProgramPage"],"mappings":"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"}