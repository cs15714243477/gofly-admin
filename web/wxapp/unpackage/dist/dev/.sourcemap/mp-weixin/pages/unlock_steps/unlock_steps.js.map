{"version":3,"file":"unlock_steps.js","sources":["pages/unlock_steps/unlock_steps.vue","D:/WinApp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdW5sb2NrX3N0ZXBzL3VubG9ja19zdGVwcy52dWU"],"sourcesContent":["<template>\n  <view class=\"steps-container\">\n    <TopHeader title=\"开锁步骤\">\n      <template #left>\n        <view class=\"th-btn\" @click=\"goBack\">\n          <text class=\"material-symbols-outlined\">arrow_back_ios_new</text>\n        </view>\n      </template>\n    </TopHeader>\n\n    <view class=\"main-content\">\n      <view class=\"tip-card\">\n        <text class=\"material-symbols-outlined tip-icon\">near_me</text>\n        <text class=\"tip-text\">请站在门锁 1-2 米内，并保持蓝牙开启。</text>\n      </view>\n\n      <view class=\"ble-card\">\n        <view class=\"ble-head\">\n          <view class=\"ble-left\">\n            <text class=\"material-symbols-outlined ble-ico\">bluetooth</text>\n            <text class=\"ble-title\">蓝牙状态</text>\n          </view>\n          <view class=\"ble-badge\" :class=\"bleBadgeClass\">\n            <text>{{ bleBadgeText }}</text>\n          </view>\n        </view>\n\n        <view class=\"status-tag\" :class=\"statusTagClass\">\n          <view class=\"dot-box\">\n            <view class=\"dot-ping\"></view>\n            <view class=\"dot-inner\"></view>\n          </view>\n          <text class=\"status-text\">{{ statusText }}</text>\n        </view>\n\n        <view class=\"ble-grid\">\n          <view class=\"ble-item\">\n            <text class=\"ble-lab\">初始化</text>\n            <text class=\"ble-val\" :class=\"bleInitClass\">{{ bleInitText }}</text>\n          </view>\n          <view class=\"ble-item\">\n            <text class=\"ble-lab\">可用</text>\n            <text class=\"ble-val\">{{ ble.available ? \"是\" : \"否\" }}</text>\n          </view>\n          <view class=\"ble-item\">\n            <text class=\"ble-lab\">搜索中</text>\n            <text class=\"ble-val\">{{ ble.discovering ? \"是\" : \"否\" }}</text>\n          </view>\n          <view class=\"ble-item\">\n            <text class=\"ble-lab\">连接</text>\n            <text class=\"ble-val\">{{ bleConnectText }}</text>\n          </view>\n        </view>\n\n        <view v-if=\"ble.deviceId\" class=\"ble-extra\">\n          <text class=\"ble-extra-lab\">设备</text>\n          <text class=\"ble-extra-val\">{{ ble.deviceId }}</text>\n        </view>\n\n        <view v-if=\"ble.errorMsg\" class=\"ble-error\">\n          <text class=\"material-symbols-outlined err-ico\">error</text>\n          <text class=\"err-text\">{{ ble.errorMsg }}</text>\n        </view>\n\n        <view class=\"ble-log\">\n          <view class=\"ble-log-head\">\n            <text class=\"ble-log-title\">最近日志</text>\n            <text class=\"ble-log-tip\"\n              >{{ latestBleLogs.length }}/{{ bleLogMax }}</text\n            >\n          </view>\n          <view class=\"ble-log-body\">\n            <view\n              v-for=\"(it, idx) in latestBleLogs\"\n              :key=\"idx\"\n              class=\"ble-log-line\"\n            >\n              <text class=\"ble-log-time\">{{ it.time }}</text>\n              <text class=\"ble-log-msg\" :class=\"it.level\">{{ it.msg }}</text>\n            </view>\n            <view v-if=\"!latestBleLogs.length\" class=\"ble-log-empty\"\n              >暂无日志</view\n            >\n          </view>\n        </view>\n      </view>\n\n      <view class=\"steps-section\">\n        <view class=\"steps-title\">开锁流程</view>\n        <view class=\"steps-grid\">\n          <view class=\"step-card\">\n            <view class=\"step-icon-box primary\">\n              <text class=\"material-symbols-outlined\">bluetooth</text>\n            </view>\n            <text class=\"step-index\">步骤 1</text>\n            <text class=\"step-title\">打开蓝牙</text>\n            <text class=\"step-desc\">确认系统蓝牙已开启</text>\n          </view>\n          <view class=\"step-card\">\n            <view class=\"step-icon-box accent\">\n              <text class=\"material-symbols-outlined\">touch_app</text>\n            </view>\n            <text class=\"step-index\">步骤 2</text>\n            <text class=\"step-title\">唤醒门锁</text>\n            <text class=\"step-desc\">触碰门锁点亮数字面板</text>\n          </view>\n          <view class=\"step-card\">\n            <view class=\"step-icon-box primary\">\n              <text class=\"material-symbols-outlined\">phonelink_lock</text>\n            </view>\n            <text class=\"step-index\">步骤 3</text>\n            <text class=\"step-title\">点击开锁</text>\n            <text class=\"step-desc\">点击下方蓝牙开锁按钮</text>\n          </view>\n        </view>\n      </view>\n\n      <view class=\"action-panel\">\n        <button class=\"bluetooth-btn\" @click=\"bluetoothUnlock\">\n          <text class=\"material-symbols-outlined bt-icon pulse\"\n            >bluetooth_connected</text\n          >\n          <text>蓝牙开锁</text>\n        </button>\n\n        <button class=\"password-btn\" @click=\"passwordUnlock\">\n          <text class=\"material-symbols-outlined btn-icon\">lock_open</text>\n          <text>密码开锁</text>\n        </button>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport TopHeader from \"@/components/TopHeader.vue\";\nimport ttlockApi from \"@/api/ttlock\";\n\nfunction pad2(n) {\n  return String(n).padStart(2, \"0\");\n}\n\nexport default {\n  components: { TopHeader },\n  data() {\n    return {\n      propertyId: 0,\n      unlocking: false,\n      unlockRequestId: 0,\n      ble: {\n        supported: true,\n        initStatus: \"idle\", // idle/initting/ready/failed/unsupported\n        available: false,\n        discovering: false,\n        connected: false,\n        deviceId: \"\",\n        errorMsg: \"\",\n      },\n      bleLogs: [],\n      bleLogMax: 50,\n      _bleListening: false,\n      _lastBleStateKey: \"\",\n      _lastConnKey: \"\",\n    };\n  },\n  computed: {\n    bleInitText() {\n      if (!this.ble.supported) return \"不支持\";\n      switch (this.ble.initStatus) {\n        case \"initting\":\n          return \"初始化中\";\n        case \"ready\":\n          return \"已就绪\";\n        case \"failed\":\n          return \"失败\";\n        case \"unsupported\":\n          return \"不支持\";\n        default:\n          return \"未初始化\";\n      }\n    },\n    bleInitClass() {\n      if (this.ble.initStatus === \"ready\") return \"ok\";\n      if (this.ble.initStatus === \"failed\") return \"warn\";\n      if (this.ble.initStatus === \"initting\") return \"loading\";\n      return \"muted\";\n    },\n    bleBadgeText() {\n      if (!this.ble.supported || this.ble.initStatus === \"unsupported\")\n        return \"当前平台不支持\";\n      if (this.ble.initStatus === \"failed\") return \"蓝牙不可用\";\n      if (this.ble.available) return \"可用\";\n      return \"未开启/不可用\";\n    },\n    bleBadgeClass() {\n      if (!this.ble.supported || this.ble.initStatus === \"unsupported\")\n        return \"muted\";\n      if (this.ble.initStatus === \"failed\") return \"warn\";\n      if (this.ble.available) return \"ok\";\n      return \"warn\";\n    },\n    bleConnectText() {\n      if (this.ble.connected) return \"已连接\";\n      if (this.unlocking) return \"连接中\";\n      return \"未连接\";\n    },\n    statusText() {\n      if (!this.ble.supported || this.ble.initStatus === \"unsupported\")\n        return \"当前平台不支持蓝牙能力\";\n      if (this.ble.initStatus === \"initting\") return \"正在初始化蓝牙…\";\n      if (this.ble.initStatus === \"failed\")\n        return this.ble.errorMsg\n          ? `蓝牙初始化失败：${this.ble.errorMsg}`\n          : \"蓝牙初始化失败\";\n      if (!this.ble.available) return \"请开启手机蓝牙后重试\";\n      if (this.unlocking) return \"正在连接并开锁…\";\n      if (this.ble.connected) return \"设备已连接\";\n      return \"蓝牙就绪，等待连接\";\n    },\n    statusTagClass() {\n      if (!this.ble.supported || this.ble.initStatus === \"unsupported\")\n        return \"muted\";\n      if (this.ble.initStatus === \"failed\" || !this.ble.available)\n        return \"warn\";\n      if (this.unlocking || this.ble.initStatus === \"initting\")\n        return \"loading\";\n      return \"ok\";\n    },\n    latestBleLogs() {\n      return this.bleLogs.slice(-3);\n    },\n  },\n  onLoad(options) {\n    const pid = Number((options && (options.property_id || options.id)) || 0);\n    this.propertyId = Number.isFinite(pid) ? pid : 0;\n  },\n  onShow() {\n    this.appendBleLog(\"info\", \"进入页面，开始检测蓝牙状态\");\n    this.initBluetooth();\n  },\n  onHide() {\n    this.cleanupBluetooth();\n  },\n  onUnload() {\n    this.cleanupBluetooth();\n  },\n  methods: {\n    goBack() {\n      uni.navigateBack();\n    },\n    appendBleLog(level, msg) {\n      const d = new Date();\n      const time = `${pad2(d.getHours())}:${pad2(d.getMinutes())}:${pad2(\n        d.getSeconds()\n      )}`;\n      this.bleLogs.push({\n        time,\n        msg: String(msg || \"\"),\n        level: level || \"info\",\n      });\n      if (this.bleLogs.length > this.bleLogMax) {\n        this.bleLogs.splice(0, this.bleLogs.length - this.bleLogMax);\n      }\n    },\n    formatBleErr(err) {\n      if (!err) return \"\";\n      const code = Number(err.errCode || err.code || 0);\n      const raw = String(err.errMsg || err.message || \"\").trim();\n      if (code === 10001) return \"蓝牙适配器不可用（请开启手机蓝牙）\";\n      if (code === 10002) return \"没有找到指定设备\";\n      if (code === 10003) return \"连接失败\";\n      if (code === 10004) return \"没有找到指定服务\";\n      if (code === 10005) return \"没有找到指定特征值\";\n      if (code === 10006) return \"当前连接已断开\";\n      if (code === 10007) return \"当前特征值不支持该操作\";\n      if (code === 10008) return \"其余所有系统上报的异常\";\n      if (code === 10009) return \"系统版本低于 4.3 不支持 BLE\";\n      if (code === 10010) return \"系统版本低于 4.4 不支持 BLE\";\n      if (code === 10011) return \"需要授权蓝牙权限\";\n      if (raw) return raw;\n      if (code) return `蓝牙异常（错误码：${code}）`;\n      try {\n        return JSON.stringify(err);\n      } catch (e) {}\n      return \"蓝牙异常\";\n    },\n    async reportUnlockActivity(stage, meta) {\n      if (!this.propertyId) return;\n      if (!ttlockApi || typeof ttlockApi.logUnlockActivity !== \"function\")\n        return;\n      try {\n        await ttlockApi.logUnlockActivity({\n          property_id: this.propertyId,\n          stage,\n          page: \"unlock_steps\",\n          meta: meta || {},\n        });\n      } catch (e) {}\n    },\n    async initBluetooth() {\n      // #ifndef MP-WEIXIN\n      this.ble.supported = false;\n      this.ble.initStatus = \"unsupported\";\n      this.ble.available = false;\n      this.ble.discovering = false;\n      this.ble.connected = false;\n      this.ble.deviceId = \"\";\n      this.ble.errorMsg = \"\";\n      this.appendBleLog(\"warn\", \"当前平台仅支持微信小程序蓝牙能力\");\n      return;\n      // #endif\n\n      // #ifdef MP-WEIXIN\n      if (this.ble.initStatus === \"initting\" || this.ble.initStatus === \"ready\")\n        return;\n      this.ble.supported = true;\n      this.ble.initStatus = \"initting\";\n      this.ble.errorMsg = \"\";\n      this.appendBleLog(\"info\", \"开始初始化蓝牙适配器\");\n      this.reportUnlockActivity(\"ble_init_start\", {});\n\n      try {\n        await new Promise((resolve, reject) => {\n          uni.openBluetoothAdapter({\n            success: resolve,\n            fail: reject,\n          });\n        });\n        this.ble.initStatus = \"ready\";\n        this.appendBleLog(\"success\", \"蓝牙适配器初始化成功\");\n        await this.refreshBluetoothState();\n        this.bindBluetoothListeners();\n        this.reportUnlockActivity(\"ble_init_ok\", {\n          available: this.ble.available,\n          discovering: this.ble.discovering,\n        });\n      } catch (e) {\n        this.ble.initStatus = \"failed\";\n        this.ble.errorMsg = this.formatBleErr(e);\n        this.appendBleLog(\n          \"error\",\n          `蓝牙初始化失败：${this.ble.errorMsg || \"未知错误\"}`\n        );\n        this.reportUnlockActivity(\"ble_init_fail\", {\n          err_code: Number((e && (e.errCode || e.code)) || 0),\n          err_msg: this.formatBleErr(e),\n        });\n      }\n      // #endif\n    },\n    async refreshBluetoothState() {\n      // #ifdef MP-WEIXIN\n      try {\n        const st = await new Promise((resolve, reject) => {\n          uni.getBluetoothAdapterState({\n            success: resolve,\n            fail: reject,\n          });\n        });\n        this.ble.available = !!st.available;\n        this.ble.discovering = !!st.discovering;\n        const key = `${this.ble.available}_${this.ble.discovering}`;\n        this._lastBleStateKey = key;\n        this.appendBleLog(\n          \"info\",\n          `蓝牙状态：${this.ble.available ? \"可用\" : \"不可用\"}${\n            this.ble.discovering ? \"，搜索中\" : \"\"\n          }`\n        );\n      } catch (e) {\n        this.appendBleLog(\"warn\", `获取蓝牙状态失败：${this.formatBleErr(e)}`);\n      }\n      // #endif\n    },\n    bindBluetoothListeners() {\n      // #ifdef MP-WEIXIN\n      if (this._bleListening) return;\n      this._bleListening = true;\n\n      try {\n        uni.onBluetoothAdapterStateChange((res) => {\n          this.ble.available = !!res.available;\n          this.ble.discovering = !!res.discovering;\n          const key = `${this.ble.available}_${this.ble.discovering}`;\n          if (key === this._lastBleStateKey) return;\n          this._lastBleStateKey = key;\n          this.appendBleLog(\n            \"info\",\n            `蓝牙状态变化：${this.ble.available ? \"可用\" : \"不可用\"}${\n              this.ble.discovering ? \"，搜索中\" : \"\"\n            }`\n          );\n          this.reportUnlockActivity(\"ble_state_change\", {\n            available: this.ble.available,\n            discovering: this.ble.discovering,\n          });\n        });\n      } catch (e) {}\n\n      try {\n        uni.onBLEConnectionStateChange((res) => {\n          this.ble.connected = !!res.connected;\n          if (res && res.deviceId) this.ble.deviceId = res.deviceId;\n          const key = `${this.ble.connected}_${this.ble.deviceId || \"\"}`;\n          if (key === this._lastConnKey) return;\n          this._lastConnKey = key;\n          this.appendBleLog(\n            this.ble.connected ? \"success\" : \"warn\",\n            `连接状态：${this.ble.connected ? \"已连接\" : \"已断开\"}${\n              this.ble.deviceId ? `，设备 ${this.ble.deviceId}` : \"\"\n            }`\n          );\n          this.reportUnlockActivity(\"ble_conn_change\", {\n            connected: this.ble.connected,\n            deviceId: this.ble.deviceId,\n          });\n        });\n      } catch (e) {}\n      // #endif\n    },\n    unbindBluetoothListeners() {\n      // #ifdef MP-WEIXIN\n      if (!this._bleListening) return;\n      this._bleListening = false;\n      try {\n        uni.offBluetoothAdapterStateChange();\n      } catch (e) {}\n      try {\n        uni.offBLEConnectionStateChange();\n      } catch (e) {}\n      // #endif\n    },\n    cleanupBluetooth() {\n      // #ifdef MP-WEIXIN\n      this.unbindBluetoothListeners();\n      try {\n        uni.closeBluetoothAdapter({});\n      } catch (e) {}\n      // #endif\n    },\n    async bluetoothUnlock() {\n      if (this.unlocking) return;\n      if (!this.propertyId) {\n        uni.showToast({ title: \"缺少房源ID，无法开锁\", icon: \"none\" });\n        return;\n      }\n\n      // #ifndef MP-WEIXIN\n      this.appendBleLog(\"warn\", \"仅支持微信小程序蓝牙开锁\");\n      uni.showToast({ title: \"仅支持微信小程序蓝牙开锁\", icon: \"none\" });\n      return;\n      // #endif\n\n      // #ifdef MP-WEIXIN\n      this.unlocking = true;\n      let plugin = null;\n      let requestId = 0;\n      let finishSuccess = false;\n      let finishErrCode = 0;\n      let finishErrMsg = \"\";\n      let pluginOut = null;\n      try {\n        this.appendBleLog(\"info\", \"用户点击蓝牙开锁\");\n        await this.initBluetooth();\n        if (\n          this.ble.initStatus === \"failed\" ||\n          this.ble.initStatus === \"unsupported\"\n        ) {\n          finishErrMsg = this.ble.errorMsg || \"蓝牙不可用，请开启后重试\";\n          throw new Error(finishErrMsg);\n        }\n\n        // eslint-disable-next-line no-undef\n        plugin = requirePlugin(\"ttlock-plugin\");\n        if (!plugin || typeof plugin.controlLock !== \"function\") {\n          finishErrMsg = \"未检测到通通锁插件，请检查小程序插件配置\";\n          throw new Error(finishErrMsg);\n        }\n\n        const startRes = await ttlockApi.bleUnlockStart({\n          property_id: this.propertyId,\n          meta: {\n            page: \"unlock_steps\",\n            ble: {\n              available: this.ble.available,\n              connected: this.ble.connected,\n              deviceId: this.ble.deviceId,\n            },\n          },\n        });\n        requestId =\n          Number(startRes && startRes.data && startRes.data.request_id) || 0;\n        if (!requestId) {\n          finishErrMsg =\n            startRes && startRes.message\n              ? startRes.message\n              : \"创建开锁记录失败\";\n          throw new Error(finishErrMsg);\n        }\n        this.unlockRequestId = requestId;\n        this.appendBleLog(\"info\", `已创建开锁记录：#${requestId}`);\n\n        this.appendBleLog(\"info\", \"正在获取开锁数据\");\n        const res = await ttlockApi.getPropertyBleInfo({\n          property_id: this.propertyId,\n        });\n        if (!res || res.code !== 0) {\n          finishErrMsg = res && res.message ? res.message : \"获取开锁数据失败\";\n          throw new Error(finishErrMsg);\n        }\n        const data = res.data || {};\n        const lockData = String(data.key_data || data.lock_data || \"\").trim();\n        if (!lockData) {\n          finishErrMsg = \"缺少开锁数据，请先同步钥匙信息\";\n          throw new Error(finishErrMsg);\n        }\n\n        uni.showLoading({ title: \"蓝牙开锁中\", mask: true });\n        this.appendBleLog(\"info\", \"开始调用蓝牙插件开锁（连接中）\");\n        pluginOut = await plugin.controlLock({\n          controlAction: 3,\n          lockData,\n          serverTime: Date.now(),\n        });\n        uni.hideLoading();\n\n        if (pluginOut && Number(pluginOut.errorCode) === 0) {\n          finishSuccess = true;\n          finishErrCode = 0;\n          finishErrMsg = \"\";\n          this.appendBleLog(\"success\", \"开锁成功\");\n          uni.showToast({ title: \"开锁成功\", icon: \"success\" });\n        } else {\n          finishSuccess = false;\n          finishErrCode = Number(pluginOut && pluginOut.errorCode) || 0;\n          const msg =\n            (pluginOut &&\n              (pluginOut.errorMsg ||\n                pluginOut.errMsg ||\n                pluginOut.description)) ||\n            \"开锁失败，请重试\";\n          finishErrMsg = msg;\n          this.appendBleLog(\"error\", `开锁失败：${msg}`);\n          uni.showToast({ title: msg, icon: \"none\" });\n        }\n      } catch (e) {\n        try {\n          uni.hideLoading();\n        } catch (err) {}\n        const msg = e && e.message ? e.message : \"开锁失败，请稍后重试\";\n        if (!finishErrMsg) finishErrMsg = msg;\n        this.appendBleLog(\"error\", msg);\n        uni.showToast({ title: msg, icon: \"none\" });\n      } finally {\n        if (requestId > 0) {\n          try {\n            await ttlockApi.bleUnlockFinish({\n              property_id: this.propertyId,\n              request_id: requestId,\n              success: finishSuccess ? 1 : 0,\n              err_code: finishSuccess ? 0 : finishErrCode,\n              err_msg: finishSuccess ? \"\" : finishErrMsg,\n              meta: {\n                page: \"unlock_steps\",\n                ble: {\n                  available: this.ble.available,\n                  connected: this.ble.connected,\n                  deviceId: this.ble.deviceId,\n                },\n                plugin: pluginOut\n                  ? {\n                      errorCode: pluginOut.errorCode,\n                      errorMsg:\n                        pluginOut.errorMsg ||\n                        pluginOut.errMsg ||\n                        pluginOut.description ||\n                        \"\",\n                    }\n                  : null,\n              },\n            });\n          } catch (e) {\n            this.appendBleLog(\"warn\", \"写入开锁结果日志失败（不影响开锁结果）\");\n          }\n        }\n        try {\n          if (plugin && typeof plugin.stopAllOperations === \"function\") {\n            await plugin.stopAllOperations();\n          }\n        } catch (e) {}\n        this.unlocking = false;\n      }\n      // #endif\n    },\n    passwordUnlock() {\n      uni.navigateTo({\n        url: `/pages/unlock_details/unlock_details?property_id=${encodeURIComponent(\n          this.propertyId\n        )}`,\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.steps-container {\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  background: linear-gradient(180deg, #f3f9ff 0%, #f8fafc 45%, #ffffff 100%);\n}\n\n.th-btn {\n  width: 80rpx;\n  height: 80rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  color: #0f172a;\n  background: transparent;\n\n  .material-symbols-outlined {\n    font-size: 32rpx;\n  }\n\n  &:active {\n    background: rgba(15, 23, 42, 0.06);\n  }\n}\n\n.main-content {\n  flex: 1;\n  min-height: 0;\n  padding: 16rpx 20rpx calc(env(safe-area-inset-bottom) + 20rpx);\n  display: flex;\n  flex-direction: column;\n  gap: 14rpx;\n  overflow: hidden;\n}\n\n.tip-card {\n  padding: 16rpx 18rpx;\n  display: flex;\n  align-items: center;\n  gap: 12rpx;\n  background: #eff6ff;\n  border: 1px solid #dbeafe;\n  border-radius: 18rpx;\n\n  .tip-icon {\n    font-size: 30rpx;\n    color: #2563eb;\n  }\n\n  .tip-text {\n    flex: 1;\n    min-width: 0;\n    font-size: 24rpx;\n    line-height: 1.4;\n    font-weight: 600;\n    color: #334155;\n  }\n}\n\n.ble-card {\n  padding: 18rpx;\n  border-radius: 20rpx;\n  background: #ffffff;\n  border: 1px solid #e2e8f0;\n  box-shadow: 0 8rpx 24rpx rgba(15, 23, 42, 0.05);\n  display: flex;\n  flex-direction: column;\n  gap: 12rpx;\n}\n\n.ble-head {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 12rpx;\n}\n\n.ble-left {\n  display: flex;\n  align-items: center;\n  gap: 10rpx;\n}\n\n.ble-ico {\n  font-size: 30rpx;\n  color: #2d9cf0;\n}\n\n.ble-title {\n  font-size: 26rpx;\n  font-weight: 800;\n  color: #0f172a;\n}\n\n.ble-badge {\n  padding: 6rpx 14rpx;\n  border-radius: 999rpx;\n  font-size: 20rpx;\n  font-weight: 700;\n  border: 1px solid transparent;\n\n  &.ok {\n    background-color: #ecfdf5;\n    color: #065f46;\n    border-color: #d1fae5;\n  }\n\n  &.warn {\n    background-color: #fff7ed;\n    color: #9a3412;\n    border-color: #fed7aa;\n  }\n\n  &.muted {\n    background-color: #f8fafc;\n    color: #64748b;\n    border-color: #e2e8f0;\n  }\n}\n\n.status-tag {\n  display: flex;\n  align-items: center;\n  gap: 12rpx;\n  padding: 12rpx 14rpx;\n  border-radius: 14rpx;\n  border: 1px solid transparent;\n  min-height: 64rpx;\n\n  &.ok {\n    background-color: #ecfdf5;\n    border-color: #d1fae5;\n  }\n\n  &.warn {\n    background-color: #fff7ed;\n    border-color: #fed7aa;\n  }\n\n  &.loading {\n    background-color: #eff6ff;\n    border-color: #bfdbfe;\n  }\n\n  &.muted {\n    background-color: #f8fafc;\n    border-color: #e2e8f0;\n  }\n}\n\n.dot-box {\n  width: 18rpx;\n  height: 18rpx;\n  position: relative;\n  flex-shrink: 0;\n}\n\n.dot-ping {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: #10b981;\n  border-radius: 50%;\n  animation: ping 1.5s cubic-bezier(0, 0, 0.2, 1) infinite;\n}\n\n.dot-inner {\n  width: 100%;\n  height: 100%;\n  background-color: #10b981;\n  border-radius: 50%;\n  position: relative;\n  z-index: 10;\n}\n\n.status-tag.warn .dot-ping,\n.status-tag.warn .dot-inner {\n  background-color: #f97316;\n}\n\n.status-tag.loading .dot-ping,\n.status-tag.loading .dot-inner {\n  background-color: #2d9cf0;\n}\n\n.status-tag.muted .dot-ping,\n.status-tag.muted .dot-inner {\n  background-color: #94a3b8;\n}\n\n.status-text {\n  flex: 1;\n  min-width: 0;\n  font-size: 22rpx;\n  line-height: 1.35;\n  font-weight: 600;\n  color: #334155;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 2;\n  overflow: hidden;\n}\n\n.ble-grid {\n  display: grid;\n  grid-template-columns: repeat(4, minmax(0, 1fr));\n  gap: 10rpx;\n}\n\n.ble-item {\n  padding: 10rpx;\n  border-radius: 12rpx;\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  display: flex;\n  flex-direction: column;\n  gap: 4rpx;\n  align-items: center;\n  justify-content: center;\n}\n\n.ble-lab {\n  font-size: 18rpx;\n  color: #94a3b8;\n  font-weight: 700;\n}\n\n.ble-val {\n  font-size: 22rpx;\n  color: #334155;\n  font-weight: 800;\n}\n\n.ble-val.ok {\n  color: #16a34a;\n}\n\n.ble-val.warn {\n  color: #f97316;\n}\n\n.ble-val.loading {\n  color: #2d9cf0;\n}\n\n.ble-val.muted {\n  color: #64748b;\n}\n\n.ble-extra {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 12rpx;\n  padding: 10rpx 12rpx;\n  border-radius: 12rpx;\n  background: #f8fafc;\n}\n\n.ble-extra-lab {\n  font-size: 20rpx;\n  color: #64748b;\n  font-weight: 700;\n}\n\n.ble-extra-val {\n  flex: 1;\n  min-width: 0;\n  text-align: right;\n  font-size: 20rpx;\n  color: #1e293b;\n  font-weight: 700;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.ble-error {\n  display: flex;\n  align-items: flex-start;\n  gap: 10rpx;\n  padding: 12rpx;\n  border-radius: 12rpx;\n  border: 1px solid #fecaca;\n  background: #fef2f2;\n}\n\n.err-ico {\n  font-size: 24rpx;\n  color: #dc2626;\n}\n\n.err-text {\n  flex: 1;\n  min-width: 0;\n  font-size: 20rpx;\n  line-height: 1.35;\n  color: #b91c1c;\n  font-weight: 700;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 2;\n  overflow: hidden;\n}\n\n.ble-log {\n  border-radius: 14rpx;\n  border: 1px solid #e2e8f0;\n  background: #f8fafc;\n  overflow: hidden;\n}\n\n.ble-log-head {\n  padding: 10rpx 12rpx;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.ble-log-title {\n  font-size: 20rpx;\n  font-weight: 800;\n  color: #0f172a;\n}\n\n.ble-log-tip {\n  font-size: 18rpx;\n  color: #94a3b8;\n  font-weight: 700;\n}\n\n.ble-log-body {\n  padding: 8rpx 12rpx 10rpx;\n}\n\n.ble-log-line {\n  display: flex;\n  gap: 8rpx;\n  padding: 4rpx 0;\n}\n\n.ble-log-time {\n  width: 94rpx;\n  flex-shrink: 0;\n  font-size: 18rpx;\n  color: #94a3b8;\n}\n\n.ble-log-msg {\n  flex: 1;\n  min-width: 0;\n  font-size: 18rpx;\n  color: #334155;\n  font-weight: 600;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.ble-log-msg.success {\n  color: #16a34a;\n}\n\n.ble-log-msg.warn {\n  color: #f97316;\n}\n\n.ble-log-msg.error {\n  color: #ef4444;\n}\n\n.ble-log-empty {\n  font-size: 18rpx;\n  color: #94a3b8;\n  padding: 4rpx 0;\n}\n\n.steps-section {\n  padding: 14rpx;\n  border-radius: 18rpx;\n  background: #ffffff;\n  border: 1px solid #e2e8f0;\n  box-shadow: 0 6rpx 20rpx rgba(15, 23, 42, 0.04);\n}\n\n.steps-title {\n  font-size: 22rpx;\n  font-weight: 800;\n  color: #0f172a;\n  margin-bottom: 12rpx;\n}\n\n.steps-grid {\n  display: flex;\n  gap: 10rpx;\n}\n\n.step-card {\n  flex: 1;\n  min-width: 0;\n  padding: 12rpx 8rpx;\n  border-radius: 14rpx;\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  gap: 6rpx;\n}\n\n.step-icon-box {\n  width: 48rpx;\n  height: 48rpx;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 2rpx solid transparent;\n\n  &.primary {\n    border-color: #2d9cf0;\n    color: #2d9cf0;\n  }\n\n  &.accent {\n    border-color: #f97316;\n    color: #f97316;\n  }\n\n  .material-symbols-outlined {\n    font-size: 28rpx;\n  }\n}\n\n.step-index {\n  font-size: 18rpx;\n  color: #64748b;\n  font-weight: 700;\n}\n\n.step-title {\n  font-size: 22rpx;\n  color: #0f172a;\n  font-weight: 800;\n}\n\n.step-desc {\n  font-size: 18rpx;\n  color: #64748b;\n  line-height: 1.35;\n}\n\n.action-panel {\n  margin-top: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 12rpx;\n}\n\n.bluetooth-btn {\n  height: 84rpx;\n  background: linear-gradient(135deg, #2d9cf0 0%, #1777d7 100%);\n  color: #ffffff;\n  border-radius: 20rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 12rpx;\n  font-size: 30rpx;\n  font-weight: 800;\n  border: none;\n  box-shadow: 0 8rpx 24rpx rgba(37, 99, 235, 0.28);\n\n  &::after {\n    border: none;\n  }\n\n  &:active {\n    transform: scale(0.98);\n  }\n}\n\n.bt-icon {\n  font-size: 36rpx;\n}\n\n.password-btn {\n  height: 84rpx;\n  background: #f8fafc;\n  border: 1px solid #cbd5e1;\n  border-radius: 20rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 12rpx;\n  color: #334155;\n  font-size: 28rpx;\n  font-weight: 800;\n\n  &::after {\n    border: none;\n  }\n\n  &:active {\n    transform: scale(0.98);\n    background: #f1f5f9;\n  }\n}\n\n.btn-icon {\n  font-size: 34rpx;\n}\n\n@media screen and (max-height: 700px) {\n  .main-content {\n    gap: 10rpx;\n    padding-top: 10rpx;\n  }\n\n  .tip-card {\n    padding: 12rpx 14rpx;\n  }\n\n  .ble-card {\n    padding: 14rpx;\n    gap: 10rpx;\n  }\n\n  .ble-log {\n    display: none;\n  }\n\n  .steps-section {\n    padding: 10rpx;\n  }\n\n  .step-card {\n    padding: 10rpx 6rpx;\n    gap: 4rpx;\n  }\n\n  .bluetooth-btn {\n    height: 76rpx;\n  }\n\n  .password-btn {\n    height: 64rpx;\n  }\n}\n\n@keyframes ping {\n  0% {\n    transform: scale(1);\n    opacity: 1;\n  }\n\n  75%,\n  100% {\n    transform: scale(2.5);\n    opacity: 0;\n  }\n}\n\n.pulse {\n  animation: pulse-icon 2s infinite;\n}\n\n@keyframes pulse-icon {\n  0%,\n  100% {\n    opacity: 1;\n    transform: scale(1);\n  }\n\n  50% {\n    opacity: 0.8;\n    transform: scale(1.08);\n  }\n}\n</style>\n","import MiniProgramPage from 'E:/Work/Progect/GoFly-admin/main-admin/web/wxapp/pages/unlock_steps/unlock_steps.vue'\nwx.createPage(MiniProgramPage)"],"names":["pad2","n","String","padStart","_sfc_main","components","TopHeader","data","propertyId","unlocking","unlockRequestId","ble","supported","initStatus","available","discovering","connected","deviceId","errorMsg","bleLogs","bleLogMax","_bleListening","_lastBleStateKey","_lastConnKey","computed","bleInitText","this","bleInitClass","bleBadgeText","bleBadgeClass","bleConnectText","statusText","statusTagClass","latestBleLogs","slice","onLoad","options","pid","Number","property_id","id","isFinite","onShow","appendBleLog","initBluetooth","onHide","cleanupBluetooth","onUnload","methods","goBack","uni","index$1","navigateBack","level","msg","d","Date","time","getHours","getMinutes","getSeconds","push","length","splice","formatBleErr","err","code","errCode","raw","errMsg","message","trim","JSON","stringify","e","reportUnlockActivity","stage","meta","ttlockApi","logUnlockActivity","page","Promise","resolve","reject","openBluetoothAdapter","success","fail","refreshBluetoothState","bindBluetoothListeners","err_code","err_msg","st","getBluetoothAdapterState","key","onBluetoothAdapterStateChange","res","onBLEConnectionStateChange","unbindBluetoothListeners","offBluetoothAdapterStateChange","offBLEConnectionStateChange","closeBluetoothAdapter","bluetoothUnlock","showToast","title","icon","plugin","requestId","finishSuccess","finishErrCode","finishErrMsg","pluginOut","Error","requirePlugin","controlLock","startRes","bleUnlockStart","request_id","getPropertyBleInfo","lockData","key_data","lock_data","showLoading","mask","controlAction","serverTime","now","hideLoading","errorCode","description","bleUnlockFinish","stopAllOperations","passwordUnlock","navigateTo","url","encodeURIComponent","wx","createPage","MiniProgramPage"],"mappings":"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"}