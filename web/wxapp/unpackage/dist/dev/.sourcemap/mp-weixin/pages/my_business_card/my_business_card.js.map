{"version":3,"file":"my_business_card.js","sources":["pages/my_business_card/my_business_card.vue","D:/WinApp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXlfYnVzaW5lc3NfY2FyZC9teV9idXNpbmVzc19jYXJkLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"card-container\">\n\t\t<!-- 顶部导航 -->\n\t\t<TopHeader title=\"获客\" />\n\n\t\t<!-- 选项卡切换 -->\n\t\t<view class=\"tabs-box\">\n\t\t\t<view class=\"tabs-inner\">\n\t\t\t\t<view class=\"tab-item\" :class=\"{ active: currentTab === 0 }\" @click=\"currentTab = 0\">名片预览</view>\n\t\t\t\t<view class=\"tab-item\" :class=\"{ active: currentTab === 1 }\" @click=\"currentTab = 1\">编辑资料</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<view class=\"main-content\">\n\t\t\t<!-- 名片预览内容 -->\n\t\t\t<view v-if=\"currentTab === 0\" class=\"preview-content\">\n\t\t\t\t<view class=\"pagination-dots\">\n\t\t\t\t\t<view\n\t\t\t\t\t\tv-for=\"(_, i) in previewCards\"\n\t\t\t\t\t\t:key=\"i\"\n\t\t\t\t\t\tclass=\"dot\"\n\t\t\t\t\t\t:class=\"{ active: currentPreview === i }\"\n\t\t\t\t\t></view>\n\t\t\t\t</view>\n\n\t\t\t\t<swiper class=\"card-swiper\" circular :indicator-dots=\"false\" :current=\"currentPreview\" @change=\"onPreviewChange\">\n\t\t\t\t\t<swiper-item v-for=\"(c, idx) in previewCards\" :key=\"idx\">\n\t\t\t\t\t\t<view class=\"card-slide\">\n\t\t\t\t\t\t\t<view class=\"business-card\" :style=\"{ background: c.bg }\">\n\t\t\t\t\t\t\t\t<view class=\"card-decor-1\"></view>\n\t\t\t\t\t\t\t\t<view class=\"card-decor-2\" :style=\"{ backgroundColor: c.decor2 }\"></view>\n\n\t\t\t\t\t\t\t\t<view class=\"card-inner\">\n\t\t\t\t\t\t\t\t\t<view class=\"card-top\">\n\t\t\t\t\t\t\t\t\t\t<view class=\"company-info\">\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"company-logo\">\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"material-symbols-outlined\">apartment</text>\n\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"company-name\">{{ c.store || '未绑定门店' }}</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t<view class=\"pro-tag\" :style=\"{ backgroundColor: c.badgeBg }\">\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"material-symbols-outlined pro-icon\">verified</text>\n\t\t\t\t\t\t\t\t\t\t\t<text>{{ c.badge }}</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t</view>\n\n\t\t\t\t\t\t\t\t\t<view class=\"card-middle\">\n\t\t\t\t\t\t\t\t\t\t<image class=\"card-avatar\" :src=\"safeImage(c.avatar)\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t\t\t\t\t<view class=\"card-user\">\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"card-name\">{{ c.name }}</text>\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"card-role\">{{ c.role }}</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t<view class=\"card-tags\">\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"card-tag\" v-for=\"(t, tIdx) in c.tags\" :key=\"tIdx\">{{ t }}</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t</view>\n\n\t\t\t\t\t\t\t\t\t<view class=\"card-bottom\">\n\t\t\t\t\t\t\t\t\t\t<view class=\"contact-info\">\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"contact-item\">\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"contact-icon\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"material-symbols-outlined\">call</text>\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"contact-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"contact-label\">Phone</text>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"contact-val\">{{ c.phone }}</text>\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t<view class=\"extra-info\">\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"extra-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"extra-line\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"extra-label\">微信号：</text>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"extra-val\">{{ c.wechat }}</text>\n\t\t\t\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"extra-line\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"extra-label\">门店：</text>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"extra-val\">{{ c.store }}</text>\n\t\t\t\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"qr-code\" @click=\"previewQrCode\">\n\t\t\t\t\t\t\t\t\t\t\t\t<image v-if=\"qrCodeUrl\" class=\"qr-image\" :src=\"qrCodeUrl\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t\t\t\t\t\t\t<text v-else class=\"material-symbols-outlined\">qr_code_2</text>\n\t\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</swiper-item>\n\t\t\t\t</swiper>\n\n\t\t\t\t<text class=\"swipe-tip\">左右滑动切换名片样式</text>\n\t\t\t</view>\n\n\t\t\t\t<!-- 编辑资料内容 -->\n\t\t\t<scroll-view v-if=\"currentTab === 1\" scroll-y=\"true\" class=\"edit-scroll\">\n\t\t\t\t<view class=\"edit-content\">\n\t\t\t\t<view class=\"form-group\">\n\t\t\t\t\t<view class=\"form-item\" @click=\"changeAvatar\">\n\t\t\t\t\t\t<text class=\"label\">头像</text>\n\t\t\t\t\t\t<view class=\"val-box\">\n\t\t\t\t\t\t\t<image class=\"avatar\" :src=\"safeImage(profile.avatar)\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t\t<text class=\"material-symbols-outlined arrow-icon\">chevron_right</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">姓名</text>\n\t\t\t\t\t\t<view class=\"val-box\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"val-input\"\n\t\t\t\t\t\t\t\tv-model=\"profile.name\"\n\t\t\t\t\t\t\t\tplaceholder=\"请输入姓名\"\n\t\t\t\t\t\t\t\tplaceholder-class=\"val-placeholder\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<text class=\"material-symbols-outlined arrow-icon\">chevron_right</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"form-item\" @click=\"showUneditable('手机号由平台绑定，不支持修改')\">\n\t\t\t\t\t\t<text class=\"label\">电话</text>\n\t\t\t\t\t\t<view class=\"val-box\">\n\t\t\t\t\t\t\t<text class=\"val\">{{ profile.phone }}</text>\n\t\t\t\t\t\t\t<text class=\"material-symbols-outlined arrow-icon\">chevron_right</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">微信号</text>\n\t\t\t\t\t\t<view class=\"val-box\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"val-input\"\n\t\t\t\t\t\t\t\tv-model=\"profile.wechat\"\n\t\t\t\t\t\t\t\tplaceholder=\"选填：用于名片展示\"\n\t\t\t\t\t\t\t\tplaceholder-class=\"val-placeholder\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<text class=\"material-symbols-outlined arrow-icon\">chevron_right</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"form-item no-border\">\n\t\t\t\t\t\t<text class=\"label\">职位</text>\n\t\t\t\t\t\t<view class=\"val-box\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"val-input\"\n\t\t\t\t\t\t\t\tv-model=\"profile.role\"\n\t\t\t\t\t\t\t\tplaceholder=\"如：资深置业顾问\"\n\t\t\t\t\t\t\t\tplaceholder-class=\"val-placeholder\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<text class=\"material-symbols-outlined arrow-icon\">chevron_right</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"notice-section\">\n\t\t\t\t\t<view class=\"form-group\">\n\t\t\t\t\t\t<picker\n\t\t\t\t\t\t\tmode=\"selector\"\n\t\t\t\t\t\t\t:range=\"storeOptions\"\n\t\t\t\t\t\t\trange-key=\"name\"\n\t\t\t\t\t\t\t@change=\"onStorePickerChange\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t\t\t<text class=\"label\">门店</text>\n\t\t\t\t\t\t\t\t<view class=\"val-box\">\n\t\t\t\t\t\t\t\t\t<text class=\"val\">{{ profile.store || '请选择门店' }}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"material-symbols-outlined arrow-icon\">chevron_right</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t<view class=\"form-item no-border\" v-if=\"profile.store_address\">\n\t\t\t\t\t\t\t<text class=\"label\">门店地址</text>\n\t\t\t\t\t\t\t<text class=\"val small\">{{ profile.store_address }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"tip-text\">* 门店可修改，建议选择与你当前服务区域一致的门店。</text>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-group bio-group\">\n\t\t\t\t\t<text class=\"label\">自我介绍</text>\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tv-model=\"profile.intro\"\n\t\t\t\t\t\tclass=\"bio-textarea\"\n\t\t\t\t\t\tplaceholder=\"介绍一下你的从业经历和服务理念...\"\n\t\t\t\t\t></textarea>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-group tags-group\">\n\t\t\t\t\t<view class=\"tags-header\">\n\t\t\t\t\t\t<text class=\"label\">擅长领域</text>\n\t\t\t\t\t\t<view class=\"add-tag-btn\" @click=\"openAddTag\">\n\t\t\t\t\t\t\t<text class=\"material-symbols-outlined add-icon\">add</text>\n\t\t\t\t\t\t\t<text>添加标签</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"tags-row\">\n\t\t\t\t\t\t<view class=\"tag active\" v-for=\"(t, idx) in profile.tags\" :key=\"'active-' + idx\" @click=\"removeTag(idx)\">\n\t\t\t\t\t\t\t<text>{{ t }}</text>\n\t\t\t\t\t\t\t<text class=\"material-symbols-outlined close-icon\">close</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"tag\" v-for=\"(t, idx) in suggestTags\" :key=\"'suggest-' + idx\" @click=\"addTag(t)\">\n\t\t\t\t\t\t\t<text>{{ t }}</text>\n\t\t\t\t\t\t\t<text class=\"material-symbols-outlined add-icon\">add</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</scroll-view>\n\t\t</view>\n\n\t\t<!-- 底部操作（占位在页面内，避免出现页面滚动） -->\n\t\t<view class=\"footer share-footer\" v-if=\"currentTab === 0\">\n\t\t\t<view class=\"share-options\">\n\t\t\t\t<button class=\"share-item share-btn\" open-type=\"share\">\n\t\t\t\t\t<view class=\"share-icon green\">\n\t\t\t\t\t\t<text class=\"material-symbols-outlined\">chat_bubble</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"share-label\">发送给朋友</text>\n\t\t\t\t</button>\n\t\t\t\t<view class=\"share-item\" @click=\"saveCardImage\">\n\t\t\t\t\t<view class=\"share-icon blue\">\n\t\t\t\t\t\t<text class=\"material-symbols-outlined\">image</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"share-label\">保存图片</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"share-item\" @click=\"copyCardLink\">\n\t\t\t\t\t<view class=\"share-icon orange\">\n\t\t\t\t\t\t<text class=\"material-symbols-outlined\">link</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"share-label\">复制链接</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"share-item\" @click=\"showMoreActions\">\n\t\t\t\t\t<view class=\"share-icon grey\">\n\t\t\t\t\t\t<text class=\"material-symbols-outlined\">more_horiz</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"share-label\">更多</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<view class=\"footer\" v-if=\"currentTab === 1\">\n\t\t\t<button class=\"save-btn\" :disabled=\"saving\" @click=\"saveProfile\">\n\t\t\t\t<text class=\"material-symbols-outlined\">save</text>\n\t\t\t\t<text>{{ saving ? '保存中...' : '保存修改' }}</text>\n\t\t\t</button>\n\t\t</view>\n\n\t\t<!-- 添加标签弹窗（简单实现，避免额外依赖组件） -->\n\t\t<view class=\"mask-popup\" v-if=\"tagPopupVisible\" @click=\"closeAddTag\">\n\t\t\t<view class=\"popup-card\" @click.stop>\n\t\t\t\t<view class=\"popup-title\">添加标签</view>\n\t\t\t\t<input\n\t\t\t\t\tclass=\"popup-input\"\n\t\t\t\t\tv-model=\"newTagText\"\n\t\t\t\t\tplaceholder=\"如：学区房专家\"\n\t\t\t\t\tplaceholder-class=\"val-placeholder\"\n\t\t\t\t\tmaxlength=\"12\"\n\t\t\t\t/>\n\t\t\t\t<view class=\"popup-actions\">\n\t\t\t\t\t<button class=\"popup-btn ghost\" @click=\"closeAddTag\">取消</button>\n\t\t\t\t\t<button class=\"popup-btn primary\" @click=\"confirmAddTag\">确定</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 底部导航（与首页一致） -->\n\t\t<BottomTabBar active=\"marketing\" />\n\n\t\t<!-- 生成名片图片用：隐藏 canvas -->\n\t\t<canvas\n\t\t\tcanvas-id=\"cardCanvas\"\n\t\t\tid=\"cardCanvas\"\n\t\t\tclass=\"hidden-canvas\"\n\t\t\t:style=\"{ width: canvasWidth + 'px', height: canvasHeight + 'px' }\"\n\t\t\t:width=\"canvasWidth * canvasScale\"\n\t\t\t:height=\"canvasHeight * canvasScale\"\n\t\t></canvas>\n\t</view>\n</template>\n\n<script>\n\timport BottomTabBar from '@/components/BottomTabBar.vue'\n\timport TopHeader from '@/components/TopHeader.vue'\n\timport userApi from '@/api/user'\n\timport $store from '@/store'\n\timport md5 from 'js-md5'\n\timport { baseUrl } from '@/utils/config'\n\n\tfunction base64Encode(str = '') {\n\t\ttry {\n\t\t\t// #ifdef H5\n\t\t\treturn window.btoa(str)\n\t\t\t// #endif\n\t\t} catch (e) {}\n\t\t// #ifndef H5\n\t\tconst utf8ToBytes = (s) => {\n\t\t\tconst bytes = []\n\t\t\tfor (let i = 0; i < s.length; i++) {\n\t\t\t\tlet codePoint = s.charCodeAt(i)\n\t\t\t\tif (codePoint < 0x80) {\n\t\t\t\t\tbytes.push(codePoint)\n\t\t\t\t} else if (codePoint < 0x800) {\n\t\t\t\t\tbytes.push(0xc0 | (codePoint >> 6))\n\t\t\t\t\tbytes.push(0x80 | (codePoint & 0x3f))\n\t\t\t\t} else {\n\t\t\t\t\tbytes.push(0xe0 | (codePoint >> 12))\n\t\t\t\t\tbytes.push(0x80 | ((codePoint >> 6) & 0x3f))\n\t\t\t\t\tbytes.push(0x80 | (codePoint & 0x3f))\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn new Uint8Array(bytes)\n\t\t}\n\t\tconst buf = utf8ToBytes(str).buffer\n\t\t// eslint-disable-next-line no-undef\n\t\tif (typeof wx !== 'undefined' && wx.arrayBufferToBase64) return wx.arrayBufferToBase64(buf)\n\t\tif (typeof uni !== 'undefined' && uni.arrayBufferToBase64) return uni.arrayBufferToBase64(buf)\n\t\treturn ''\n\t\t// #endif\n\t}\n\n\texport default {\n\t\tcomponents: { BottomTabBar, TopHeader },\n\t\tonLoad(options) {\n\t\t\t// 支持从“我的”页跳转过来直接打开“编辑资料”\n\t\t\tconst tab = options && (options.tab || options.currentTab)\n\t\t\tif (tab === '1' || tab === 1 || tab === 'edit') {\n\t\t\t\tthis.currentTab = 1\n\t\t\t}\n\t\t\tthis.initCanvasSize()\n\t\t\tthis.loadProfile().catch(() => {})\n\t\t},\n\t\tonShow() {\n\t\t\t// 返回页面后，防止缓存导致信息不更新\n\t\t\tthis.loadProfile(false).catch(() => {})\n\t\t},\n\t\tonShareAppMessage() {\n\t\t\tconst name = (this.profile && this.profile.name) || '我'\n\t\t\tconst agentId = Number(this.loadedUserId || 0)\n\t\t\tconst style = Number(this.currentPreview || 0)\n\t\t\treturn {\n\t\t\t\ttitle: `${name}的名片`,\n\t\t\t\tpath: `/pages/agent_public_card/agent_public_card?agent_id=${encodeURIComponent(agentId)}&style=${encodeURIComponent(style)}`\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\t// 默认先展示名片预览\n\t\t\t\tcurrentTab: 0,\n\t\t\t\tcurrentPreview: 0,\n\t\t\t\tqrCodeUrl: '',\n\t\t\t\tstyleChangeTimer: null,\n\t\t\t\tsaving: false,\n\t\t\t\tsavingImage: false,\n\t\t\t\ttagPopupVisible: false,\n\t\t\t\tnewTagText: '',\n\t\t\t\tloadedUserId: 0,\n\t\t\t\tstoreOptions: [],\n\t\t\t\tcanvasWidth: 900,\n\t\t\t\tcanvasHeight: 1320,\n\t\t\t\tcanvasScale: 2,\n\t\t\t\t// “我的资料”数据源：名片预览与编辑资料保持一致\n\t\t\t\tprofile: {\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tname: '',\n\t\t\t\t\tphone: '',\n\t\t\t\t\twechat: '',\n\t\t\t\t\trole: '',\n\t\t\t\t\tstore_id: 0,\n\t\t\t\t\tstore: '',\n\t\t\t\t\tstore_address: '',\n\t\t\t\t\temail: '',\n\t\t\t\t\tintro: '',\n\t\t\t\t\ttags: []\n\t\t\t\t},\n\t\t\t\tsuggestTags: ['学区房专家', '二手房买卖', '新房咨询', '高端别墅', '婚房首选', '投资置业'],\n\t\t\t\t// 名片样式（只改变视觉，不改变字段）\n\t\t\t\tcardStyles: [\n\t\t\t\t\t{ bg: 'linear-gradient(135deg, #2d9cf0, #1e40af)', decor2: 'rgba(249, 115, 22, 0.2)', badge: 'PRO', badgeBg: '#f97316' },\n\t\t\t\t\t{ bg: 'linear-gradient(135deg, #06b6d4, #2563eb)', decor2: 'rgba(255, 255, 255, 0.12)', badge: 'TOP', badgeBg: '#22c55e' },\n\t\t\t\t\t{ bg: 'linear-gradient(135deg, #111827, #334155)', decor2: 'rgba(45, 156, 240, 0.18)', badge: 'VIP', badgeBg: '#2d9cf0' }\n\t\t\t\t]\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\tpreviewCards() {\n\t\t\t\tconst p = this.profile || {}\n\t\t\t\tconst tags = Array.isArray(p.tags) ? p.tags.slice(0, 3) : []\n\t\t\t\treturn (this.cardStyles || []).map((s) => ({\n\t\t\t\t\t...s,\n\t\t\t\t\tname: p.name,\n\t\t\t\t\trole: p.role,\n\t\t\t\t\tphone: p.phone,\n\t\t\t\t\twechat: p.wechat,\n\t\t\t\t\tstore: p.store,\n\t\t\t\t\tavatar: p.avatar,\n\t\t\t\t\ttags\n\t\t\t\t}))\n\t\t\t}\n\t\t},\n\t\twatch: {\n\t\t\tcurrentTab(v) {\n\t\t\t\tif (Number(v) === 1) this.loadStores().catch(() => {})\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tinitCanvasSize() {\n\t\t\t\ttry {\n\t\t\t\t\tconst sys = uni.getSystemInfoSync ? uni.getSystemInfoSync() : {}\n\t\t\t\t\tconst pr = Number(sys.pixelRatio || 2)\n\t\t\t\t\tthis.canvasScale = Math.max(2, Math.min(3, pr || 2))\n\t\t\t\t\t// 固定导出海报尺寸（与绘制坐标系一致：900x1320），避免不同机型出现裁切/只截左上角\n\t\t\t\t\tthis.canvasWidth = 900\n\t\t\t\t\tthis.canvasHeight = 1320\n\t\t\t\t} catch (e) {}\n\t\t\t},\n\t\t\tonPreviewChange(e) {\n\t\t\t\tthis.currentPreview = e.detail.current\n\t\t\t\tthis.persistDefaultStyle()\n\t\t\t\tthis.scheduleWxaCodeRefresh()\n\t\t\t},\n\t\t\tsafeImage(url) {\n\t\t\t\tconst u = String(url || '').trim()\n\t\t\t\treturn u || '/static/images/img_155372af18.png'\n\t\t\t},\n\t\t\textrasStorageKey(uid) {\n\t\t\t\treturn `wxapp_my_business_card_extras_${uid || 0}`\n\t\t\t},\n\t\t\tloadExtras(uid) {\n\t\t\t\tconst key = this.extrasStorageKey(uid)\n\t\t\t\tconst raw = uni.getStorageSync(key)\n\t\t\t\tif (!raw) return {}\n\t\t\t\ttry {\n\t\t\t\t\tif (typeof raw === 'string') return JSON.parse(raw)\n\t\t\t\t\treturn raw || {}\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn {}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsaveExtras(uid) {\n\t\t\t\tconst key = this.extrasStorageKey(uid)\n\t\t\t\tconst payload = {\n\t\t\t\t\twechat: String(this.profile.wechat || '').trim(),\n\t\t\t\t\ttags: Array.isArray(this.profile.tags) ? this.profile.tags : []\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tuni.setStorageSync(key, JSON.stringify(payload))\n\t\t\t\t} catch (e) {\n\t\t\t\t\tuni.setStorageSync(key, payload)\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync loadProfile(showLoading = true) {\n\t\t\t\tconst token = uni.getStorageSync('token')\n\t\t\t\tif (!token && !$store('user').isLogin) return\n\t\t\t\tconst res = await userApi.getCardProfile(!!showLoading)\n\t\t\t\tif (!res || res.code !== 0) return\n\t\t\t\tconst d = res.data || {}\n\t\t\t\tconst uid = Number(d.id || d.ID || 0)\n\t\t\t\tthis.loadedUserId = uid\n\t\t\t\tthis.profile.avatar = d.avatar || ''\n\t\t\t\tthis.profile.name = d.name || d.nickname || ''\n\t\t\t\tthis.profile.phone = d.mobile || ''\n\t\t\t\tthis.profile.role = d.title || d.role || ''\n\t\t\t\tthis.profile.store_id = Number(d.store_id || 0)\n\t\t\t\tthis.profile.store = d.store_name || ''\n\t\t\t\tthis.profile.store_address = d.store_address || ''\n\t\t\t\tthis.profile.email = d.email || ''\n\t\t\t\tthis.profile.intro = d.introduction || ''\n\n\t\t\t\t// 读取上次选择的样式\n\t\t\t\tconst idx = Number(uni.getStorageSync(this.styleStorageKey(uid)) || 0)\n\t\t\t\tif (!Number.isNaN(idx) && idx >= 0) this.currentPreview = idx\n\n\t\t\t\tconst extras = this.loadExtras(uid)\n\t\t\t\tif (extras) {\n\t\t\t\t\tif (typeof extras.wechat === 'string') this.profile.wechat = extras.wechat\n\t\t\t\t\tif (Array.isArray(extras.tags)) this.profile.tags = extras.tags\n\t\t\t\t}\n\n\t\t\t\t// 刷新小程序码（与当前样式绑定，scene 内携带样式下标）\n\t\t\t\tthis.loadWxaCode(false).catch(() => {})\n\t\t\t},\n\t\t\tstyleStorageKey(uid) {\n\t\t\t\treturn `wxapp_my_business_card_style_${uid || 0}`\n\t\t\t},\n\t\t\tpersistDefaultStyle() {\n\t\t\t\tif (!this.loadedUserId) return\n\t\t\t\tuni.setStorageSync(this.styleStorageKey(this.loadedUserId), Number(this.currentPreview || 0))\n\t\t\t},\n\t\t\tscheduleWxaCodeRefresh() {\n\t\t\t\tif (this.styleChangeTimer) {\n\t\t\t\t\tclearTimeout(this.styleChangeTimer)\n\t\t\t\t\tthis.styleChangeTimer = null\n\t\t\t\t}\n\t\t\t\tthis.styleChangeTimer = setTimeout(() => {\n\t\t\t\t\tthis.loadWxaCode(false).catch(() => {})\n\t\t\t\t}, 220)\n\t\t\t},\n\t\t\t/**\n\t\t\t * 加载代理商小程序码\n\t\t\t *\n\t\t\t * 根据当前选择的样式生成代理商专属的小程序码URL，支持开发环境跳过路径校验\n\t\t\t *\t\n\t\t\t * @param {boolean} [showLoading=true] - 是否显示加载提示\n\t\t\t * @returns {Promise<void>} 无返回值，通过组件属性更新小程序码URL\n\t\t\t */\n\t\t\tasync loadWxaCode(showLoading = true) {\n\t\t\t\t// 检查用户登录状态\n\t\t\t\tconst token = uni.getStorageSync('token')\n\t\t\t\tif (!token && !$store('user').isLogin) return\n\t\t\t\t// 构建请求参数，包含当前选择的样式\n\t\t\t\tconst data = { style: Number(this.currentPreview || 0) }\n\t\t\t\t// 开发/测试阶段：允许跳过页面路径校验，避免新页面未发布导致生成失败\n\t\t\t\t// 注意：小程序环境可能没有全局 process，不能直接写 `process && ...`，否则会抛 ReferenceError\n\t\t\t\tconst isDev =\n\t\t\t\t\t(typeof process !== 'undefined' && process.env && process.env.NODE_ENV === 'development') ||\n\t\t\t\t\t(typeof wx !== 'undefined' &&\n\t\t\t\t\t\twx.getAccountInfoSync &&\n\t\t\t\t\t\t['develop', 'trial'].includes((wx.getAccountInfoSync().miniProgram || {}).envVersion))\n\t\t\t\tif (isDev) data.check_path = false\n\t\t\t\t// 调用API获取小程序码\n\t\t\t\tconst res = await userApi.getAgentWxaCode(data, !!showLoading)\n\t\t\t\t// 检查响应结果\n\t\t\t\tif (!res || res.code !== 0) return\n\t\t\t\t// 更新小程序码URL\n\t\t\t\tthis.qrCodeUrl = (res.data && res.data.url) || ''\n\t\t\t},\n\t\t\tpreviewQrCode() {\n\t\t\t\tif (!this.qrCodeUrl) {\n\t\t\t\t\tuni.showToast({ title: '小程序码生成中...', icon: 'none' })\n\t\t\t\t\tthis.loadWxaCode(true).catch(() => {})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tuni.previewImage({ urls: [this.qrCodeUrl] })\n\t\t\t},\n\t\t\tasync loadStores() {\n\t\t\t\tconst token = uni.getStorageSync('token')\n\t\t\t\tif (!token && !$store('user').isLogin) return\n\t\t\t\tconst res = await userApi.getStores(false)\n\t\t\t\tif (!res || res.code !== 0) return\n\t\t\t\tconst items = Array.isArray(res.data) ? res.data : []\n\t\t\t\tthis.storeOptions = items\n\t\t\t},\n\t\t\tonStorePickerChange(e) {\n\t\t\t\tconst idx = Number(e && e.detail ? e.detail.value : -1)\n\t\t\t\tif (!Array.isArray(this.storeOptions) || this.storeOptions.length === 0) {\n\t\t\t\t\tuni.showToast({ title: '暂无可选门店', icon: 'none' })\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (idx < 0 || idx >= this.storeOptions.length) return\n\t\t\t\tconst s = this.storeOptions[idx] || {}\n\t\t\t\tthis.profile.store_id = Number(s.id || 0)\n\t\t\t\tthis.profile.store = s.name || ''\n\t\t\t\tthis.profile.store_address = s.address || ''\n\t\t\t},\n\t\t\tshowUneditable(msg) {\n\t\t\t\tuni.showToast({ title: msg || '不支持修改', icon: 'none' })\n\t\t\t},\n\t\t\topenAddTag() {\n\t\t\t\tthis.newTagText = ''\n\t\t\t\tthis.tagPopupVisible = true\n\t\t\t},\n\t\t\tcloseAddTag() {\n\t\t\t\tthis.tagPopupVisible = false\n\t\t\t\tthis.newTagText = ''\n\t\t\t},\n\t\t\tconfirmAddTag() {\n\t\t\t\tconst t = String(this.newTagText || '').trim()\n\t\t\t\tif (!t) {\n\t\t\t\t\tuni.showToast({ title: '请输入标签内容', icon: 'none' })\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.addTag(t)\n\t\t\t\tthis.closeAddTag()\n\t\t\t},\n\t\t\taddTag(t) {\n\t\t\t\tconst tag = String(t || '').trim()\n\t\t\t\tif (!tag) return\n\t\t\t\tif (!Array.isArray(this.profile.tags)) this.profile.tags = []\n\t\t\t\tif (this.profile.tags.includes(tag)) return\n\t\t\t\tif (this.profile.tags.length >= 6) {\n\t\t\t\t\tuni.showToast({ title: '最多添加6个标签', icon: 'none' })\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.profile.tags = this.profile.tags.concat([tag])\n\t\t\t},\n\t\t\tremoveTag(idx) {\n\t\t\t\tif (!Array.isArray(this.profile.tags)) return\n\t\t\t\tthis.profile.tags = this.profile.tags.filter((_, i) => i !== idx)\n\t\t\t},\n\t\t\tasync saveProfile() {\n\t\t\t\tif (this.saving) return\n\t\t\t\tconst name = String(this.profile.name || '').trim()\n\t\t\t\tif (!name) {\n\t\t\t\t\tuni.showToast({ title: '请填写姓名', icon: 'none' })\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.saving = true\n\t\t\t\ttry {\n\t\t\t\t\tconst payload = {\n\t\t\t\t\t\tavatar: this.profile.avatar,\n\t\t\t\t\t\tname,\n\t\t\t\t\t\ttitle: String(this.profile.role || '').trim(),\n\t\t\t\t\t\tintroduction: String(this.profile.intro || '').trim(),\n\t\t\t\t\t\tstore_id: Number(this.profile.store_id || 0)\n\t\t\t\t\t}\n\t\t\t\t\tconst res = await userApi.updateCardProfile(payload, true)\n\t\t\t\t\tif (!res || res.code !== 0) return\n\t\t\t\t\tif (this.loadedUserId) this.saveExtras(this.loadedUserId)\n\t\t\t\t\tconst userStore = $store('user')\n\t\t\t\t\tuserStore.setUserInfo({\n\t\t\t\t\t\t...(userStore.userInfo || {}),\n\t\t\t\t\t\tavatar: this.profile.avatar,\n\t\t\t\t\t\tname: this.profile.name\n\t\t\t\t\t})\n\t\t\t\t\tuni.showToast({ title: '保存成功', icon: 'none' })\n\t\t\t\t} finally {\n\t\t\t\t\tthis.saving = false\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync changeAvatar() {\n\t\t\t\tif (this.saving) return\n\t\t\t\tuni.chooseImage({\n\t\t\t\t\tcount: 1,\n\t\t\t\t\tsizeType: ['compressed'],\n\t\t\t\t\tsourceType: ['album', 'camera'],\n\t\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\t\tconst filePath = res && res.tempFilePaths && res.tempFilePaths[0]\n\t\t\t\t\t\tif (!filePath) return\n\t\t\t\t\t\tawait this.uploadAvatar(filePath)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tuploadAvatar(filePath) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tconst token = uni.getStorageSync('token')\n\t\t\t\t\tconst timestamp = Math.floor(Date.now() / 1000)\n\t\t\t\t\tconst passstr = md5(import.meta.env.GF_API_SECRET + timestamp)\n\t\t\t\t\tconst header = {\n\t\t\t\t\t\tAccept: 'text/json',\n\t\t\t\t\t\tBusinessid: import.meta.env.GF_BUSINESUSSID,\n\t\t\t\t\t\tapiverify: base64Encode(passstr + '#' + timestamp)\n\t\t\t\t\t}\n\t\t\t\t\tif (token) header.Authorization = `${token}`\n\t\t\t\t\tuni.uploadFile({\n\t\t\t\t\t\turl: `${baseUrl}/common/upload/upFile`,\n\t\t\t\t\t\tfilePath,\n\t\t\t\t\t\tname: 'file',\n\t\t\t\t\t\tformData: { filetype: 'image' },\n\t\t\t\t\t\theader,\n\t\t\t\t\t\tsuccess: (upRes) => {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst raw = upRes && upRes.data ? upRes.data : '{}'\n\t\t\t\t\t\t\t\tconst out = typeof raw === 'string' ? JSON.parse(raw) : raw\n\t\t\t\t\t\t\t\tif (!out || out.code !== 0) {\n\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\ttitle: (out && out.message) || '上传失败',\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\treject(out)\n\t\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst url = out && out.data ? out.data.url : ''\n\t\t\t\t\t\t\t\tthis.profile.avatar = url || ''\n\t\t\t\t\t\t\t\tuni.showToast({ title: '头像已更新', icon: 'none' })\n\t\t\t\t\t\t\t\tresolve(out)\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tuni.showToast({ title: '解析上传结果失败', icon: 'none' })\n\t\t\t\t\t\t\t\treject(e)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\t\tuni.showToast({ title: '上传失败', icon: 'none' })\n\t\t\t\t\t\t\treject(err)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\tsaveCardImage() {\n\t\t\t\tthis.saveCardToAlbum().catch(() => {})\n\t\t\t},\n\t\t\tcopyCardLink() {\n\t\t\t\tthis.copyUrlLink().catch(() => {})\n\t\t\t},\n\t\t\tasync copyUrlLink() {\n\t\t\t\tconst style = Number(this.currentPreview || 0)\n\t\t\t\tlet envVersion = ''\n\t\t\t\t// 小程序端：按当前运行环境生成对应的 URLLink（develop|trial|release）\n\t\t\t\tif (typeof wx !== 'undefined' && wx.getAccountInfoSync) {\n\t\t\t\t\tconst ev = (wx.getAccountInfoSync().miniProgram || {}).envVersion\n\t\t\t\t\tif (ev === 'develop' || ev === 'trial' || ev === 'release') envVersion = ev\n\t\t\t\t}\n\t\t\t\tconst res = await userApi.getAgentUrlLink({ style, env_version: envVersion }, true)\n\t\t\t\tconst urlLink = res && res.code === 0 && res.data ? res.data.url_link : ''\n\t\t\t\tif (!urlLink) {\n\t\t\t\t\tuni.showToast({ title: '获取链接失败', icon: 'none' })\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tuni.setClipboardData({\n\t\t\t\t\tdata: urlLink,\n\t\t\t\t\tsuccess: () => uni.showToast({ title: '已复制链接', icon: 'none' })\n\t\t\t\t})\n\t\t\t},\n\t\t\tshowMoreActions() {\n\t\t\t\tuni.showActionSheet({\n\t\t\t\t\titemList: ['刷新资料', '清空本地名片扩展信息'],\n\t\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\t\tif (res.tapIndex === 0) {\n\t\t\t\t\t\t\tawait this.loadProfile(true).catch(() => {})\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (res.tapIndex === 1) {\n\t\t\t\t\t\t\tif (!this.loadedUserId) return\n\t\t\t\t\t\t\tuni.removeStorageSync(this.extrasStorageKey(this.loadedUserId))\n\t\t\t\t\t\t\tthis.profile.wechat = ''\n\t\t\t\t\t\t\tthis.profile.tags = []\n\t\t\t\t\t\t\tuni.showToast({ title: '已清空', icon: 'none' })\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tgetGradientColors(bg) {\n\t\t\t\tconst s = String(bg || '')\n\t\t\t\tconst matches = s.match(/#(?:[0-9a-fA-F]{3}){1,2}/g) || []\n\t\t\t\tif (matches.length >= 2) return [matches[0], matches[1]]\n\t\t\t\treturn ['#2d9cf0', '#1e40af']\n\t\t\t},\n\t\t\tdrawRoundRectPath(ctx, x, y, w, h, r) {\n\t\t\t\tconst rr = Math.max(0, Math.min(r, w / 2, h / 2))\n\t\t\t\tctx.beginPath()\n\t\t\t\tctx.moveTo(x + rr, y)\n\t\t\t\tctx.arcTo(x + w, y, x + w, y + h, rr)\n\t\t\t\tctx.arcTo(x + w, y + h, x, y + h, rr)\n\t\t\t\tctx.arcTo(x, y + h, x, y, rr)\n\t\t\t\tctx.arcTo(x, y, x + w, y, rr)\n\t\t\t\tctx.closePath()\n\t\t\t},\n\t\t\tgetImageInfo(src) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tif (!src) return reject(new Error('empty src'))\n\t\t\t\t\tuni.getImageInfo({\n\t\t\t\t\t\tsrc,\n\t\t\t\t\t\tsuccess: (res) => resolve(res),\n\t\t\t\t\t\tfail: (err) => reject(err)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\tasync saveCardToAlbum() {\n\t\t\t\tif (this.savingImage) return\n\t\t\t\tthis.savingImage = true\n\t\t\t\ttry {\n\t\t\t\t\tif (!this.qrCodeUrl) {\n\t\t\t\t\t\tawait this.loadWxaCode(true).catch(() => {})\n\t\t\t\t\t}\n\t\t\t\t\tif (!this.qrCodeUrl) {\n\t\t\t\t\t\tuni.showToast({ title: '小程序码生成失败', icon: 'none' })\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst style = this.previewCards[this.currentPreview] || this.previewCards[0]\n\t\t\t\t\tconst w = this.canvasWidth * this.canvasScale\n\t\t\t\t\tconst h = this.canvasHeight * this.canvasScale\n\t\t\t\t\tconst scale = this.canvasScale\n\t\t\t\t\t// 以 900x1320 的设计稿坐标系绘制，再按实际导出尺寸等比缩放，避免出现裁切/偏移\n\t\t\t\t\tconst baseW = 900\n\t\t\t\t\tconst s = w / baseW\n\t\t\t\t\tconst px = (v) => Number(v) * (w / 900)\n          const fs = (v) => ath.round(Number(v) * (w / 900))\n\n\t\t\t\t\tconst ctx = uni.createCanvasContext('cardCanvas', this)\n\t\t\t\t\tctx.save()\n\t\t\t\t\t// ctx.scale(scale, scale)\n\n\t\t\t\t\t// 背景 + 圆角裁剪\n\t\t\t\t\tthis.drawRoundRectPath(ctx, 0, 0, w, h, px(40))\n\t\t\t\t\tctx.clip()\n\t\t\t\t\tconst [c1, c2] = this.getGradientColors(style.bg)\n\t\t\t\t\tconst grd = ctx.createLinearGradient(0, 0, w, h)\n\t\t\t\t\tgrd.addColorStop(0, c1)\n\t\t\t\t\tgrd.addColorStop(1, c2)\n\t\t\t\t\tctx.setFillStyle(grd)\n\t\t\t\t\tctx.fillRect(0, 0, w, h)\n\n\t\t\t\t\t// 装饰圆\n\t\t\t\t\tctx.setFillStyle('rgba(255,255,255,0.10)')\n\t\t\t\t\tctx.beginPath()\n\t\t\t\t\tctx.arc(w - px(80), px(80), px(140), 0, Math.PI * 2)\n\t\t\t\t\tctx.fill()\n\t\t\t\t\tctx.setFillStyle(String(style.decor2 || 'rgba(249,115,22,0.18)'))\n\t\t\t\t\tctx.beginPath()\n\t\t\t\t\tctx.arc(px(80), h - px(120), px(180), 0, Math.PI * 2)\n\t\t\t\t\tctx.fill()\n\n\t\t\t\t\t// 顶部门店 + badge\n\t\t\t\t\tctx.setFillStyle('rgba(255,255,255,0.22)')\n\t\t\t\t\tthis.drawRoundRectPath(ctx, px(40), px(40), px(520), px(70), px(16))\n\t\t\t\t\tctx.fill()\n\t\t\t\t\tctx.setFillStyle('#ffffff')\n\t\t\t\t\tctx.setFontSize(fs(28))\n\t\t\t\t\tctx.fillText(String(style.store || '未绑定门店'), px(60), px(86))\n\n\t\t\t\t\tctx.setFillStyle(String(style.badgeBg || '#f97316'))\n\t\t\t\t\tthis.drawRoundRectPath(ctx, w - px(180), px(44), px(140), px(60), px(30))\n\t\t\t\t\tctx.fill()\n\t\t\t\t\tctx.setFillStyle('#ffffff')\n\t\t\t\t\tctx.setFontSize(fs(22))\n\t\t\t\t\tctx.fillText(String(style.badge || 'PRO'), w - px(140), px(82))\n\n\t\t\t\t\t// 头像\n\t\t\t\t\tconst avatarInfo = await this.getImageInfo(this.safeImage(style.avatar))\n\t\t\t\t\tconst avatarSize = px(200)\n\t\t\t\t\tconst avatarX = (w - avatarSize) / 2\n\t\t\t\t\tconst avatarY = px(170)\n\t\t\t\t\tctx.save()\n\t\t\t\t\tctx.beginPath()\n\t\t\t\t\tctx.arc(w / 2, avatarY + avatarSize / 2, avatarSize / 2, 0, Math.PI * 2)\n\t\t\t\t\tctx.clip()\n\t\t\t\t\tctx.drawImage(avatarInfo.path, avatarX, avatarY, avatarSize, avatarSize)\n\t\t\t\t\tctx.restore()\n\t\t\t\t\tctx.setStrokeStyle('rgba(255,255,255,0.28)')\n\t\t\t\t\tctx.setLineWidth(Math.max(2, px(6)))\n\t\t\t\t\tctx.beginPath()\n\t\t\t\t\tctx.arc(w / 2, avatarY + avatarSize / 2, avatarSize / 2, 0, Math.PI * 2)\n\t\t\t\t\tctx.stroke()\n\n\t\t\t\t\t// 姓名/职位\n\t\t\t\t\tctx.setFillStyle('#ffffff')\n\t\t\t\t\tctx.setFontSize(fs(44))\n\t\t\t\t\tconst name = String(style.name || '')\n\t\t\t\t\tctx.fillText(name, (w - ctx.measureText(name).width) / 2, px(430))\n\t\t\t\t\tctx.setFontSize(fs(28))\n\t\t\t\t\tctx.setFillStyle('rgba(255,255,255,0.85)')\n\t\t\t\t\tconst role = String(style.role || '置业顾问')\n\t\t\t\t\tctx.fillText(role, (w - ctx.measureText(role).width) / 2, px(475))\n\n\t\t\t\t\t// 电话块\n\t\t\t\t\tctx.setFillStyle('rgba(255,255,255,0.12)')\n\t\t\t\t\tthis.drawRoundRectPath(ctx, px(60), px(520), w - px(120), px(120), px(24))\n\t\t\t\t\tctx.fill()\n\t\t\t\t\tctx.setFillStyle('rgba(255,255,255,0.72)')\n\t\t\t\t\tctx.setFontSize(fs(22))\n\t\t\t\t\tctx.fillText('电话', px(90), px(570))\n\t\t\t\t\tctx.setFillStyle('#ffffff')\n\t\t\t\t\tctx.setFontSize(fs(30))\n\t\t\t\t\tconst phone = String(style.phone || '')\n\t\t\t\t\tctx.fillText(phone, px(90), px(612))\n\n\t\t\t\t\t// 文字信息（微信/门店）\n\t\t\t\t\tctx.setFillStyle('rgba(255,255,255,0.92)')\n\t\t\t\t\tctx.setFontSize(fs(26))\n\t\t\t\t\tconst wechatLine = '微信号：' + String(style.wechat || '')\n\t\t\t\t\tctx.fillText(wechatLine, px(70), h - px(230))\n\t\t\t\t\tconst storeLine = '门店：' + String(style.store || '')\n\t\t\t\t\tctx.fillText(storeLine, px(70), h - px(190))\n\n\t\t\t\t\t// 小程序码\n\t\t\t\t\tconst qrInfo = await this.getImageInfo(this.qrCodeUrl)\n\t\t\t\t\tctx.setFillStyle('#ffffff')\n\t\t\t\t\tthis.drawRoundRectPath(ctx, w - px(260), h - px(300), px(200), px(200), px(16))\n\t\t\t\t\tctx.fill()\n\t\t\t\t\tctx.drawImage(qrInfo.path, w - px(250), h - px(290), px(180), px(180))\n\t\t\t\t\tctx.setFillStyle('rgba(255,255,255,0.78)')\n\t\t\t\t\tctx.setFontSize(fs(20))\n\t\t\t\t\tctx.fillText('微信识别进入', w - px(250), h - px(80))\n\n\t\t\t\t\tctx.restore()\n\n\t\t\t\t\tawait new Promise((resolve) => ctx.draw(false, resolve))\n\n\t\t\t\t\tconst temp = await new Promise((resolve, reject) => {\n            uni.canvasToTempFilePath(\n                {\n                  canvasId: 'cardCanvas',\n                  x: 0,\n                  y: 0,\n                  // ✅ 截图区域：用逻辑尺寸（你绘制时用的坐标系）\n                  width: w,\n                  height: h,\n\n                  // ✅ 导出分辨率：用真实像素\n                  destWidth: w,\n                  destHeight: h,\n\n                  fileType: 'png',\n                  quality: 1,\n                  success: (res) => resolve(res),\n                  fail: (err) => reject(err)\n                },\n                this\n            )\n\n          })\n\n\t\t\t\t\tawait new Promise((resolve, reject) => {\n\t\t\t\t\t\tuni.saveImageToPhotosAlbum({\n\t\t\t\t\t\t\tfilePath: temp.tempFilePath,\n\t\t\t\t\t\t\tsuccess: () => resolve(true),\n\t\t\t\t\t\t\tfail: (err) => reject(err)\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\tuni.showToast({ title: '已保存到相册', icon: 'none' })\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// 常见：未授权保存到相册\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '保存失败',\n\t\t\t\t\t\tcontent: '请允许保存到相册权限后重试',\n\t\t\t\t\t\tconfirmText: '去设置',\n\t\t\t\t\t\tcancelText: '取消',\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.confirm) uni.openSetting({})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t} finally {\n\t\t\t\t\tthis.savingImage = false\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.card-container {\n\t\theight: 100vh;\n\t\tbackground-color: #f6f7f8;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\toverflow: hidden;\n\t}\n\n\t.header {\n\t\t/* header 已由 TopHeader 统一 */\n\t\tdisplay: none;\n\t}\n\n\t.tabs-box {\n\t\tpadding: 24rpx 32rpx;\n\t\tbackground-color: #ffffff;\n\n\t\t.tabs-inner {\n\t\t\tdisplay: flex;\n\t\t\tbackground-color: #f1f5f9;\n\t\t\tpadding: 8rpx;\n\t\t\tborder-radius: 20rpx;\n\t\t}\n\n\t\t.tab-item {\n\t\t\tflex: 1;\n\t\t\theight: 72rpx;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\tfont-size: 28rpx;\n\t\t\tfont-weight: 500;\n\t\t\tcolor: #64748b;\n\t\t\tborder-radius: 16rpx;\n\t\t\ttransition: all 0.3s;\n\n\t\t\t&.active {\n\t\t\t\tbackground-color: #ffffff;\n\t\t\t\tcolor: #0f172a;\n\t\t\t\tbox-shadow: 0 4rpx 10rpx rgba(0, 0, 0, 0.05);\n\t\t\t}\n\t\t}\n\t}\n\n\t.main-content {\n\t\tflex: 1;\n\t\toverflow: hidden;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmin-height: 0;\n\t}\n\n\t.edit-scroll {\n\t\tflex: 1;\n\t\tmin-height: 0;\n\t}\n\n\t.edit-content {\n\t\tpadding: 20rpx 24rpx 16rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16rpx;\n\t}\n\n\t.form-group {\n\t\tbackground-color: #ffffff;\n\t\tborder-radius: 24rpx;\n\t\toverflow: hidden;\n\t\tbox-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.02);\n\n\t\t.form-item {\n\t\t\tpadding: 24rpx;\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t\tborder-bottom: 1rpx solid #f1f5f9;\n\n\t\t\t&.no-border { border-bottom: none; }\n\n\t\t\t.label { font-size: 30rpx; font-weight: 500; color: #0f172a; }\n\n\t\t\t.val-box {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tgap: 16rpx;\n\t\t\t\tcolor: #64748b;\n\n\t\t\t\t.avatar { width: 96rpx; height: 96rpx; border-radius: 50%; border: 1rpx solid #e2e8f0; }\n\t\t\t\t.val { font-size: 30rpx; }\n\t\t\t\t.val-input {\n\t\t\t\t\twidth: 420rpx;\n\t\t\t\t\tfont-size: 30rpx;\n\t\t\t\t\tcolor: #0f172a;\n\t\t\t\t\ttext-align: right;\n\t\t\t\t}\n\t\t\t\t.val-placeholder { color: #94a3b8; }\n\t\t\t\t.arrow-icon { font-size: 40rpx; }\n\t\t\t}\n\n\t\t\t&:active { background-color: #f8fafc; }\n\t\t}\n\t}\n\n\t.notice-section {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12rpx;\n\n\t\t.val { color: #64748b; font-size: 30rpx; }\n\t\t.val.small { font-size: 26rpx; }\n\t\t.tip-text { padding: 0 16rpx; font-size: 24rpx; color: #94a3b8; line-height: 1.6; }\n\t}\n\n\t.bio-group {\n\t\tpadding: 24rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16rpx;\n\n\t\t.bio-textarea {\n\t\t\twidth: 100%;\n\t\t\theight: 160rpx;\n\t\t\tbackground-color: #f8fafc;\n\t\t\tborder: 1px solid #e2e8f0;\n\t\t\tborder-radius: 16rpx;\n\t\t\tpadding: 24rpx;\n\t\t\tfont-size: 30rpx;\n\t\t\tcolor: #334155;\n\t\t\tline-height: 1.5;\n\t\t}\n\t}\n\n\t.tags-group {\n\t\tpadding: 24rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 20rpx;\n\n\t\t.tags-header {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\n\t\t\t.add-tag-btn {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tgap: 4rpx;\n\t\t\t\tfont-size: 24rpx;\n\t\t\t\tcolor: #2d9cf0;\n\t\t\t\tfont-weight: 600;\n\n\t\t\t\t.add-icon { font-size: 32rpx; }\n\t\t\t}\n\t\t}\n\n\t\t.tags-row {\n\t\t\tdisplay: flex;\n\t\t\tflex-wrap: wrap;\n\t\t\tgap: 20rpx;\n\n\t\t\t.tag {\n\t\t\t\tpadding: 12rpx 24rpx;\n\t\t\t\tbackground-color: #f1f5f9;\n\t\t\t\tborder-radius: 40rpx;\n\t\t\t\tfont-size: 24rpx;\n\t\t\t\tcolor: #64748b;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tgap: 8rpx;\n\t\t\t\tborder: 1px solid transparent;\n\n\t\t\t\t&.active {\n\t\t\t\t\tbackground-color: rgba(45, 156, 240, 0.1);\n\t\t\t\t\tcolor: #2d9cf0;\n\t\t\t\t\tborder-color: rgba(45, 156, 240, 0.2);\n\t\t\t\t}\n\n\t\t\t\t.close-icon, .add-icon { font-size: 28rpx; }\n\t\t\t}\n\t\t}\n\t}\n\n\t.preview-content {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tpadding: 24rpx 24rpx 16rpx;\n\t\tflex: 1;\n\t\tmin-height: 0;\n\n\t\t.pagination-dots {\n\t\t\tdisplay: flex;\n\t\t\tgap: 16rpx;\n\t\t\tmargin-bottom: 16rpx;\n\n\t\t\t.dot {\n\t\t\t\twidth: 12rpx;\n\t\t\t\theight: 12rpx;\n\t\t\t\tborder-radius: 50%;\n\t\t\t\tbackground-color: #cbd5e1;\n\n\t\t\t\t&.active { background-color: #2d9cf0; }\n\t\t\t}\n\t\t}\n\n\t\t.card-swiper {\n\t\t\twidth: 100%;\n\t\t\tflex: 1;\n\t\t\tmin-height: 0;\n\t\t\t/* swiper 本身不参与布局，居中由 swiper-item 内部容器完成 */\n\t\t}\n\n\t\t.card-slide {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t}\n\n\t\t.business-card {\n\t\t\t/* 小程序端可视区较小：整体缩小一点，避免被底部操作/导航遮挡 */\n\t\t\twidth: 600rpx;\n\t\t\theight: 880rpx;\n\t\t\tborder-radius: 40rpx;\n\t\t\tposition: relative;\n\t\t\toverflow: hidden;\n\t\t\tbox-shadow: 0 40rpx 80rpx rgba(0, 0, 0, 0.2);\n\t\t\tborder: 1rpx solid rgba(255, 255, 255, 0.08);\n\n\t\t\t.card-decor-1 {\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: -80rpx;\n\t\t\t\tright: -80rpx;\n\t\t\t\twidth: 256rpx;\n\t\t\t\theight: 256rpx;\n\t\t\t\tbackground-color: rgba(255, 255, 255, 0.05);\n\t\t\t\tborder-radius: 50%;\n\t\t\t\tfilter: blur(40rpx);\n\t\t\t}\n\n\t\t\t.card-decor-2 {\n\t\t\t\tposition: absolute;\n\t\t\t\tbottom: -80rpx;\n\t\t\t\tleft: -80rpx;\n\t\t\t\twidth: 320rpx;\n\t\t\t\theight: 320rpx;\n\t\t\t\tbackground-color: rgba(249, 115, 22, 0.2);\n\t\t\t\tborder-radius: 50%;\n\t\t\t\tfilter: blur(80rpx);\n\t\t\t}\n\n\t\t\t.card-inner {\n\t\t\t\tposition: relative;\n\t\t\t\tz-index: 10;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\tpadding: 40rpx;\n\t\t\t\tcolor: #ffffff;\n\t\t\t}\n\n\t\t\t.card-top {\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: space-between;\n\t\t\t\talign-items: center;\n\n\t\t\t\t.company-info {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tgap: 16rpx;\n\n\t\t\t\t\t.company-logo {\n\t\t\t\t\t\twidth: 64rpx;\n\t\t\t\t\t\theight: 64rpx;\n\t\t\t\t\t\tbackground-color: rgba(255, 255, 255, 0.2);\n\t\t\t\t\t\tbackdrop-filter: blur(10px);\n\t\t\t\t\t\tborder-radius: 12rpx;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t\t.material-symbols-outlined { font-size: 32rpx; }\n\t\t\t\t\t}\n\n\t\t\t\t\t.company-name { font-size: 28rpx; font-weight: bold; opacity: 0.9; }\n\t\t\t\t}\n\n\t\t\t\t.pro-tag {\n\t\t\t\t\tbackground-color: #f97316;\n\t\t\t\t\tpadding: 4rpx 16rpx;\n\t\t\t\t\tborder-radius: 40rpx;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tgap: 8rpx;\n\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\tfont-weight: bold;\n\n\t\t\t\t\t.pro-icon { font-size: 24rpx; }\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.card-middle {\n\t\t\t\tflex: 1;\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tgap: 24rpx;\n\n\t\t\t\t.card-avatar {\n\t\t\t\t\twidth: 168rpx;\n\t\t\t\t\theight: 168rpx;\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\tborder: 6rpx solid rgba(255, 255, 255, 0.3);\n\t\t\t\t\tbox-shadow: 0 16rpx 32rpx rgba(0, 0, 0, 0.2);\n\t\t\t\t}\n\n\t\t\t\t.card-user {\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\t.card-name { font-size: 44rpx; font-weight: bold; display: block; }\n\t\t\t\t\t.card-role { font-size: 28rpx; font-weight: 500; opacity: 0.8; margin-top: 8rpx; display: block; }\n\t\t\t\t}\n\n\t\t\t\t.card-tags {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tgap: 12rpx;\n\n\t\t\t\t\t.card-tag {\n\t\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\t\tpadding: 4rpx 16rpx;\n\t\t\t\t\t\tbackground-color: rgba(255, 255, 255, 0.1);\n\t\t\t\t\t\tborder: 1px solid rgba(255, 255, 255, 0.1);\n\t\t\t\t\t\tbackdrop-filter: blur(10px);\n\t\t\t\t\t\tborder-radius: 8rpx;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.card-bottom {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\tgap: 36rpx;\n\n\t\t\t\t.contact-info {\n\t\t\t\t\tbackground-color: rgba(255, 255, 255, 0.1);\n\t\t\t\t\tbackdrop-filter: blur(10px);\n\t\t\t\t\tborder: 1px solid rgba(255, 255, 255, 0.05);\n\t\t\t\t\tborder-radius: 24rpx;\n\t\t\t\t\tpadding: 24rpx;\n\n\t\t\t\t\t.contact-item {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\tgap: 24rpx;\n\n\t\t\t\t\t\t.contact-icon {\n\t\t\t\t\t\t\twidth: 64rpx;\n\t\t\t\t\t\t\theight: 64rpx;\n\t\t\t\t\t\t\tbackground-color: #ffffff;\n\t\t\t\t\t\t\tcolor: #2d9cf0;\n\t\t\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t\t\t.material-symbols-outlined { font-size: 32rpx; }\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.contact-text {\n\t\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\t\t.contact-label { font-size: 20rpx; text-transform: uppercase; opacity: 0.6; }\n\t\t\t\t\t\t\t.contact-val { font-size: 28rpx; font-weight: bold; }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.extra-info {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\talign-items: flex-end;\n\n\t\t\t\t\t.extra-text {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\tgap: 4rpx;\n\t\t\t\t\t\tfont-size: 26rpx;\n\t\t\t\t\t\topacity: 0.92;\n\t\t\t\t\t\tletter-spacing: 0.5rpx;\n\t\t\t\t\t}\n\n\t\t\t\t\t.extra-line {\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t\tline-height: 1.5;\n\t\t\t\t\t}\n\n\t\t\t\t\t.extra-label {\n\t\t\t\t\t\topacity: 0.8;\n\t\t\t\t\t}\n\n\t\t\t\t\t.extra-val {\n\t\t\t\t\t\tfont-weight: 700;\n\t\t\t\t\t}\n\n\t\t\t\t\t.qr-code {\n\t\t\t\t\t\twidth: 84rpx;\n\t\t\t\t\t\theight: 84rpx;\n\t\t\t\t\t\tbackground-color: #ffffff;\n\t\t\t\t\t\tborder-radius: 12rpx;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t\tcolor: #0f172a;\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t\t.material-symbols-outlined { font-size: 56rpx; }\n\n\t\t\t\t\t\t.qr-image {\n\t\t\t\t\t\t\twidth: 84rpx;\n\t\t\t\t\t\t\theight: 84rpx;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.swipe-tip { font-size: 24rpx; color: #94a3b8; margin-top: 12rpx; }\n\t}\n\n\t.footer {\n\t\tbackground-color: rgba(255, 255, 255, 0.9);\n\t\tbackdrop-filter: blur(10px);\n\t\t/* safe-area 交给 BottomTabBar 处理，避免底部过高 */\n\t\tpadding: 20rpx 24rpx 20rpx;\n\t\tborder-top: 1rpx solid #e2e8f0;\n\t\tz-index: 100;\n\n\t\t.save-btn {\n\t\t\twidth: 100%;\n\t\t\theight: 88rpx;\n\t\t\tbackground-color: #2d9cf0;\n\t\t\tcolor: #ffffff;\n\t\t\tborder-radius: 24rpx;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\tgap: 16rpx;\n\t\t\tfont-size: 32rpx;\n\t\t\tfont-weight: bold;\n\t\t\tbox-shadow: 0 10rpx 25rpx rgba(45, 156, 240, 0.3);\n\t\t\tborder: none;\n\n\t\t\t&::after { border: none; }\n\t\t\t&:active { background-color: #1d82cc; transform: scale(0.98); }\n\t\t}\n\t}\n\n\t.share-footer {\n\t\t/* 与 BottomTabBar 的“胶囊卡片”风格统一：本层透明，只保留外边距 */\n\t\tbackground: transparent;\n\t\tborder-top: none;\n\t\tbackdrop-filter: none;\n\t\tpadding: 8rpx 16rpx 0;\n\t\tbox-shadow: none;\n\n\t\t.share-options {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t\tgap: 0;\n\t\t\t/* 复用 BottomTabBar 的磨砂/边框/圆角/阴影 */\n\t\t\tbackground: rgba(255, 255, 255, 0.92);\n\t\t\tbackdrop-filter: blur(12px);\n\t\t\t-webkit-backdrop-filter: blur(12px);\n\t\t\tborder: 1rpx solid rgba(226, 232, 240, 0.9);\n\t\t\tborder-radius: 28rpx;\n\t\t\tbox-shadow: 0 -10rpx 24rpx rgba(15, 23, 42, 0.06);\n\t\t\tpadding: 18rpx 18rpx;\n\t\t}\n\n\t\t.share-item {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\talign-items: center;\n\t\t\tgap: 10rpx;\n\t\t\tflex: 1;\n\t\t\tmin-width: 0;\n\t\t\tbackground: transparent;\n\t\t\tborder: none;\n\t\t\tpadding: 0;\n\n\t\t\t.share-icon {\n\t\t\t\t/* 改为扁平 pill，和底部导航 icon-wrap 对齐 */\n\t\t\t\twidth: 88rpx;\n\t\t\t\theight: 56rpx;\n\t\t\t\tborder-radius: 28rpx;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tcolor: #0f172a;\n\t\t\t\ttransition: transform 0.18s ease, background-color 0.18s ease, border-color 0.18s ease;\n\t\t\t\tborder: 1rpx solid transparent;\n\n\t\t\t\t&.green { background-color: rgba(34, 197, 94, 0.10); border-color: rgba(34, 197, 94, 0.18); color: #16a34a; }\n\t\t\t\t&.blue { background-color: rgba(37, 99, 235, 0.10); border-color: rgba(37, 99, 235, 0.18); color: #2563eb; }\n\t\t\t\t&.orange { background-color: rgba(249, 115, 22, 0.10); border-color: rgba(249, 115, 22, 0.18); color: #f97316; }\n\t\t\t\t&.grey { background-color: rgba(148, 163, 184, 0.14); border-color: rgba(148, 163, 184, 0.18); color: #64748b; }\n\n\t\t\t\t.material-symbols-outlined { font-size: 40rpx; }\n\t\t\t}\n\n\t\t\t.share-label {\n\t\t\t\tfont-size: 22rpx;\n\t\t\t\tfont-weight: 700;\n\t\t\t\tcolor: #475569;\n\t\t\t\twhite-space: nowrap;\n\t\t\t\toverflow: hidden;\n\t\t\t\ttext-overflow: ellipsis;\n\t\t\t}\n\n\t\t\t&:active .share-icon { transform: scale(1.06); }\n\t\t}\n\n\t\t.share-btn::after {\n\t\t\tborder: none;\n\t\t}\n\t}\n\n\t.mask-popup {\n\t\tposition: fixed;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground: rgba(15, 23, 42, 0.45);\n\t\tz-index: 999;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 24rpx;\n\n\t\t.popup-card {\n\t\t\twidth: 100%;\n\t\t\tmax-width: 620rpx;\n\t\t\tbackground: #ffffff;\n\t\t\tborder-radius: 28rpx;\n\t\t\tpadding: 28rpx 24rpx;\n\t\t\tbox-shadow: 0 30rpx 80rpx rgba(0, 0, 0, 0.18);\n\t\t}\n\n\t\t.popup-title {\n\t\t\tfont-size: 32rpx;\n\t\t\tfont-weight: 800;\n\t\t\tcolor: #0f172a;\n\t\t\tmargin-bottom: 16rpx;\n\t\t}\n\n\t\t.popup-input {\n\t\t\theight: 88rpx;\n\t\t\tborder-radius: 18rpx;\n\t\t\tbackground: #f8fafc;\n\t\t\tborder: 1rpx solid #e2e8f0;\n\t\t\tpadding: 0 20rpx;\n\t\t\tfont-size: 30rpx;\n\t\t\tcolor: #0f172a;\n\t\t}\n\n\t\t.popup-actions {\n\t\t\tmargin-top: 18rpx;\n\t\t\tdisplay: flex;\n\t\t\tgap: 16rpx;\n\t\t}\n\n\t\t.popup-btn {\n\t\t\tflex: 1;\n\t\t\theight: 82rpx;\n\t\t\tborder-radius: 18rpx;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\tfont-size: 30rpx;\n\t\t\tfont-weight: 700;\n\t\t\tborder: none;\n\n\t\t\t&::after { border: none; }\n\n\t\t\t&.ghost {\n\t\t\t\tbackground: #f1f5f9;\n\t\t\t\tcolor: #334155;\n\t\t\t}\n\n\t\t\t&.primary {\n\t\t\t\tbackground: #2d9cf0;\n\t\t\t\tcolor: #ffffff;\n\t\t\t}\n\t\t}\n\t}\n\n\t.hidden-canvas {\n\t\tposition: fixed;\n\t\tleft: -9999px;\n\t\ttop: -9999px;\n\t\topacity: 0;\n\t\tpointer-events: none;\n\t}\n\n\t/* 不再需要 bottom spacer（页面不滚动） */\n</style>\n","import MiniProgramPage from 'E:/Work/Progect/GoFly-admin/main-admin/web/wxapp/pages/my_business_card/my_business_card.vue'\nwx.createPage(MiniProgramPage)"],"names":["base64Encode","str","buf","s","bytes","i","length","codePoint","charCodeAt","push","Uint8Array","utf8ToBytes","buffer","wx","wx$1","arrayBufferToBase64","uni","index$1","_sfc_main","components","BottomTabBar","TopHeader","onLoad","options","tab","currentTab","this","initCanvasSize","loadProfile","catch","onShow","onShareAppMessage","name","profile","agentId","Number","loadedUserId","style","currentPreview","title","path","encodeURIComponent","data","qrCodeUrl","styleChangeTimer","saving","savingImage","tagPopupVisible","newTagText","storeOptions","canvasWidth","canvasHeight","canvasScale","avatar","phone","wechat","role","store_id","store","store_address","email","intro","tags","suggestTags","cardStyles","bg","decor2","badge","badgeBg","computed","previewCards","p","Array","isArray","slice","map","watch","v","loadStores","methods","sys","getSystemInfoSync","pr","pixelRatio","Math","max","min","e","onPreviewChange","detail","current","persistDefaultStyle","scheduleWxaCodeRefresh","safeImage","url","String","trim","extrasStorageKey","uid","loadExtras","key","raw","getStorageSync","JSON","parse","saveExtras","payload","setStorageSync","stringify","showLoading","$store","isLogin","res","userApi","getCardProfile","code","d","id","ID","nickname","mobile","store_name","introduction","idx","styleStorageKey","isNaN","extras","loadWxaCode","clearTimeout","setTimeout","process","env","getAccountInfoSync","includes","miniProgram","envVersion","check_path","getAgentWxaCode","previewQrCode","showToast","icon","common_vendor","previewImage","urls","getStores","items","onStorePickerChange","value","address","showUneditable","msg","openAddTag","closeAddTag","confirmAddTag","t","addTag","tag","concat","removeTag","filter","_","saveProfile","updateCardProfile","userStore","setUserInfo","userInfo","changeAvatar","chooseImage","count","sizeType","sourceType","success","async","filePath","tempFilePaths","uploadAvatar","Promise","resolve","reject","token","timestamp","floor","Date","now","header","Accept","Businessid","apiverify","md5","Authorization","uploadFile","baseUrl","formData","filetype","upRes","out","message","fail","err","saveCardImage","saveCardToAlbum","copyCardLink","copyUrlLink","ev","getAgentUrlLink","env_version","urlLink","url_link","setClipboardData","showMoreActions","showActionSheet","itemList","tapIndex","removeStorageSync","getGradientColors","matches","match","drawRoundRectPath","ctx","x","y","w","h","r","rr","beginPath","moveTo","arcTo","closePath","getImageInfo","src","Error","px","fs","ath","round","createCanvasContext","save","clip","c1","c2","grd","createLinearGradient","addColorStop","setFillStyle","fillRect","arc","PI","fill","setFontSize","fillText","avatarInfo","avatarSize","avatarX","avatarY","drawImage","restore","setStrokeStyle","setLineWidth","stroke","measureText","width","wechatLine","storeLine","qrInfo","draw","temp","canvasToTempFilePath","canvasId","height","destWidth","destHeight","fileType","quality","saveImageToPhotosAlbum","tempFilePath","showModal","content","confirmText","cancelText","confirm","openSetting","createPage","MiniProgramPage"],"mappings":"iKA6RC,SAAAA,EAAAC,EAAA,IAOC,MAiBAC,EAjBA,CAAAC,IACC,MAAAC,EAAA,GACA,IAAA,IAAAC,EAAA,EAAAA,EAAAF,EAAAG,OAAAD,IAAA,CACC,IAAAE,EAAAJ,EAAAK,WAAAH,GACAE,EAAA,IACCH,EAAAK,KAAAF,GAAoBA,EAAA,MAEpBH,EAAAK,KAAA,IAAAF,GAAA,GACAH,EAAAK,KAAA,IAAA,GAAAF,KAEAH,EAAAK,KAAA,IAAAF,GAAA,IACAH,EAAAK,KAAA,IAAAF,GAAA,EAAA,IACAH,EAAAK,KAAA,IAAA,GAAAF,GACD,CAED,OAAA,IAAAG,WAAAN,EAAA,EAEDO,CAAAV,GAAAW,OAEA,YAAA,IAAAC,EAAAC,MAAAD,EAAAA,KAAAE,oBAAyDF,EAAAC,KAAAC,oBAAAb,QACzD,IAAAc,EAAAC,SAAAD,EAAAA,QAAAD,oBAA2DC,EAAAC,QAAAF,oBAAAb,GAC3D,EAED,CAEA,MAAAgB,EAAA,CAAeC,WAAA,CAAAC,aAvCf,IAAA,mCAuCeC,UAtCf,IAAA,iCAuCuC,MAAAC,CAAAC,GAGrC,MAAAC,EAAAD,IAAAA,EAAAC,KAAAD,EAAAE,YACA,MAAAD,GAAA,IAAAA,GAAA,SAAAA,IACCE,KAAAD,WAAA,GAEDC,KAAAC,iBACAD,KAAAE,cAAAC,OAAA,QAAiC,EAClC,MAAAC,GAGCJ,KAAAE,aAAA,GAAAC,OAAA,QAAsC,EACvC,iBAAAE,GAEC,MAAAC,EAAAN,KAAAO,SAAAP,KAAAO,QAAAD,MAAA,IACAE,EAAAC,OAAAT,KAAAU,cAAA,GACAC,EAAAF,OAAAT,KAAAY,gBAAA,GACA,MAAA,CAAOC,MAAA,GAAAP,OACQQ,KAAA,uDAAAC,mBAAAP,YAAAO,mBAAAJ,KAEf,EACDK,KAAA,KAEC,CAAOjB,WAAA,EAEMa,eAAA,EACIK,UAAA,GACLC,iBAAA,KACOC,QAAA,EACVC,aAAA,EACKC,iBAAA,EACIC,WAAA,GACLZ,aAAA,EACEa,aAAA,GACCC,YAAA,IACFC,aAAA,KACCC,YAAA,EACDnB,QAAA,CAEJoB,OAAA,GACArB,KAAA,GACFsB,MAAA,GACCC,OAAA,GACCC,KAAA,GACFC,SAAA,EACIC,MAAA,GACHC,cAAA,GACQC,MAAA,GACRC,MAAA,GACAC,KAAA,IAERC,YAAA,CAAA,QAAA,QAAA,OAAA,OAAA,OAAA,QAC8DC,WAAA,CAElD,CAAAC,GAAA,4CAAAC,OAAA,0BAAAC,MAAA,MAAAC,QAAA,WAC4G,CAAAH,GAAA,4CAAAC,OAAA,4BAAAC,MAAA,MAAAC,QAAA,WACE,CAAAH,GAAA,4CAAAC,OAAA,2BAAAC,MAAA,MAAAC,QAAA,cAI5HC,SAAA,CACU,YAAAC,GAER,MAAAC,EAAA7C,KAAAO,SAAA,GACA6B,EAAAU,MAAAC,QAAAF,EAAAT,MAAAS,EAAAT,KAAAY,MAAA,EAAA,GAAA,GACA,OAAAhD,KAAAsC,YAAA,IAAAW,KAAAxE,IAAA,IAA2CA,EACvC6B,KAAAuC,EAAAvC,KACKwB,KAAAe,EAAAf,KACAF,MAAAiB,EAAAjB,MACCC,OAAAgB,EAAAhB,OACCG,MAAAa,EAAAb,MACDL,OAAAkB,EAAAlB,OACCS,UAET,GAEJc,MAAA,CACO,UAAAnD,CAAAoD,GAEL,IAAA1C,OAAA0C,IAAqBnD,KAAAoD,aAAAjD,OAAA,QAAgC,GAEvDkD,QAAA,CACS,cAAApD,GAEP,IACC,MAAAqD,EAAAhE,EAAAA,QAAAiE,kBAAAjE,EAAAA,QAAAiE,oBAAA,GACAC,EAAA/C,OAAA6C,EAAAG,YAAA,GACAzD,KAAA0B,YAAAgC,KAAAC,IAAA,EAAAD,KAAAE,IAAA,EAAAJ,GAAA,IAEAxD,KAAAwB,YAAA,IACAxB,KAAAyB,aAAA,IAAoB,OAAAoC,GACT,CAAC,EACd,eAAAC,CAAAD,GAEC7D,KAAAY,eAAAiD,EAAAE,OAAAC,QACAhE,KAAAiE,sBACAjE,KAAAkE,wBAA4B,EAC7BC,UAAAC,GAECC,OAAAD,GAAA,IAAAE,QACA,oCACDC,iBAAAC,GAEC,iCAAAA,GAAA,IACD,UAAAC,CAAAD,GAEC,MAAAE,EAAA1E,KAAAuE,iBAAAC,GACAG,EAAArF,EAAAA,QAAAsF,eAAAF,GACA,IAAAC,EAAU,MAAA,GACV,IACC,MAAA,iBAAAA,EAA6BE,KAAAC,MAAAH,GAC7BA,GAAA,CAAA,CAAe,OAAAd,GAEf,MAAA,EAAQ,CACT,EACD,UAAAkB,CAAAP,GAEC,MAAAE,EAAA1E,KAAAuE,iBAAAC,GACAQ,EAAA,CAAgBnD,OAAAwC,OAAArE,KAAAO,QAAAsB,QAAA,IAAAyC,OACgClC,KAAAU,MAAAC,QAAA/C,KAAAO,QAAA6B,MAAApC,KAAAO,QAAA6B,KAAA,IAGhD,IACC9C,EAAAC,QAAA0F,eAAAP,EAAAG,KAAAK,UAAAF,GAA+C,OAAAnB,GAE/CvE,EAAAA,QAAA2F,eAAAP,EAAAM,EAA+B,CAChC,EACD,iBAAA9E,CAAAiF,GAAA,GAGC,IADA7F,EAAAA,QAAAsF,eAAA,WACAQ,SAAA,QAAAC,QAAuC,OACvC,MAAAC,QAAAC,EAAAA,QAAAC,iBAAAL,GACA,IAAAG,GAAA,IAAAA,EAAAG,KAA4B,OAC5B,MAAAC,EAAAJ,EAAAtE,MAAA,GACAwD,EAAA/D,OAAAiF,EAAAC,IAAAD,EAAAE,IAAA,GACA5F,KAAAU,aAAA8D,EACAxE,KAAAO,QAAAoB,OAAA+D,EAAA/D,QAAA,GACA3B,KAAAO,QAAAD,KAAAoF,EAAApF,MAAAoF,EAAAG,UAAA,GACA7F,KAAAO,QAAAqB,MAAA8D,EAAAI,QAAA,GACA9F,KAAAO,QAAAuB,KAAA4D,EAAA7E,OAAA6E,EAAA5D,MAAA,GACA9B,KAAAO,QAAAwB,SAAAtB,OAAAiF,EAAA3D,UAAA,GACA/B,KAAAO,QAAAyB,MAAA0D,EAAAK,YAAA,GACA/F,KAAAO,QAAA0B,cAAAyD,EAAAzD,eAAA,GACAjC,KAAAO,QAAA2B,MAAAwD,EAAAxD,OAAA,GACAlC,KAAAO,QAAA4B,MAAAuD,EAAAM,cAAA,GAGA,MAAAC,EAAAxF,OAAAnB,EAAAA,QAAAsF,eAAA5E,KAAAkG,gBAAA1B,KAAA,IACA/D,OAAA0F,MAAAF,IAAAA,GAAA,IAAoCjG,KAAAY,eAAAqF,GAEpC,MAAAG,EAAApG,KAAAyE,WAAAD,GACA4B,IACC,iBAAAA,EAAAvE,SAAuC7B,KAAAO,QAAAsB,OAAAuE,EAAAvE,QACvCiB,MAAAC,QAAAqD,EAAAhE,QAAgCpC,KAAAO,QAAA6B,KAAAgE,EAAAhE,OAIjCpC,KAAAqG,aAAA,GAAAlG,OAAA,QAAsC,EACvC+F,gBAAA1B,GAEC,gCAAAA,GAAA,IACD,mBAAAP,GAECjE,KAAAU,cACApB,EAAAA,QAAA2F,eAAAjF,KAAAkG,gBAAAlG,KAAAU,cAAAD,OAAAT,KAAAY,gBAAA,GAA4F,EAC7F,sBAAAsD,GAEClE,KAAAkB,mBACCoF,aAAAtG,KAAAkB,kBACAlB,KAAAkB,iBAAA,MAEDlB,KAAAkB,iBAAAqF,YAAA,KACCvG,KAAAqG,aAAA,GAAAlG,OAAA,QAAoC,GAAE,IACjC,EACP,iBAAAkG,CAAAlB,GAAA,GAYC,IADA7F,EAAAA,QAAAsF,eAAA,WACAQ,SAAA,QAAAC,QAAuC,OAEvC,MAAArE,EAAA,CAAAL,MAAAF,OAAAT,KAAAY,gBAAA,OAGA,oBAAA4F,UAAAA,QAAAC,WAAA,IAAAtH,QAAAA,EAAAC,KAAAsH,oBAAA,CAAA,UAAA,SAAAC,UAAAxH,EAAAA,KAAAuH,qBAAAE,aAAA,IAAAC,eAKW7F,EAAA8F,YAAA,GAEX,MAAAxB,QAAAC,UAAAwB,gBAAA/F,IAAAmE,GAEAG,GAAA,IAAAA,EAAAG,OAEAzF,KAAAiB,UAAAqE,EAAAtE,MAAAsE,EAAAtE,KAAAoD,KAAA,GAA+C,EAChD,aAAA4C,GAEC,IAAAhH,KAAAiB,UAGC,OAFA3B,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,aAAAqG,KAAA,cACAlH,KAAAqG,aAAA,GAAAlG,OAAA,SAGDgH,EAAA5H,QAAA6H,aAAA,CAAAC,KAAA,CAAArH,KAAAiB,YAA2C,EAC5C,gBAAAmC,GAGC,IADA9D,EAAAA,QAAAsF,eAAA,WACAQ,SAAA,QAAAC,QAAuC,OACvC,MAAAC,QAAAC,EAAAA,QAAA+B,WAAA,GACA,IAAAhC,GAAA,IAAAA,EAAAG,KAA4B,OAC5B,MAAA8B,EAAAzE,MAAAC,QAAAuC,EAAAtE,MAAAsE,EAAAtE,KAAA,GACAhB,KAAAuB,aAAAgG,CAAoB,EACrB,mBAAAC,CAAA3D,GAEC,MAAAoC,EAAAxF,OAAAoD,GAAAA,EAAAE,OAAAF,EAAAE,OAAA0D,OAAA,GACA,IAAA3E,MAAAC,QAAA/C,KAAAuB,eAAA,IAAAvB,KAAAuB,aAAA3C,OAEC,YADAU,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,SAAAqG,KAAA,SAGD,GAAAjB,EAAA,GAAAA,GAAAjG,KAAAuB,aAAA3C,OAAgD,OAChD,MAAAH,EAAAuB,KAAAuB,aAAA0E,IAAA,CAAA,EACAjG,KAAAO,QAAAwB,SAAAtB,OAAAhC,EAAAkH,IAAA,GACA3F,KAAAO,QAAAyB,MAAAvD,EAAA6B,MAAA,GACAN,KAAAO,QAAA0B,cAAAxD,EAAAiJ,SAAA,EAA0C,EAC3C,cAAAC,CAAAC,aAECX,UAAA,CAAApG,MAAA+G,GAAA,QAAAV,KAAA,QAAqD,EACtD,UAAAW,GAEC7H,KAAAsB,WAAA,GACAtB,KAAAqB,iBAAA,CAAuB,EACxB,WAAAyG,GAEC9H,KAAAqB,iBAAA,EACArB,KAAAsB,WAAA,EAAkB,EACnB,aAAAyG,GAEC,MAAAC,EAAA3D,OAAArE,KAAAsB,YAAA,IAAAgD,OACA0D,GAIAhI,KAAAiI,OAAAD,GACAhI,KAAA8H,eAJCxI,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,UAAAqG,KAAA,QAIgB,EAClB,MAAAe,CAAAD,GAEC,MAAAE,EAAA7D,OAAA2D,GAAA,IAAA1D,OACA4D,IACApF,MAAAC,QAAA/C,KAAAO,QAAA6B,QAAuCpC,KAAAO,QAAA6B,KAAA,IACvCpC,KAAAO,QAAA6B,KAAAuE,SAAAuB,KACAlI,KAAAO,QAAA6B,KAAAxD,QAAA,EACCU,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,WAAAqG,KAAA,SAGDlH,KAAAO,QAAA6B,KAAApC,KAAAO,QAAA6B,KAAA+F,OAAA,CAAAD,KAAkD,EACnD,SAAAE,CAAAnC,GAECnD,MAAAC,QAAA/C,KAAAO,QAAA6B,QACApC,KAAAO,QAAA6B,KAAApC,KAAAO,QAAA6B,KAAAiG,QAAA,CAAAC,EAAA3J,IAAAA,IAAAsH,IAAgE,EACjE,iBAAAsC,GAEC,GAAAvI,KAAAmB,OAAiB,OACjB,MAAAb,EAAA+D,OAAArE,KAAAO,QAAAD,MAAA,IAAAgE,OACA,GAAAhE,EAAA,CAIAN,KAAAmB,QAAA,EACA,IACC,MAAA6D,EAAA,CAAgBrD,OAAA3B,KAAAO,QAAAoB,OACMrB,OACrBO,MAAAwD,OAAArE,KAAAO,QAAAuB,MAAA,IAAAwC,OAC4C0B,aAAA3B,OAAArE,KAAAO,QAAA4B,OAAA,IAAAmC,OACQvC,SAAAtB,OAAAT,KAAAO,QAAAwB,UAAA,IAGrDuD,QAAAC,EAAAA,QAAAiD,kBAAAxD,GAAA,GACA,IAAAM,GAAA,IAAAA,EAAAG,KAA4B,OAC5BzF,KAAAU,cAAuBV,KAAA+E,WAAA/E,KAAAU,cACvB,MAAA+H,EAAArD,SAAA,QACAqD,EAAAC,YAAA,IAAsBD,EAAAE,UAAA,CAAA,EACMhH,OAAA3B,KAAAO,QAAAoB,OACNrB,KAAAN,KAAAO,QAAAD,OAGtBhB,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,OAAAqG,KAAA,QAA6C,CAAA,QAE7ClH,KAAAmB,QAAA,CAAc,CAtBd,MADA7B,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,QAAAqG,KAAA,QAwBD,EACD,kBAAA0B,GAEC5I,KAAAmB,QACA7B,EAAAA,QAAAuJ,YAAA,CAAgBC,MAAA,EACRC,SAAA,CAAA,cACgBC,WAAA,CAAA,QAAA,UACOC,QAAAC,MAAA5D,IAE7B,MAAA6D,EAAA7D,GAAAA,EAAA8D,eAAA9D,EAAA8D,cAAA,GACAD,SACAnJ,KAAAqJ,aAAAF,EAAA,GAED,EACF,YAAAE,CAAAF,GAEC,OAAA,IAAAG,SAAA,CAAAC,EAAAC,KACC,MAAAC,EAAAnK,EAAAA,QAAAsF,eAAA,SACA8E,EAAAhG,KAAAiG,MAAAC,KAAAC,MAAA,KAEAC,EAAA,CAAeC,OAAA,YACNC,WAAA,IACIC,UAAA3L,EAHb4L,EAAAA,IAAA,YAAAR,GAGa,IAAAA,IAGbD,IAAWK,EAAAK,cAAA,GAAAV,KACXnK,EAAAA,QAAA8K,WAAA,CAAehG,IAAA,GAAAiG,EAAAA,+BACClB,WACf7I,KAAA,OACMgK,SAAA,CAAAC,SAAA,SACwBT,SAC9Bb,QAAAuB,IAEC,IACC,MAAA7F,EAAA6F,GAAAA,EAAAxJ,KAAAwJ,EAAAxJ,KAAA,KACAyJ,EAAA,iBAAA9F,EAAAE,KAAAC,MAAAH,GAAAA,EACA,IAAA8F,GAAA,IAAAA,EAAAhF,KAMC,OALAnG,EAAAA,QAAA2H,UAAA,CAAcpG,MAAA4J,GAAAA,EAAAC,SAAA,OACkBxD,KAAA,cAGhCsC,EAAAiB,GAGD,MAAArG,EAAAqG,GAAAA,EAAAzJ,KAAAyJ,EAAAzJ,KAAAoD,IAAA,GACApE,KAAAO,QAAAoB,OAAAyC,GAAA,GACA9E,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,QAAAqG,KAAA,SACAqC,EAAAkB,EAAW,OAAA5G,GAEXvE,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,WAAAqG,KAAA,SACAsC,EAAA3F,EAAQ,GAEV8G,KAAAC,IAECtL,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,OAAAqG,KAAA,SACAsC,EAAAoB,EAAA,GACD,GAED,EACF,aAAAC,GAEC7K,KAAA8K,kBAAA3K,OAAA,QAAqC,EACtC,YAAA4K,GAEC/K,KAAAgL,cAAA7K,OAAA,QAAiC,EAClC,iBAAA6K,GAEC,MAAArK,EAAAF,OAAAT,KAAAY,gBAAA,GACA,IAAAiG,EAAA,GAEA,QAAA,IAAA1H,EAAAC,MAAAD,EAAAA,KAAAuH,mBAAA,CACC,MAAAuE,GAAA9L,OAAAuH,qBAAAE,aAAA,CAAA,GAAAC,WACA,YAAAoE,GAAA,UAAAA,GAAA,YAAAA,IAA4DpE,EAAAoE,EAAa,CAE1E,MAAA3F,QAAAC,EAAAA,QAAA2F,gBAAA,CAAAvK,QAAAwK,YAAAtE,IAAA,GACAuE,EAAA9F,GAAA,IAAAA,EAAAG,MAAAH,EAAAtE,KAAAsE,EAAAtE,KAAAqK,SAAA,GACAD,EAIA9L,EAAAA,QAAAgM,iBAAA,CAAqBtK,KAAAoK,EACdnC,QAAA,IAAA3J,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,QAAAqG,KAAA,WAJN5H,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,SAAAqG,KAAA,QAMA,EACF,eAAAqE,GAECjM,EAAAA,QAAAkM,gBAAA,CAAoBC,SAAA,CAAA,OAAA,cACYxC,QAAAC,MAAA5D,IAK9B,GAHA,IAAAA,EAAAoG,gBACC1L,KAAAE,aAAA,GAAAC,OAAA,SAED,IAAAmF,EAAAoG,SAAA,CACC,IAAA1L,KAAAU,aAAwB,OACxBpB,EAAAC,QAAAoM,kBAAA3L,KAAAuE,iBAAAvE,KAAAU,eACAV,KAAAO,QAAAsB,OAAA,GACA7B,KAAAO,QAAA6B,KAAA,GACA9C,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,MAAAqG,KAAA,QAA4C,IAG9C,EACF,iBAAA0E,CAAArJ,GAEC,MACAsJ,EADAxH,OAAA9B,GAAA,IACAuJ,MAAA,8BAAA,GACA,OAAAD,EAAAjN,QAAA,EAAyB,CAAAiN,EAAA,GAAAA,EAAA,IACzB,CAAA,UAAA,UAA4B,EAC7B,iBAAAE,CAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GAEC,MAAAC,EAAA5I,KAAAC,IAAA,EAAAD,KAAAE,IAAAyI,EAAAF,EAAA,EAAAC,EAAA,IACAJ,EAAAO,YACAP,EAAAQ,OAAAP,EAAAK,EAAAJ,GACAF,EAAAS,MAAAR,EAAAE,EAAAD,EAAAD,EAAAE,EAAAD,EAAAE,EAAAE,GACAN,EAAAS,MAAAR,EAAAE,EAAAD,EAAAE,EAAAH,EAAAC,EAAAE,EAAAE,GACAN,EAAAS,MAAAR,EAAAC,EAAAE,EAAAH,EAAAC,EAAAI,GACAN,EAAAS,MAAAR,EAAAC,EAAAD,EAAAE,EAAAD,EAAAI,GACAN,EAAAU,WAAc,EACfC,aAAAC,GAEC,IAAAtD,SAAA,CAAAC,EAAAC,KACC,IAAAoD,EAAU,OAAApD,EAAA,IAAAqD,MAAA,cACVvN,EAAAA,QAAAqN,aAAA,CAAiBC,MAChB3D,QAAA3D,GAAAiE,EAAAjE,GAC6BqF,KAAAC,GAAApB,EAAAoB,IACJ,IAG5B,qBAAAE,GAEC,IAAA9K,KAAAoB,YAAA,CACApB,KAAAoB,aAAA,EACA,IAIC,GAHApB,KAAAiB,iBACCjB,KAAAqG,aAAA,GAAAlG,OAAA,UAEDH,KAAAiB,UAEC,YADA3B,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,WAAAqG,KAAA,SAID,MAAAvG,EAAAX,KAAA4C,aAAA5C,KAAAY,iBAAAZ,KAAA4C,aAAA,GACAuJ,EAAAnM,KAAAwB,YAAAxB,KAAA0B,YACA0K,EAAApM,KAAAyB,aAAAzB,KAAA0B,YAKAoL,GAJA9M,KAAA0B,YAIAyB,GAAA1C,OAAA0C,IAAAgJ,EAAA,MACKY,EAAA5J,GAAA6J,IAAAC,MAAAxM,OAAA0C,IAAAgJ,EAAA,MAELH,EAAA1M,EAAAC,QAAA2N,oBAAA,aAAAlN,MACAgM,EAAAmB,OAIAnN,KAAA+L,kBAAAC,EAAA,EAAA,EAAAG,EAAAC,EAAAU,EAAA,KACAd,EAAAoB,OACA,MAAAC,EAAAC,GAAAtN,KAAA4L,kBAAAjL,EAAA4B,IACAgL,EAAAvB,EAAAwB,qBAAA,EAAA,EAAArB,EAAAC,GACAmB,EAAAE,aAAA,EAAAJ,GACAE,EAAAE,aAAA,EAAAH,GACAtB,EAAA0B,aAAAH,GACAvB,EAAA2B,SAAA,EAAA,EAAAxB,EAAAC,GAGAJ,EAAA0B,aAAA,0BACA1B,EAAAO,YACAP,EAAA4B,IAAAzB,EAAAW,EAAA,IAAAA,EAAA,IAAAA,EAAA,KAAA,EAAA,EAAApJ,KAAAmK,IACA7B,EAAA8B,OACA9B,EAAA0B,aAAArJ,OAAA1D,EAAA6B,QAAA,0BACAwJ,EAAAO,YACAP,EAAA4B,IAAAd,EAAA,IAAAV,EAAAU,EAAA,KAAAA,EAAA,KAAA,EAAA,EAAApJ,KAAAmK,IACA7B,EAAA8B,OAGA9B,EAAA0B,aAAA,0BACA1N,KAAA+L,kBAAAC,EAAAc,EAAA,IAAAA,EAAA,IAAAA,EAAA,KAAAA,EAAA,IAAAA,EAAA,KACAd,EAAA8B,OACA9B,EAAA0B,aAAA,WACA1B,EAAA+B,YAAAhB,EAAA,KACAf,EAAAgC,SAAA3J,OAAA1D,EAAAqB,OAAA,SAAA8K,EAAA,IAAAA,EAAA,KAEAd,EAAA0B,aAAArJ,OAAA1D,EAAA+B,SAAA,YACA1C,KAAA+L,kBAAAC,EAAAG,EAAAW,EAAA,KAAAA,EAAA,IAAAA,EAAA,KAAAA,EAAA,IAAAA,EAAA,KACAd,EAAA8B,OACA9B,EAAA0B,aAAA,WACA1B,EAAA+B,YAAAhB,EAAA,KACAf,EAAAgC,SAAA3J,OAAA1D,EAAA8B,OAAA,OAAA0J,EAAAW,EAAA,KAAAA,EAAA,KAGA,MAAAmB,QAAAjO,KAAA2M,aAAA3M,KAAAmE,UAAAxD,EAAAgB,SACAuM,EAAApB,EAAA,KACAqB,GAAAhC,EAAA+B,GAAA,EACAE,EAAAtB,EAAA,KACAd,EAAAmB,OACAnB,EAAAO,YACAP,EAAA4B,IAAAzB,EAAA,EAAAiC,EAAAF,EAAA,EAAAA,EAAA,EAAA,EAAA,EAAAxK,KAAAmK,IACA7B,EAAAoB,OACApB,EAAAqC,UAAAJ,EAAAnN,KAAAqN,EAAAC,EAAAF,EAAAA,GACAlC,EAAAsC,UACAtC,EAAAuC,eAAA,0BACAvC,EAAAwC,aAAA9K,KAAAC,IAAA,EAAAmJ,EAAA,KACAd,EAAAO,YACAP,EAAA4B,IAAAzB,EAAA,EAAAiC,EAAAF,EAAA,EAAAA,EAAA,EAAA,EAAA,EAAAxK,KAAAmK,IACA7B,EAAAyC,SAGAzC,EAAA0B,aAAA,WACA1B,EAAA+B,YAAAhB,EAAA,KACA,MAAAzM,EAAA+D,OAAA1D,EAAAL,MAAA,IACA0L,EAAAgC,SAAA1N,GAAA6L,EAAAH,EAAA0C,YAAApO,GAAAqO,OAAA,EAAA7B,EAAA,MACAd,EAAA+B,YAAAhB,EAAA,KACAf,EAAA0B,aAAA,0BACA,MAAA5L,EAAAuC,OAAA1D,EAAAmB,MAAA,QACAkK,EAAAgC,SAAAlM,GAAAqK,EAAAH,EAAA0C,YAAA5M,GAAA6M,OAAA,EAAA7B,EAAA,MAGAd,EAAA0B,aAAA,0BACA1N,KAAA+L,kBAAAC,EAAAc,EAAA,IAAAA,EAAA,KAAAX,EAAAW,EAAA,KAAAA,EAAA,KAAAA,EAAA,KACAd,EAAA8B,OACA9B,EAAA0B,aAAA,0BACA1B,EAAA+B,YAAAhB,EAAA,KACAf,EAAAgC,SAAA,KAAAlB,EAAA,IAAAA,EAAA,MACAd,EAAA0B,aAAA,WACA1B,EAAA+B,YAAAhB,EAAA,KACA,MAAAnL,EAAAyC,OAAA1D,EAAAiB,OAAA,IACAoK,EAAAgC,SAAApM,EAAAkL,EAAA,IAAAA,EAAA,MAGAd,EAAA0B,aAAA,0BACA1B,EAAA+B,YAAAhB,EAAA,KACA,MAAA6B,EAAA,OAAAvK,OAAA1D,EAAAkB,QAAA,IACAmK,EAAAgC,SAAAY,EAAA9B,EAAA,IAAAV,EAAAU,EAAA,MACA,MAAA+B,EAAA,MAAAxK,OAAA1D,EAAAqB,OAAA,IACAgK,EAAAgC,SAAAa,EAAA/B,EAAA,IAAAV,EAAAU,EAAA,MAGA,MAAAgC,QAAA9O,KAAA2M,aAAA3M,KAAAiB,WACA+K,EAAA0B,aAAA,WACA1N,KAAA+L,kBAAAC,EAAAG,EAAAW,EAAA,KAAAV,EAAAU,EAAA,KAAAA,EAAA,KAAAA,EAAA,KAAAA,EAAA,KACAd,EAAA8B,OACA9B,EAAAqC,UAAAS,EAAAhO,KAAAqL,EAAAW,EAAA,KAAAV,EAAAU,EAAA,KAAAA,EAAA,KAAAA,EAAA,MACAd,EAAA0B,aAAA,0BACA1B,EAAA+B,YAAAhB,EAAA,KACAf,EAAAgC,SAAA,SAAA7B,EAAAW,EAAA,KAAAV,EAAAU,EAAA,KAEAd,EAAAsC,gBAEA,IAAAhF,SAAAC,GAAAyC,EAAA+C,MAAA,EAAAxF,KAEA,MAAAyF,QAAA,IAAA1F,SAAA,CAAAC,EAAAC,KACOlK,EAAAA,QAAA2P,qBAAI,CACAC,SAAA,aACYjD,EAAA,EACPC,EAAA,EACAyC,MAAAxC,EAEIgD,OAAA/C,EACCgD,UAAAjD,EAGGkD,WAAAjD,EACCkD,SAAA,MAEFC,QAAA,EACDtG,QAAA3D,GAAAiE,EAAAjE,GACoBqF,KAAAC,GAAApB,EAAAoB,IAE/B5K,KACA,UAKX,IAAAsJ,SAAA,CAAAC,EAAAC,KACClK,EAAAA,QAAAkQ,uBAAA,CAA2BrG,SAAA6F,EAAAS,aACXxG,QAAA,IAAAM,GAAA,GACYoB,KAAAC,GAAApB,EAAAoB,IACF,IAG3BtL,EAAAC,QAAA0H,UAAA,CAAApG,MAAA,SAAAqG,KAAA,QAA+C,OAAArD,GAG/CvE,EAAAA,QAAAoQ,UAAA,CAAc7O,MAAA,OACN8O,QAAA,gBACEC,YAAA,MACIC,WAAA,KACD5G,QAAA3D,IAEXA,EAAAwK,mBAAiBC,YAAA,CAAA,EAAA,GAElB,CAAA,QAED/P,KAAAoB,aAAA,CAAmB,CArKE,CAsKtB,48EC54BJjC,GAAG6Q,WAAWC"}