{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script>\r\n\t// #ifdef MP-WEIXIN\r\n\t// 兼容：部分微信开发者工具/运行环境的 vue-devtools 注入会触发：\r\n\t// __VUE_DEVTOOLS_ON_SOCKET_READY__ is not a function（导致启动白屏、页面未注册）\r\n\t// 这里提前挂一个空函数兜底，避免 devtools backend 初始化直接抛错。\r\n\t;(function () {\r\n\t\ttry {\r\n\t\t\tconst g =\r\n\t\t\t\t(typeof globalThis !== 'undefined' && globalThis) ||\r\n\t\t\t\t(typeof global !== 'undefined' && global) ||\r\n\t\t\t\t(typeof wx !== 'undefined' && wx) ||\r\n\t\t\t\t{}\r\n\t\t\tif (g && typeof g.__VUE_DEVTOOLS_ON_SOCKET_READY__ !== 'function') {\r\n\t\t\t\tg.__VUE_DEVTOOLS_ON_SOCKET_READY__ = function () {}\r\n\t\t\t}\r\n\t\t\t// 有些实现 target 可能指向 wx 对象\r\n\t\t\tif (typeof wx !== 'undefined' && typeof wx.__VUE_DEVTOOLS_ON_SOCKET_READY__ !== 'function') {\r\n\t\t\t\twx.__VUE_DEVTOOLS_ON_SOCKET_READY__ = function () {}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\t// ignore\r\n\t\t}\r\n\t})()\r\n\t// #endif\r\n\r\n\timport $store from '@/store'\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t__bootstrapped: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync bootstrapAuthRedirect() {\r\n\t\t\t\t// 只在启动时跑一次，避免反复 reLaunch\r\n\t\t\t\tif (this.__bootstrapped) return\r\n\t\t\t\tthis.__bootstrapped = true\r\n\r\n\t\t\t\tconst token = uni.getStorageSync('token')\r\n\t\t\t\tif (!token) return\r\n\r\n\t\t\t\tconst userStore = $store('user')\r\n\t\t\t\tif (!userStore.isLogin) userStore.setToken(token)\r\n\r\n\t\t\t\t// 校验 token 是否有效：有效则从登录页跳到首页；无效则清理并停留在登录页\r\n\t\t\t\tlet ok = false\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst info = await userStore.getInfo()\r\n\t\t\t\t\tok = !!info\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tok = false\r\n\t\t\t\t}\r\n\t\t\t\tif (!ok) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tawait userStore.logout(true)\r\n\t\t\t\t\t} catch (e) {}\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst pages = getCurrentPages ? getCurrentPages() : []\r\n\t\t\t\tconst cur = pages && pages.length ? pages[pages.length - 1] : null\r\n\t\t\t\tconst route = cur && cur.route ? cur.route : ''\r\n\t\t\t\t// 仅在“启动落到登录页”时自动跳首页，避免干扰用户在其它页面的操作\r\n\t\t\t\tif (route === 'pages/login/login') {\r\n\t\t\t\t\tuni.reLaunch({ url: '/pages/property_list/property_list' })\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLaunch: function() {\r\n\t\t\tconsole.log('App Launch')\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t// 微信小程序端：WXSS 不允许/不稳定地使用本地 @font-face 引入字体（会触发 do-not-use-local-path 并 500）\r\n\t\t\t// 因此这里改回使用 wx.loadFontFace 加载“稳定 CDN”字体文件\r\n\t\t\t// 注意：真机/发布需把对应域名加入小程序「downloadFile 合法域名」\r\n\t\t\ttry {\r\n\t\t\t\tif (typeof wx !== 'undefined' && wx.loadFontFace) {\r\n\t\t\t\t\twx.loadFontFace({\r\n\t\t\t\t\t\tfamily: 'Material Symbols Outlined',\r\n\t\t\t\t\t\t// 使用 jsDelivr CDN（相对 raw.githubusercontent.com 更稳定）//TODO后续放入自己的服务器中\r\n\t\t\t\t\t\tsource:\r\n\t\t\t\t\t\t\t'url(\"https://cdn.jsdelivr.net/gh/google/material-design-icons@master/font/MaterialIconsOutlined-Regular.otf\")',\r\n\t\t\t\t\t\tglobal: true\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// ignore\r\n\t\t\t}\r\n\t\t\t// #endif\r\n\r\n\t\t\t// 启动时：若已登录则自动跳首页\r\n\t\t\tthis.bootstrapAuthRedirect()\r\n\t\t},\r\n\t\tonShow: function() {\r\n\t\t\tconsole.log('App Show')\r\n\t\t\t// 某些情况下 onLaunch 早于页面栈就绪，这里再兜底一次\r\n\t\t\tthis.bootstrapAuthRedirect()\r\n\t\t},\r\n\t\tonHide: function() {\r\n\t\t\tconsole.log('App Hide')\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t/*每个页面公共css */\r\n\t/* 字体图标：改为加载本地字体，避免外链失效 */\r\n\t/* #ifndef MP-WEIXIN */\r\n\t@font-face {\r\n\t\tfont-family: 'Material Symbols Outlined';\r\n\t\tfont-style: normal;\r\n\t\tfont-weight: 400;\r\n\t\tsrc:\r\n\t\t\turl('/static/fonts/MaterialSymbolsOutlined.ttf') format('truetype'),\r\n\t\t\turl('/static/fonts/MaterialSymbolsOutlined.otf') format('opentype');\r\n\t}\r\n\t/* #endif */\r\n\r\n\t.material-symbols-outlined {\r\n\t\tfont-family: 'Material Symbols Outlined';\r\n\t\tfont-weight: 400;\r\n\t\tfont-style: normal;\r\n\t\tline-height: 1;\r\n\t\tletter-spacing: normal;\r\n\t\ttext-transform: none;\r\n\t\tdisplay: inline-block;\r\n\t\twhite-space: nowrap;\r\n\t\tword-wrap: normal;\r\n\t\tdirection: ltr;\r\n\t\t-webkit-font-smoothing: antialiased;\r\n\t\t-moz-osx-font-smoothing: grayscale;\r\n\t\t/* #ifdef MP-WEIXIN */\r\n\t\t/* 强制启用连字（ligatures），否则会直接显示英文单词 */\r\n\t\tfont-variant-ligatures: contextual;\r\n\t\t-webkit-font-variant-ligatures: contextual;\r\n\t\tfont-feature-settings: 'liga';\r\n\t\t-webkit-font-feature-settings: 'liga';\r\n\t\t/* #endif */\r\n\t\t/* #ifdef H5 */\r\n\t\t/* H5 支持变量字体参数，小程序端可能不支持，避免引发 WXSS 解析问题 */\r\n\t\tfont-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;\r\n\t\t/* #endif */\r\n\t}\r\n\t\r\n\tpage {\r\n\t\tbackground-color: #f6f7f8;\r\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;\r\n\t}\r\n\r\n\t/* 避免使用通配选择器 `*`，部分微信编译器会直接报错 */\r\n\tview,\r\n\ttext,\r\n\timage,\r\n\tbutton,\r\n\tinput,\r\n\ttextarea,\r\n\tscroll-view,\r\n\tswiper,\r\n\tswiper-item {\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n</style>\r\n","import App from './App'\r\nimport { setupPinia } from '@/store'\r\n// #ifndef VUE3\r\nimport Vue from 'vue'\r\nimport './uni.promisify.adaptor'\r\nVue.config.productionTip = false\r\nApp.mpType = 'app'\r\nconst app = new Vue({\r\n  ...App\r\n})\r\nsetupPinia(app)\r\napp.$mount()\r\n// #endif\r\n\r\n// #ifdef VUE3\r\nimport { createSSRApp } from 'vue'\r\nexport function createApp() {\r\n  const app = createSSRApp(App)\r\n  setupPinia(app)\r\n  return {\r\n    app\r\n  }\r\n}\r\n// #endif"],"names":["wx","uni","$store","createSSRApp","App","setupPinia"],"mappings":";;;;;;;;;;;;;;;;;;;;;;CAKG,WAAY;AACb,MAAI;AACH,UAAM,IACJ,OAAO,eAAe,eAAe,cACrC,OAAO,WAAW,eAAe,UACjC,OAAOA,cAAG,SAAI,eAAeA,sBAC9B,CAAC;AACF,QAAI,KAAK,OAAO,EAAE,qCAAqC,YAAY;AAClE,QAAE,mCAAmC,WAAY;AAAA,MAAC;AAAA,IACnD;AAEA,QAAI,OAAOA,cAAC,SAAM,eAAe,OAAOA,cAAAA,KAAG,qCAAqC,YAAY;AAC3FA,oBAAE,KAAC,mCAAmC,WAAY;AAAA,MAAC;AAAA,IACpD;AAAA,EACD,SAAS,GAAG;AAAA,EAEZ;AACD,GAAG;AAKH,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,gBAAgB;AAAA,IACjB;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,MAAM,wBAAwB;AAE7B,UAAI,KAAK;AAAgB;AACzB,WAAK,iBAAiB;AAEtB,YAAM,QAAQC,cAAAA,QAAI,eAAe,OAAO;AACxC,UAAI,CAAC;AAAO;AAEZ,YAAM,YAAYC,YAAM,OAAC,MAAM;AAC/B,UAAI,CAAC,UAAU;AAAS,kBAAU,SAAS,KAAK;AAGhD,UAAI,KAAK;AACT,UAAI;AACH,cAAM,OAAO,MAAM,UAAU,QAAQ;AACrC,aAAK,CAAC,CAAC;AAAA,MACR,SAAS,GAAG;AACX,aAAK;AAAA,MACN;AACA,UAAI,CAAC,IAAI;AACR,YAAI;AACH,gBAAM,UAAU,OAAO,IAAI;AAAA,iBACnB,GAAG;AAAA,QAAC;AACb;AAAA,MACD;AAEA,YAAM,QAAQ,kBAAkB,gBAAe,IAAK,CAAC;AACrD,YAAM,MAAM,SAAS,MAAM,SAAS,MAAM,MAAM,SAAS,CAAC,IAAI;AAC9D,YAAM,QAAQ,OAAO,IAAI,QAAQ,IAAI,QAAQ;AAE7C,UAAI,UAAU,qBAAqB;AAClCD,sBAAAA,QAAI,SAAS,EAAE,KAAK,qCAAmC,CAAG;AAAA,MAC3D;AAAA,IACD;AAAA,EACA;AAAA,EACD,UAAU,WAAW;AACpBA,kBAAAA,QAAA,MAAA,OAAA,iBAAY,YAAY;AAKxB,QAAI;AACH,UAAI,OAAOD,cAAG,SAAI,eAAeA,cAAAA,KAAG,cAAc;AACjDA,sBAAAA,KAAG,aAAa;AAAA,UACf,QAAQ;AAAA;AAAA,UAER,QACC;AAAA,UACD,QAAQ;AAAA,SACR;AAAA,MACF;AAAA,IACD,SAAS,GAAG;AAAA,IAEZ;AAIA,SAAK,sBAAsB;AAAA,EAC3B;AAAA,EACD,QAAQ,WAAW;AAClBC,kBAAAA,QAAY,MAAA,OAAA,iBAAA,UAAU;AAEtB,SAAK,sBAAsB;AAAA,EAC3B;AAAA,EACD,QAAQ,WAAW;AAClBA,kBAAAA,QAAY,MAAA,OAAA,kBAAA,UAAU;AAAA,EACvB;AACD;ACrFM,SAAS,YAAY;AAC1B,QAAM,MAAME,cAAY,aAACC,SAAG;AAC5BC,cAAAA,WAAW,GAAG;AACd,SAAO;AAAA,IACL;AAAA,EACD;AACH;;;"}